"use strict";(globalThis.webpackChunkhandbook=globalThis.webpackChunkhandbook||[]).push([[26621],{28453(n,e,i){i.d(e,{R:()=>o,x:()=>t});var s=i(96540);const r={},l=s.createContext(r);function o(n){const e=s.useContext(l);return s.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function t(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:o(n.components),s.createElement(l.Provider,{value:e},n.children)}},82318(n,e,i){i.r(e),i.d(e,{assets:()=>c,contentTitle:()=>t,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"nginx/Logging/Monitoring Tools","title":"Monitoring Tools","description":"Monitoring tools are external systems that collect, analyze, visualize, and alert on data generated by NGINX, mainly from:","source":"@site/docs/nginx/22. Logging/5. Monitoring Tools.md","sourceDirName":"nginx/22. Logging","slug":"/nginx/Logging/Monitoring Tools","permalink":"/handbook/docs/nginx/Logging/Monitoring Tools","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":5,"frontMatter":{},"sidebar":"nginxApiSidebar","previous":{"title":"Stub Status","permalink":"/handbook/docs/nginx/Logging/Stub Status"},"next":{"title":"Name Based Virtual Hosting","permalink":"/handbook/docs/nginx/Name Based Virtual Hosting"}}');var r=i(74848),l=i(28453);const o={},t=void 0,c={},a=[{value:"Why Monitoring Is Critical for NGINX",id:"why-monitoring-is-critical-for-nginx",level:2},{value:"Types of Monitoring in NGINX",id:"types-of-monitoring-in-nginx",level:2},{value:"Log-Based Monitoring",id:"log-based-monitoring",level:3},{value:"Metrics-Based Monitoring",id:"metrics-based-monitoring",level:3},{value:"Availability Monitoring",id:"availability-monitoring",level:3},{value:"Common NGINX Monitoring Tools (Most Used)",id:"common-nginx-monitoring-tools-most-used",level:2},{value:"Prometheus + Grafana (Most Popular)",id:"prometheus--grafana-most-popular",level:3},{value:"ELK Stack (Elasticsearch, Logstash, Kibana)",id:"elk-stack-elasticsearch-logstash-kibana",level:3},{value:"GoAccess (Real-Time Log Analyzer)",id:"goaccess-real-time-log-analyzer",level:3},{value:"Datadog / New Relic (SaaS Monitoring)",id:"datadog--new-relic-saas-monitoring",level:3},{value:"Zabbix / Nagios (Traditional Monitoring)",id:"zabbix--nagios-traditional-monitoring",level:3},{value:"What Metrics You Should Monitor (Must-Know)",id:"what-metrics-you-should-monitor-must-know",level:2},{value:"Alerting Examples (Very Important)",id:"alerting-examples-very-important",level:2},{value:"Security Monitoring with NGINX",id:"security-monitoring-with-nginx",level:2},{value:"Best Practices for NGINX Monitoring",id:"best-practices-for-nginx-monitoring",level:2},{value:"Example: Production Monitoring Stack",id:"example-production-monitoring-stack",level:2}];function d(n){const e={code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.p,{children:"Monitoring tools are external systems that collect, analyze, visualize, and alert on data generated by NGINX, mainly from:"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Access logs"}),"\n",(0,r.jsx)(e.li,{children:"Error logs"}),"\n",(0,r.jsx)(e.li,{children:"stub_status / status endpoints"}),"\n",(0,r.jsx)(e.li,{children:"System-level metrics (CPU, RAM, disk, network)"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"NGINX itself only produces data \u2014 monitoring tools consume and interpret it."}),"\n",(0,r.jsx)(e.h2,{id:"why-monitoring-is-critical-for-nginx",children:"Why Monitoring Is Critical for NGINX"}),"\n",(0,r.jsx)(e.p,{children:"Without monitoring, you are blind to:"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Traffic spikes or DDoS attacks"}),"\n",(0,r.jsx)(e.li,{children:"Backend failures"}),"\n",(0,r.jsx)(e.li,{children:"Slow responses"}),"\n",(0,r.jsx)(e.li,{children:"Resource exhaustion"}),"\n",(0,r.jsx)(e.li,{children:"Configuration errors"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"Monitoring answers questions like:"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u201cIs my site up?\u201d"}),"\n",(0,r.jsx)(e.li,{children:"\u201cWhy is it slow?\u201d"}),"\n",(0,r.jsx)(e.li,{children:"\u201cIs NGINX overloaded?\u201d"}),"\n",(0,r.jsx)(e.li,{children:"\u201cIs an attack happening?\u201d"}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"types-of-monitoring-in-nginx",children:"Types of Monitoring in NGINX"}),"\n",(0,r.jsx)(e.h3,{id:"log-based-monitoring",children:"Log-Based Monitoring"}),"\n",(0,r.jsxs)(e.p,{children:["Uses: ",(0,r.jsx)(e.code,{children:"access.log"}),", ",(0,r.jsx)(e.code,{children:"error.log"})]}),"\n",(0,r.jsx)(e.p,{children:"Tracks:"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Request volume"}),"\n",(0,r.jsx)(e.li,{children:"Response codes (2xx, 4xx, 5xx)"}),"\n",(0,r.jsx)(e.li,{children:"Latency"}),"\n",(0,r.jsx)(e.li,{children:"Client IPs"}),"\n",(0,r.jsx)(e.li,{children:"Errors"}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"metrics-based-monitoring",children:"Metrics-Based Monitoring"}),"\n",(0,r.jsx)(e.p,{children:"Uses:"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"stub_status"}),"\n",(0,r.jsx)(e.li,{children:"Exporters"}),"\n",(0,r.jsx)(e.li,{children:"OS metrics"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"Tracks:"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Active connections"}),"\n",(0,r.jsx)(e.li,{children:"Requests per second"}),"\n",(0,r.jsx)(e.li,{children:"Reading / Writing / Waiting"}),"\n",(0,r.jsx)(e.li,{children:"Worker usage"}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"availability-monitoring",children:"Availability Monitoring"}),"\n",(0,r.jsx)(e.p,{children:"Checks:"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Is NGINX reachable?"}),"\n",(0,r.jsx)(e.li,{children:"Is HTTPS working?"}),"\n",(0,r.jsx)(e.li,{children:"Is response time acceptable?"}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"common-nginx-monitoring-tools-most-used",children:"Common NGINX Monitoring Tools (Most Used)"}),"\n",(0,r.jsx)(e.h3,{id:"prometheus--grafana-most-popular",children:"Prometheus + Grafana (Most Popular)"}),"\n",(0,r.jsx)(e.p,{children:"How It Works"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"NGINX \u2192 stub_status \u2192 Exporter \u2192 Prometheus \u2192 Grafana\n"})}),"\n",(0,r.jsx)(e.p,{children:"What It Monitors"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Active connections"}),"\n",(0,r.jsx)(e.li,{children:"Requests/sec"}),"\n",(0,r.jsx)(e.li,{children:"Error rate"}),"\n",(0,r.jsx)(e.li,{children:"Latency"}),"\n",(0,r.jsx)(e.li,{children:"CPU & memory"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"Example Setup"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"location /nginx_status {\r\n    stub_status;\r\n    access_log off;\r\n    allow 127.0.0.1;\r\n    deny all;\r\n}\n"})}),"\n",(0,r.jsxs)(e.p,{children:["Exporter scrapes ",(0,r.jsx)(e.code,{children:"http://localhost/nginx_status"})]}),"\n",(0,r.jsx)(e.p,{children:"Grafana dashboard"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Live traffic graphs"}),"\n",(0,r.jsx)(e.li,{children:"Error spikes"}),"\n",(0,r.jsx)(e.li,{children:"Connection states"}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"elk-stack-elasticsearch-logstash-kibana",children:"ELK Stack (Elasticsearch, Logstash, Kibana)"}),"\n",(0,r.jsx)(e.p,{children:"How It Works"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"NGINX logs \u2192 Logstash \u2192 Elasticsearch \u2192 Kibana\n"})}),"\n",(0,r.jsx)(e.p,{children:"What It Monitors"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Access logs"}),"\n",(0,r.jsx)(e.li,{children:"Error logs"}),"\n",(0,r.jsx)(e.li,{children:"Request patterns"}),"\n",(0,r.jsx)(e.li,{children:"Attacks"}),"\n",(0,r.jsx)(e.li,{children:"Slow endpoints"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"Example: Structured Logs"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:'log_format json_logs escape=json\r\n\'{"time":"$time_iso8601",\'\r\n \'"remote_ip":"$remote_addr",\'\r\n \'"method":"$request_method",\'\r\n \'"uri":"$request_uri",\'\r\n \'"status":$status,\'\r\n \'"response_time":$request_time}\';\r\n\r\naccess_log /var/log/nginx/access.log json_logs;\n'})}),"\n",(0,r.jsx)(e.p,{children:"Kibana can now:"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Filter errors"}),"\n",(0,r.jsx)(e.li,{children:"Track response time"}),"\n",(0,r.jsx)(e.li,{children:"Detect suspicious IPs"}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"goaccess-real-time-log-analyzer",children:"GoAccess (Real-Time Log Analyzer)"}),"\n",(0,r.jsx)(e.p,{children:"How It Works"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"NGINX access.log \u2192 GoAccess \u2192 HTML dashboard\n"})}),"\n",(0,r.jsx)(e.p,{children:"Example"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"goaccess /var/log/nginx/access.log -o report.html --log-format=COMBINED\n"})}),"\n",(0,r.jsx)(e.p,{children:"Shows:"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Requests per second"}),"\n",(0,r.jsx)(e.li,{children:"Top URLs"}),"\n",(0,r.jsx)(e.li,{children:"Slow requests"}),"\n",(0,r.jsx)(e.li,{children:"HTTP status distribution"}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"datadog--new-relic-saas-monitoring",children:"Datadog / New Relic (SaaS Monitoring)"}),"\n",(0,r.jsx)(e.p,{children:"How It Works"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"NGINX \u2192 Agent \u2192 Cloud Dashboard\n"})}),"\n",(0,r.jsx)(e.p,{children:"What You Get: Metrics, Logs, Alerts, APM tracing"}),"\n",(0,r.jsx)(e.p,{children:"Example metrics:"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Error rate > 5%"}),"\n",(0,r.jsx)(e.li,{children:"Response time > 500ms"}),"\n",(0,r.jsx)(e.li,{children:"Active connections spike"}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"zabbix--nagios-traditional-monitoring",children:"Zabbix / Nagios (Traditional Monitoring)"}),"\n",(0,r.jsx)(e.p,{children:"Used in: Enterprise, Legacy infrastructure"}),"\n",(0,r.jsx)(e.p,{children:"Monitors: Service uptime, Port availability, Resource thresholds"}),"\n",(0,r.jsx)(e.p,{children:"Example check:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"check_http -H example.com -S\n"})}),"\n",(0,r.jsx)(e.h2,{id:"what-metrics-you-should-monitor-must-know",children:"What Metrics You Should Monitor (Must-Know)"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"Traffic Metrics: Requests per second, Active connections, Bandwidth usage"}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"Error Metrics: 4xx errors, 5xx errors, Backend failures"}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"Performance Metrics: Response time, Upstream latency, Slow requests"}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"Resource Metrics: CPU, Memory, File descriptors, Worker connections"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"alerting-examples-very-important",children:"Alerting Examples (Very Important)"}),"\n",(0,r.jsx)(e.p,{children:"Example Alerts"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"Alert"}),(0,r.jsx)(e.th,{children:"Meaning"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"5xx > 2%"}),(0,r.jsx)(e.td,{children:"Backend issue"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"Active connections > 80%"}),(0,r.jsx)(e.td,{children:"Capacity risk"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"Response time > 1s"}),(0,r.jsx)(e.td,{children:"Performance issue"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"Error log spike"}),(0,r.jsx)(e.td,{children:"Config or app error"})]})]})]}),"\n",(0,r.jsx)(e.p,{children:"Monitoring tools trigger: Email, Slack, SMS, PagerDuty"}),"\n",(0,r.jsx)(e.h2,{id:"security-monitoring-with-nginx",children:"Security Monitoring with NGINX"}),"\n",(0,r.jsx)(e.p,{children:"Monitoring tools help detect:"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Brute force attacks"}),"\n",(0,r.jsx)(e.li,{children:"DDoS patterns"}),"\n",(0,r.jsx)(e.li,{children:"Abnormal request rates"}),"\n",(0,r.jsx)(e.li,{children:"Unauthorized access attempts"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"Example:"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["Many ",(0,r.jsx)(e.code,{children:"401"})," responses \u2192 brute force"]}),"\n",(0,r.jsxs)(e.li,{children:["Many ",(0,r.jsx)(e.code,{children:"404"})," from same IP \u2192 scanning"]}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"best-practices-for-nginx-monitoring",children:"Best Practices for NGINX Monitoring"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Use metrics + logs together"}),"\n",(0,r.jsx)(e.li,{children:"Secure status endpoints"}),"\n",(0,r.jsxs)(e.li,{children:["Disable access logs for ",(0,r.jsx)(e.code,{children:"/nginx_status"})]}),"\n",(0,r.jsx)(e.li,{children:"Use structured logs (JSON)"}),"\n",(0,r.jsx)(e.li,{children:"Set alerts before users complain"}),"\n",(0,r.jsx)(e.li,{children:"Monitor trends, not just spikes"}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"example-production-monitoring-stack",children:"Example: Production Monitoring Stack"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"NGINX\r\n \u251c\u2500\u2500 access.log \u2192 ELK\r\n \u251c\u2500\u2500 error.log \u2192 ELK\r\n \u251c\u2500\u2500 stub_status \u2192 Prometheus\r\n \u2514\u2500\u2500 system metrics \u2192 Prometheus\r\n        \u2193\r\n     Grafana Dashboards\r\n        \u2193\r\n       Alerts\n"})})]})}function h(n={}){const{wrapper:e}={...(0,l.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(d,{...n})}):d(n)}}}]);