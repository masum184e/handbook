"use strict";(globalThis.webpackChunkhandbook=globalThis.webpackChunkhandbook||[]).push([[7625],{28453(e,n,s){s.d(n,{R:()=>t,x:()=>l});var i=s(96540);const a={},r=i.createContext(a);function t(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:t(e.components),i.createElement(r.Provider,{value:n},e.children)}},72633(e,n,s){s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>u,frontMatter:()=>t,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"mysql/Large Datasets/Query Optimization","title":"Query Optimization","description":"Avoid Functions in WHERE Clause","source":"@site/docs/mysql/23. Large Datasets/2. Query Optimization.md","sourceDirName":"mysql/23. Large Datasets","slug":"/mysql/Large Datasets/Query Optimization","permalink":"/handbook/docs/mysql/Large Datasets/Query Optimization","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{},"sidebar":"mysqlSidebar","previous":{"title":"Partitioning","permalink":"/handbook/docs/mysql/Large Datasets/Partitioning"},"next":{"title":"Full Text Search","permalink":"/handbook/docs/mysql/Large Datasets/Full Text Search"}}');var a=s(74848),r=s(28453);const t={},l=void 0,o={},d=[{value:"Avoid Functions in WHERE Clause",id:"avoid-functions-in-where-clause",level:2},{value:"Use Query Caching (if available)",id:"use-query-caching-if-available",level:2},{value:"Avoid N+1 Query Problem",id:"avoid-n1-query-problem",level:2}];function c(e){const n={code:"code",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h2,{id:"avoid-functions-in-where-clause",children:"Avoid Functions in WHERE Clause"}),"\n",(0,a.jsx)(n.p,{children:"When you wrap a column in a function, indexes cannot be used."}),"\n",(0,a.jsx)(n.p,{children:"Bad:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"SELECT * FROM employees WHERE YEAR(hire_date) = 2020;\n"})}),"\n",(0,a.jsxs)(n.p,{children:["MySQL must evaluate ",(0,a.jsx)(n.code,{children:"YEAR()"})," for every row \u2192 slow."]}),"\n",(0,a.jsx)(n.p,{children:"Good:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"SELECT * FROM employees\r\nWHERE hire_date >= '2020-01-01' AND hire_date <= '2020-12-31';\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Uses index on ",(0,a.jsx)(n.code,{children:"hire_date"}),". Much faster."]}),"\n",(0,a.jsx)(n.h2,{id:"use-query-caching-if-available",children:"Use Query Caching (if available)"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"In older MySQL versions \u2192 Query Cache can store results."}),"\n",(0,a.jsx)(n.li,{children:"In MySQL 8+ \u2192 use external caching (e.g., Redis, Memcached)."}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Example:"}),"\n",(0,a.jsx)(n.p,{children:"Instead of repeatedly running:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"SELECT COUNT(*) FROM orders WHERE status = 'Pending';\n"})}),"\n",(0,a.jsx)(n.p,{children:"Cache the result in Redis and refresh periodically."}),"\n",(0,a.jsx)(n.h2,{id:"avoid-n1-query-problem",children:"Avoid N+1 Query Problem"}),"\n",(0,a.jsx)(n.p,{children:"Bad practice: running multiple queries in a loop."}),"\n",(0,a.jsx)(n.p,{children:"Bad:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"-- For each employee, fetch department\r\nSELECT dept_name FROM departments WHERE id = 101;\r\nSELECT dept_name FROM departments WHERE id = 102;\r\nSELECT dept_name FROM departments WHERE id = 103;\n"})}),"\n",(0,a.jsx)(n.p,{children:"This runs many queries \u2192 very slow."}),"\n",(0,a.jsx)(n.p,{children:"Good (single JOIN query):"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"SELECT e.name, d.dept_name\r\nFROM employees e\r\nJOIN departments d ON e.dept_id = d.id;\n"})}),"\n",(0,a.jsx)(n.p,{children:"One query instead of many. Huge performance boost."})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}}}]);