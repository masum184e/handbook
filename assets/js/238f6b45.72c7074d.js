"use strict";(globalThis.webpackChunkhandbook=globalThis.webpackChunkhandbook||[]).push([[665],{28453(e,n,r){r.d(n,{R:()=>o,x:()=>c});var s=r(96540);const t={},i=s.createContext(t);function o(e){const n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),s.createElement(i.Provider,{value:n},e.children)}},76360(e,n,r){r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"nodejs/Proxy Requests","title":"Proxy Requests","description":"React forwards API requests to the backend as if they came from the same origin.","source":"@site/docs/nodejs/Proxy Requests.md","sourceDirName":"nodejs","slug":"/nodejs/Proxy Requests","permalink":"/handbook/docs/nodejs/Proxy Requests","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"nodejsApiSidebar","previous":{"title":"Deployment","permalink":"/handbook/docs/nodejs/Deployment"},"next":{"title":"index","permalink":"/handbook/docs/nodejs/"}}');var t=r(74848),i=r(28453);const o={},c=void 0,d={},l=[{value:"Proxying in Create React App",id:"proxying-in-create-react-app",level:2},{value:"Proxying with Vite",id:"proxying-with-vite",level:3},{value:"Proxying specific routes only",id:"proxying-specific-routes-only",level:3},{value:"Proxy vs CORS",id:"proxy-vs-cors",level:2}];function a(e){const n={code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.p,{children:"React forwards API requests to the backend as if they came from the same origin."}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["So instead of: ",(0,t.jsx)(n.code,{children:'fetch("http://localhost:5000/api/users")'})]}),"\n",(0,t.jsxs)(n.li,{children:["You can write: ",(0,t.jsx)(n.code,{children:'fetch("/api/users")'})]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Architecture"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"React (localhost:3000)\r\n   |\r\n   |  /api/users\r\n   v\r\nReact Dev Proxy\r\n   |\r\n   |  http://localhost:5000/api/users\r\n   v\r\nNode / Express API\n"})}),"\n",(0,t.jsx)(n.h2,{id:"proxying-in-create-react-app",children:"Proxying in Create React App"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Add proxy in ",(0,t.jsx)(n.code,{children:"package.json"})]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\r\n  "name": "client",\r\n  "version": "0.1.0",\r\n  "proxy": "http://localhost:5000"\r\n}\n'})}),"\n",(0,t.jsxs)(n.ol,{start:"2",children:["\n",(0,t.jsx)(n.li,{children:"Call API without backend URL"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:'fetch("/api/users")\r\n  .then((res) => res.json())\r\n  .then((data) => console.log(data));\n'})}),"\n",(0,t.jsx)(n.p,{children:"What happens"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"React sees /api"}),"\n",(0,t.jsx)(n.li,{children:"Forwards request to localhost:5000"}),"\n",(0,t.jsx)(n.li,{children:"Express handles it normally"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"proxying-with-vite",children:"Proxying with Vite"}),"\n",(0,t.jsxs)(n.p,{children:["CRA is fading; Vite is common now: ",(0,t.jsx)(n.code,{children:"vite.config.js"})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:'import { defineConfig } from "vite";\r\nimport react from "@vitejs/plugin-react";\r\n\r\nexport default defineConfig({\r\n  plugins: [react()],\r\n  server: {\r\n    proxy: {\r\n      "/api": {\r\n        target: "http://localhost:5000",\r\n        changeOrigin: true,\r\n      },\r\n    },\r\n  },\r\n});\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Vite forwards ",(0,t.jsx)(n.code,{children:"/api/*"})," \u2192 Node backend."]}),"\n",(0,t.jsx)(n.h3,{id:"proxying-specific-routes-only",children:"Proxying specific routes only"}),"\n",(0,t.jsx)(n.p,{children:"Only proxy API routes, not everything:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:'proxy: {\r\n  "/api": {\r\n    target: "http://localhost:5000",\r\n  }\r\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"proxy-vs-cors",children:"Proxy vs CORS"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Feature"}),(0,t.jsx)(n.th,{children:"Proxy"}),(0,t.jsx)(n.th,{children:"CORS"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Used in dev"}),(0,t.jsx)(n.td,{children:"\u2705"}),(0,t.jsx)(n.td,{children:"\u2705"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Used in prod"}),(0,t.jsx)(n.td,{children:"\u274c"}),(0,t.jsx)(n.td,{children:"\u2705"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Solves browser restriction"}),(0,t.jsx)(n.td,{children:"\u2705"}),(0,t.jsx)(n.td,{children:"\u2705"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Config location"}),(0,t.jsx)(n.td,{children:"React"}),(0,t.jsx)(n.td,{children:"Express"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Hides backend URL"}),(0,t.jsx)(n.td,{children:"\u2705"}),(0,t.jsx)(n.td,{children:"\u274c"})]})]})]}),"\n",(0,t.jsx)(n.p,{children:"In real MERN apps:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Dev \u2192 proxy"}),"\n",(0,t.jsx)(n.li,{children:"Prod \u2192 CORS + reverse proxy (Nginx, Vercel, etc.)"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}}}]);