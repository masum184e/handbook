"use strict";(globalThis.webpackChunkhandbook=globalThis.webpackChunkhandbook||[]).push([[8573],{28453(e,n,t){t.d(n,{R:()=>a,x:()=>l});var i=t(96540);const r={},s=i.createContext(r);function a(e){const n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),i.createElement(s.Provider,{value:n},e.children)}},36324(e,n,t){t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"database-design/Referential Integrity","title":"Referential Integrity","description":"Referential Integrity ensures that relationships between tables remain consistent and valid.","source":"@site/docs/database-design/19. Referential Integrity.md","sourceDirName":"database-design","slug":"/database-design/Referential Integrity","permalink":"/handbook/docs/database-design/Referential Integrity","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":20,"frontMatter":{"sidebar_position":20}}');var r=t(74848),s=t(28453);const a={sidebar_position:20},l=void 0,c={},o=[{value:"Referential Integrity in Transactions",id:"referential-integrity-in-transactions",level:2},{value:"Case 1: Insert Transaction with Referential Integrity",id:"case-1-insert-transaction-with-referential-integrity",level:3},{value:"Case 2: Delete Transaction with Referential Integrity",id:"case-2-delete-transaction-with-referential-integrity",level:3},{value:"Why Referential Integrity Matters",id:"why-referential-integrity-matters",level:2}];function d(e){const n={code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:"Referential Integrity ensures that relationships between tables remain consistent and valid."}),"\n",(0,r.jsx)(n.p,{children:"It is enforced mainly through foreign keys (FKs):"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"A foreign key in one table must reference a valid, existing primary key (PK) in another table."}),"\n",(0,r.jsx)(n.li,{children:"You cannot have \u201corphan\u201d records (child rows pointing to non-existent parent rows)."}),"\n",(0,r.jsx)(n.li,{children:"You cannot delete/update a parent row if child rows still reference it \u2014 unless you explicitly define cascade actions."}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE Students (\r\n    student_id INT PRIMARY KEY,\r\n    name VARCHAR(100)\r\n);\r\n\r\nCREATE TABLE Enrollments (\r\n    enrollment_id INT PRIMARY KEY,\r\n    student_id INT,\r\n    course_code VARCHAR(10),\r\n    FOREIGN KEY (student_id) REFERENCES Students(student_id)\r\n);\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Enrollments.student_id is"})," a foreign key referencing ",(0,r.jsx)(n.code,{children:"Students.student_id"}),"."]}),"\n",(0,r.jsx)(n.li,{children:"You cannot insert an enrollment record for a student who doesn\u2019t exist."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Invalid insert (violates referential integrity):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"INSERT INTO Enrollments (enrollment_id, student_id, course_code)\r\nVALUES (1, 999, 'CS101'); -- \u274c student_id 999 doesn\u2019t exist\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Valid insert:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"INSERT INTO Students VALUES (101, 'Alice');\r\nINSERT INTO Enrollments VALUES (1, 101, 'CS101'); -- \u2705 works fine\n"})}),"\n",(0,r.jsx)(n.h2,{id:"referential-integrity-in-transactions",children:"Referential Integrity in Transactions"}),"\n",(0,r.jsx)(n.p,{children:"Now, let\u2019s connect this with transactions (runtime operations)."}),"\n",(0,r.jsx)(n.p,{children:"When transactions insert, update, or delete rows, referential integrity must still hold true at the end of the transaction (Consistency property of ACID)."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE Accounts (\r\n    account_id INT PRIMARY KEY,\r\n    customer_id INT,\r\n    balance DECIMAL(10,2)\r\n);\r\n\r\nCREATE TABLE Transactions (\r\n    txn_id INT PRIMARY KEY,\r\n    account_id INT,\r\n    amount DECIMAL(10,2),\r\n    FOREIGN KEY (account_id) REFERENCES Accounts(account_id)\r\n);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"case-1-insert-transaction-with-referential-integrity",children:"Case 1: Insert Transaction with Referential Integrity"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"BEGIN TRANSACTION;\r\n\r\nINSERT INTO Transactions VALUES (2001, 999, 500.00);  -- \u274c fails\r\n-- because account_id 999 does not exist in Accounts\r\n\r\nCOMMIT;\n"})}),"\n",(0,r.jsx)(n.p,{children:"The transaction fails entirely because referential integrity is violated. This protects the database from \u201cdangling\u201d transactions that point to non-existent accounts."}),"\n",(0,r.jsx)(n.h3,{id:"case-2-delete-transaction-with-referential-integrity",children:"Case 2: Delete Transaction with Referential Integrity"}),"\n",(0,r.jsx)(n.p,{children:"If you try:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"DELETE FROM accounts WHERE account_id = 101;\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"If Transactions table already has entries referencing account_id = 101, the deletion will be blocked."}),"\n",(0,r.jsx)(n.li,{children:"To allow it, you must define actions:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"FOREIGN KEY (account_id) REFERENCES accounts(account_id)\r\n    ON DELETE CASCADE\r\n    ON UPDATE CASCADE\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"ON DELETE CASCADE"})," \u2192 deleting an account will also delete its related transactions."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"ON UPDATE CASCADE"})," \u2192 if account_id changes, related transactions update automatically."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"why-referential-integrity-matters",children:"Why Referential Integrity Matters"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Prevents data anomalies (like enrollments for non-existent students or transactions for deleted accounts)."}),"\n",(0,r.jsx)(n.li,{children:"Works with ACID transactions to ensure the Consistency property."}),"\n",(0,r.jsx)(n.li,{children:"Without referential integrity, applications must manually check validity, which is error-prone."}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);