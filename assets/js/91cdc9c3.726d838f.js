"use strict";(globalThis.webpackChunkhandbook=globalThis.webpackChunkhandbook||[]).push([[47450],{28453(e,n,r){r.d(n,{R:()=>a,x:()=>l});var i=r(96540);const s={},t=i.createContext(s);function a(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),i.createElement(t.Provider,{value:n},e.children)}},46577(e,n,r){r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>p,frontMatter:()=>a,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"oop/Architecture/Onion","title":"Onion","description":"Onion Architecture organizes a system into concentric layers (like an onion) with the domain model at the center, and all dependencies pointing inward toward it.","source":"@site/docs/oop/6. Architecture/4. Onion.md","sourceDirName":"oop/6. Architecture","slug":"/oop/Architecture/Onion","permalink":"/handbook/docs/oop/Architecture/Onion","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":4,"frontMatter":{},"sidebar":"oopSidebar","previous":{"title":"Clean","permalink":"/handbook/docs/oop/Architecture/Clean"},"next":{"title":"OOP with Microservices","permalink":"/handbook/docs/oop/Architecture/OOP with Microservices"}}');var s=r(74848),t=r(28453);const a={},l=void 0,c={},o=[{value:"Onion Architecture Layers",id:"onion-architecture-layers",level:2},{value:"Domain Layer (Core)",id:"domain-layer-core",level:3},{value:"Domain Services Layer (Optional but often part of core)",id:"domain-services-layer-optional-but-often-part-of-core",level:3},{value:"Application Services Layer",id:"application-services-layer",level:3},{value:"Infrastructure Layer",id:"infrastructure-layer",level:3},{value:"Presentation Layer (UI)",id:"presentation-layer-ui",level:3},{value:"Dependency Rule",id:"dependency-rule",level:2},{value:"Example: Online Ordering System (Onion Architecture)",id:"example-online-ordering-system-onion-architecture",level:2},{value:"1. Domain Layer (Core)",id:"1-domain-layer-core",level:3},{value:"Entity",id:"entity",level:4},{value:"2. Application Services Layer",id:"2-application-services-layer",level:3},{value:"Repository Interface (Defined inward)",id:"repository-interface-defined-inward",level:4},{value:"Payment Interface",id:"payment-interface",level:4},{value:"Application Service",id:"application-service",level:4},{value:"3. Infrastructure Layer",id:"3-infrastructure-layer",level:3},{value:"Database Implementation",id:"database-implementation",level:4},{value:"External Payment Adapter",id:"external-payment-adapter",level:4},{value:"4. Presentation Layer (UI / API)",id:"4-presentation-layer-ui--api",level:3},{value:"How the Flow Works",id:"how-the-flow-works",level:2},{value:"Onion vs Clean vs Hexagonal",id:"onion-vs-clean-vs-hexagonal",level:2}];function d(e){const n={blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:"Onion Architecture organizes a system into concentric layers (like an onion) with the domain model at the center, and all dependencies pointing inward toward it."}),"\n",(0,s.jsx)(n.p,{children:"The core principles are:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"The domain model is the heart of the system."}),"\n",(0,s.jsx)(n.li,{children:"Business logic does not depend on infrastructure, UI, or frameworks."}),"\n",(0,s.jsx)(n.li,{children:"External concerns (databases, APIs, UI) live in the outer layers."}),"\n",(0,s.jsx)(n.li,{children:"Dependencies are inverted using interfaces."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"onion-architecture-layers",children:"Onion Architecture Layers"}),"\n",(0,s.jsx)(n.p,{children:"From inside \u2192 outside:"}),"\n",(0,s.jsx)(n.h3,{id:"domain-layer-core",children:"Domain Layer (Core)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Contains entities, value objects, and domain services."}),"\n",(0,s.jsx)(n.li,{children:"Holds the most important business rules."}),"\n",(0,s.jsx)(n.li,{children:"Has no dependencies on any other layers."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Examples: Order, Customer, Account, Invoice."}),"\n",(0,s.jsx)(n.h3,{id:"domain-services-layer-optional-but-often-part-of-core",children:"Domain Services Layer (Optional but often part of core)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Contains domain logic that doesn\u2019t naturally belong to a single entity."}),"\n",(0,s.jsx)(n.li,{children:"Still framework-agnostic."}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"application-services-layer",children:"Application Services Layer"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Coordinates use cases and workflows."}),"\n",(0,s.jsx)(n.li,{children:"Orchestrates domain objects."}),"\n",(0,s.jsx)(n.li,{children:"Defines interfaces for infrastructure services (repositories, messaging, email)."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Examples: PlaceOrderService, RegisterUserService."}),"\n",(0,s.jsx)(n.h3,{id:"infrastructure-layer",children:"Infrastructure Layer"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Implements interfaces defined in the application/domain layers."}),"\n",(0,s.jsx)(n.li,{children:"Contains database access, file systems, messaging, external APIs."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Examples: SQL repositories, REST clients, email senders."}),"\n",(0,s.jsx)(n.h3,{id:"presentation-layer-ui",children:"Presentation Layer (UI)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"User interfaces (web, mobile, desktop, API controllers)."}),"\n",(0,s.jsx)(n.li,{children:"Calls application services."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"dependency-rule",children:"Dependency Rule"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"All dependencies must point inward."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"That means:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Infrastructure depends on application/domain."}),"\n",(0,s.jsx)(n.li,{children:"Application depends on domain."}),"\n",(0,s.jsx)(n.li,{children:"Domain depends on nothing."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"example-online-ordering-system-onion-architecture",children:"Example: Online Ordering System (Onion Architecture)"}),"\n",(0,s.jsx)(n.p,{children:"Let\u2019s implement a Place Order feature."}),"\n",(0,s.jsx)(n.h3,{id:"1-domain-layer-core",children:"1. Domain Layer (Core)"}),"\n",(0,s.jsx)(n.h4,{id:"entity",children:"Entity"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"public class Order {\r\n    private int customerId;\r\n    private List<Item> items;\r\n\r\n    public Order(int customerId, List<Item> items) {\r\n        this.customerId = customerId;\r\n        this.items = items;\r\n    }\r\n\r\n    public double calculateTotal() {\r\n        return items.stream().mapToDouble(Item::getPrice).sum();\r\n    }\r\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"Pure business logic, no frameworks, no DB, no UI."}),"\n",(0,s.jsx)(n.h3,{id:"2-application-services-layer",children:"2. Application Services Layer"}),"\n",(0,s.jsx)(n.h4,{id:"repository-interface-defined-inward",children:"Repository Interface (Defined inward)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"public interface OrderRepository {\r\n    void save(Order order);\r\n}\n"})}),"\n",(0,s.jsx)(n.h4,{id:"payment-interface",children:"Payment Interface"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"public interface PaymentService {\r\n    void processPayment(Order order);\r\n}\n"})}),"\n",(0,s.jsx)(n.h4,{id:"application-service",children:"Application Service"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"public class PlaceOrderService {\r\n    private final OrderRepository orderRepository;\r\n    private final PaymentService paymentService;\r\n\r\n    public PlaceOrderService(OrderRepository orderRepository, PaymentService paymentService) {\r\n        this.orderRepository = orderRepository;\r\n        this.paymentService = paymentService;\r\n    }\r\n\r\n    public void placeOrder(int customerId, List<Item> items) {\r\n        Order order = new Order(customerId, items);\r\n        paymentService.processPayment(order);\r\n        orderRepository.save(order);\r\n    }\r\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"Coordinates the workflow using domain objects and abstractions."}),"\n",(0,s.jsx)(n.h3,{id:"3-infrastructure-layer",children:"3. Infrastructure Layer"}),"\n",(0,s.jsx)(n.h4,{id:"database-implementation",children:"Database Implementation"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"public class SqlOrderRepository implements OrderRepository {\r\n    @Override\r\n    public void save(Order order) {\r\n        // Save order to SQL database\r\n    }\r\n}\n"})}),"\n",(0,s.jsx)(n.h4,{id:"external-payment-adapter",children:"External Payment Adapter"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"public class StripePaymentService implements PaymentService {\r\n    @Override\r\n    public void processPayment(Order order) {\r\n        // Call Stripe API\r\n    }\r\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"Implements interfaces but depends on application/domain layers."}),"\n",(0,s.jsx)(n.h3,{id:"4-presentation-layer-ui--api",children:"4. Presentation Layer (UI / API)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'@RestController\r\npublic class OrderController {\r\n    private final PlaceOrderService placeOrderService;\r\n\r\n    public OrderController(PlaceOrderService placeOrderService) {\r\n        this.placeOrderService = placeOrderService;\r\n    }\r\n\r\n    @PostMapping("/orders")\r\n    public void placeOrder(@RequestBody OrderRequest request) {\r\n        placeOrderService.placeOrder(request.getCustomerId(), request.getItems());\r\n    }\r\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"Handles HTTP and delegates business logic to the application layer."}),"\n",(0,s.jsx)(n.h2,{id:"how-the-flow-works",children:"How the Flow Works"}),"\n",(0,s.jsx)(n.p,{children:"User \u2192 UI \u2192 Application Service \u2192 Domain \u2192 Infrastructure \u2192 External Systems"}),"\n",(0,s.jsx)(n.p,{children:"Even though execution flows outward, dependencies flow inward."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Advantages of Onion Architecture"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Strong domain focus"}),"\n",(0,s.jsx)(n.li,{children:"Business logic independent of frameworks"}),"\n",(0,s.jsx)(n.li,{children:"High testability"}),"\n",(0,s.jsx)(n.li,{children:"Infrastructure can be swapped easily"}),"\n",(0,s.jsx)(n.li,{children:"Encourages SOLID principles"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Disadvantages"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"More interfaces and abstraction"}),"\n",(0,s.jsx)(n.li,{children:"Learning curve"}),"\n",(0,s.jsx)(n.li,{children:"Overkill for very small/simple projects"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"onion-vs-clean-vs-hexagonal",children:"Onion vs Clean vs Hexagonal"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Feature"}),(0,s.jsx)(n.th,{children:"Onion"}),(0,s.jsx)(n.th,{children:"Clean"}),(0,s.jsx)(n.th,{children:"Hexagonal"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Structure"}),(0,s.jsx)(n.td,{children:"Concentric rings"}),(0,s.jsx)(n.td,{children:"Concentric rings"}),(0,s.jsx)(n.td,{children:"Core + ports/adapters"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Core focus"}),(0,s.jsx)(n.td,{children:"Domain model"}),(0,s.jsx)(n.td,{children:"Business rules (entities + use cases)"}),(0,s.jsx)(n.td,{children:"Core logic"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Ports/Interfaces"}),(0,s.jsx)(n.td,{children:"In application layer"}),(0,s.jsx)(n.td,{children:"Input/output boundaries"}),(0,s.jsx)(n.td,{children:"Explicit ports"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Dependency direction"}),(0,s.jsx)(n.td,{children:"Inward"}),(0,s.jsx)(n.td,{children:"Inward"}),(0,s.jsx)(n.td,{children:"Inward"})]})]})]})]})}function p(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);