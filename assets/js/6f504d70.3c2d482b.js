"use strict";(globalThis.webpackChunkhandbook=globalThis.webpackChunkhandbook||[]).push([[5341],{14155(e,n,t){t.r(n),t.d(n,{assets:()=>r,contentTitle:()=>l,default:()=>h,frontMatter:()=>c,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"javascript/Browser Execution/Execution Model","title":"Execution Model","description":"Visualize Execution//www.jsv9000.app/","source":"@site/docs/javascript/Browser Execution/7. Execution Model.md","sourceDirName":"javascript/Browser Execution","slug":"/javascript/Browser Execution/Execution Model","permalink":"/handbook/docs/javascript/Browser Execution/Execution Model","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":7,"frontMatter":{},"sidebar":"javascriptSidebar","previous":{"title":"Runtime","permalink":"/handbook/docs/javascript/Browser Execution/Runtime"}}');var o=t(74848),i=t(28453);const c={},l=void 0,r={},a=[{value:"Global Execution Context and Call Stack",id:"global-execution-context-and-call-stack",level:2},{value:"Execution Starts",id:"execution-starts",level:3},{value:"Asynchronous Task",id:"asynchronous-task",level:2},{value:"Local Execution Context",id:"local-execution-context",level:2},{value:"Logging the End of Script (Call Stack)",id:"logging-the-end-of-script-call-stack",level:2},{value:"Event Loop: Handling <code>setTimeout</code> (Macrotask Queue)",id:"event-loop-handling-settimeout-macrotask-queue",level:2},{value:"Event Loop: Handling <code>setTimeout</code> (Macrotask Queue)",id:"event-loop-handling-settimeout-macrotask-queue-1",level:2},{value:"Event Loop: Handling Microtasks (Microtask Queue)",id:"event-loop-handling-microtasks-microtask-queue",level:2}];function d(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:'// Global context (global execution context)\r\nconsole.log("Start of script");\r\nvar x = "Global Execution Context";\r\n\r\nPromise.resolve().then(() => {\r\n  console.log("Inside first Promise then (microtask)");\r\n});\r\n\r\nsetTimeout(() => {\r\n  console.log("Inside setTimeout (macrotask)");\r\n  Promise.resolve().then(() => {\r\n    console.log("Inside Promise then (microtask)");\r\n  });\r\n}, 1000);\r\n\r\nPromise.resolve().then(() => {\r\n  console.log("Inside last Promise then (microtask)");\r\n});\r\n\r\nfunction foo() {\r\n  let bar = "Hello from foo";\r\n  console.log(bar); // Accessing local variable bar\r\n}\r\n\r\nfoo();\r\n\r\nconsole.log("End of script");\n'})}),"\n",(0,o.jsxs)(n.p,{children:["Visualize Execution: ",(0,o.jsx)(n.a,{href:"https://www.jsv9000.app/",children:"https://www.jsv9000.app/"})]}),"\n",(0,o.jsx)(n.h2,{id:"global-execution-context-and-call-stack",children:"Global Execution Context and Call Stack"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Call Stack"}),": The first thing that happens when the script runs is that the global execution context is pushed onto the call stack. This is the top-level execution context for the whole script."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Global Scope"}),": The global context holds all the global variables and functions."]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"execution-starts",children:"Execution Starts"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["The global context starts execution and begins with ",(0,o.jsx)(n.code,{children:"console.log('Start of script')"})," and ...."]}),"\n",(0,o.jsx)(n.li,{children:"The call stack executes this log, and it\u2019s popped off the stack once executed."}),"\n",(0,o.jsxs)(n.li,{children:["Then, the global execution context proceeds to define the variable ",(0,o.jsx)(n.code,{children:"x"})," with the value ",(0,o.jsx)(n.code,{children:'"Global Execution Context"'}),", but nothing is printed for that as it's just an assignment."]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"asynchronous-task",children:"Asynchronous Task"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"setTimeout"})," and ",(0,o.jsx)(n.code,{children:"Promise.resolve().then(...)"})," are asynchronous functions."]}),"\n",(0,o.jsxs)(n.li,{children:["When the JavaScript engine encounters ",(0,o.jsx)(n.code,{children:"setTimeout"}),", it doesn't execute it immediately. Instead, it sends it to the ",(0,o.jsx)(n.strong,{children:"Web API"})," environment (which is part of the browser's JavaScript runtime).","\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"setTimeout"})," sets a timer for 1000 ms and doesn't block the execution."]}),"\n",(0,o.jsxs)(n.li,{children:["The ",(0,o.jsx)(n.code,{children:"Promise.resolve().then(...)"})," is also handed over to the ",(0,o.jsx)(n.strong,{children:"Web API"})," but for asynchronous execution. However, they are added to the ",(0,o.jsx)(n.strong,{children:"microtask queue"})," to be executed before macrotasks, ensuring that microtasks are executed first."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"local-execution-context",children:"Local Execution Context"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["The function ",(0,o.jsx)(n.code,{children:"foo()"})," is called, so a new stack frame is pushed onto the call stack."]}),"\n",(0,o.jsxs)(n.li,{children:["Inside ",(0,o.jsx)(n.code,{children:"foo()"}),", the variable ",(0,o.jsx)(n.code,{children:"bar"})," is declared and logged:","\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"let bar = 'Hello from foo'"})," creates a local variable in the ",(0,o.jsx)(n.code,{children:"foo"})," function's scope."]}),"\n",(0,o.jsx)(n.li,{children:"The call stack handles this code and executes it."}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["Once ",(0,o.jsx)(n.code,{children:"foo()"})," finishes executing, it is popped from the call stack, returning control to the global execution context."]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"logging-the-end-of-script-call-stack",children:"Logging the End of Script (Call Stack)"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"console.log('End of script')"})," is executed synchronously."]}),"\n",(0,o.jsx)(n.li,{children:"This is logged, and the function call is popped from the call stack."}),"\n"]}),"\n",(0,o.jsxs)(n.h2,{id:"event-loop-handling-settimeout-macrotask-queue",children:["Event Loop: Handling ",(0,o.jsx)(n.code,{children:"setTimeout"})," (Macrotask Queue)"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"Event Loop: Once all synchronous code finishes (i.e., the call stack is empty), the event loop checks if there are any tasks in the macrotask queue (also known as the task queue)."}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Macrotask Queue: The callback from ",(0,o.jsx)(n.code,{children:"setTimeout"})," (after 1000 ms) is now ready to be executed, so it is moved to the macrotask queue."]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"The event loop moves this task from the macrotask queue to the call stack for execution."}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["The ",(0,o.jsx)(n.code,{children:"console.log('Inside setTimeout (macrotask)')"})," is printed."]}),"\n",(0,o.jsxs)(n.li,{children:["Now, the callback for ",(0,o.jsx)(n.code,{children:"setTimeout"})," is popped from the call stack after execution."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.h2,{id:"event-loop-handling-settimeout-macrotask-queue-1",children:["Event Loop: Handling ",(0,o.jsx)(n.code,{children:"setTimeout"})," (Macrotask Queue)"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Event Loop: Once all synchronous code finishes (i.e., when the call stack is empty), the event loop checks if there are any tasks in the macrotask queue (also known as the task queue)."}),"\n",(0,o.jsxs)(n.li,{children:["Macrotask Queue: The callback function from ",(0,o.jsx)(n.code,{children:"setTimeout"})," (after 1000 ms) is now ready to be executed, so it is moved to the macrotask queue."]}),"\n",(0,o.jsxs)(n.li,{children:["The event loop picks up the task from the macrotask queue and moves it to the call stack for execution:","\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"console.log('Inside setTimeout (macrotask)')"})," is printed."]}),"\n",(0,o.jsxs)(n.li,{children:["After executing this, the callback for ",(0,o.jsx)(n.code,{children:"setTimeout"})," is popped from the call stack."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"event-loop-handling-microtasks-microtask-queue",children:"Event Loop: Handling Microtasks (Microtask Queue)"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Microtask Queue"}),": The microtask queue holds tasks that need to be executed after the current script finishes but before the event loop picks up any new tasks from the macrotask queue."]}),"\n",(0,o.jsxs)(n.li,{children:["After the macrotask (i.e., the ",(0,o.jsx)(n.code,{children:"setTimeout"})," callback) is executed, the event loop checks and executes tasks in the microtask queue. The first task in the queue is:","\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"console.log('Inside first Promise then (microtask)')"})," is printed."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["The next microtask is the promise inside the ",(0,o.jsx)(n.code,{children:"setTimeout"})," callback:","\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"console.log('Inside Promise then (microtask)')"})," is printed."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["The last microtask is the promise from the global context:","\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"console.log('Inside last Promise then (microtask)')"})," is printed."]}),"\n"]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},28453(e,n,t){t.d(n,{R:()=>c,x:()=>l});var s=t(96540);const o={},i=s.createContext(o);function c(e){const n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:c(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);