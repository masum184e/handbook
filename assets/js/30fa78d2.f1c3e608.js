"use strict";(globalThis.webpackChunkhandbook=globalThis.webpackChunkhandbook||[]).push([[3162],{28453(e,n,i){i.d(n,{R:()=>l,x:()=>d});var r=i(96540);const s={},c=r.createContext(s);function l(e){const n=r.useContext(c);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),r.createElement(c.Provider,{value:n},e.children)}},37516(e,n,i){i.r(n),i.d(n,{assets:()=>t,contentTitle:()=>d,default:()=>x,frontMatter:()=>l,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"nginx/Directives vs Blocks","title":"Directives vs Blocks","description":"NGINX configuration is built from directives. Some directives are simple (single-line), while others are block directives that contain nested directives.","source":"@site/docs/nginx/6. Directives vs Blocks.md","sourceDirName":"nginx","slug":"/nginx/Directives vs Blocks","permalink":"/handbook/docs/nginx/Directives vs Blocks","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":6,"frontMatter":{},"sidebar":"nginxApiSidebar","previous":{"title":"Contexts","permalink":"/handbook/docs/nginx/Contexts"},"next":{"title":"Include Directive","permalink":"/handbook/docs/nginx/Include Directive"}}');var s=i(74848),c=i(28453);const l={},d=void 0,t={},o=[{value:"Global Directive",id:"global-directive",level:2},{value:"Server Directive",id:"server-directive",level:2},{value:"Block Directives (Context Blocks)",id:"block-directives-context-blocks",level:2},{value:"HTTP Block",id:"http-block",level:3},{value:"Server Block",id:"server-block",level:3},{value:"Key Differences",id:"key-differences",level:2},{value:"How NGINX Processes Them Together",id:"how-nginx-processes-them-together",level:2},{value:"Inheritance &amp; Override Behavior",id:"inheritance--override-behavior",level:2}];function h(e){const n={code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,c.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:"NGINX configuration is built from directives. Some directives are simple (single-line), while others are block directives that contain nested directives."}),"\n",(0,s.jsx)(n.p,{children:"A directive is a single configuration instruction that:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"One line"}),"\n",(0,s.jsxs)(n.li,{children:["Ends with a semicolon (",(0,s.jsx)(n.code,{children:";"}),")"]}),"\n",(0,s.jsx)(n.li,{children:"Does not contain other directives"}),"\n",(0,s.jsx)(n.li,{children:"Executes a specific action"}),"\n",(0,s.jsx)(n.li,{children:"Valid only in certain contexts"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Syntax"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"directive_name value1 value2 ...;\n"})}),"\n",(0,s.jsx)(n.p,{children:"Common Core Directives"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Directive"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"worker_processes"})}),(0,s.jsx)(n.td,{children:"Number of worker processes"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"user"})}),(0,s.jsx)(n.td,{children:"User running workers"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"listen"})}),(0,s.jsx)(n.td,{children:"Port/IP"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"server_name"})}),(0,s.jsx)(n.td,{children:"Domain"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"root"})}),(0,s.jsx)(n.td,{children:"Document root"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"index"})}),(0,s.jsx)(n.td,{children:"Default file"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"error_log"})}),(0,s.jsx)(n.td,{children:"Error log path"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"global-directive",children:"Global Directive"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"worker_processes auto;\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"worker_processes"})," is a simple directive"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"auto"})," tells NGINX to detect CPU cores"]}),"\n",(0,s.jsx)(n.li,{children:"Valid in main context only"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"server-directive",children:"Server Directive"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"server_name example.com www.example.com;\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Defines which domains this server block handles"}),"\n",(0,s.jsxs)(n.li,{children:["Ends with ",(0,s.jsx)(n.code,{children:";"})]}),"\n",(0,s.jsx)(n.li,{children:"Valid inside server context"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"block-directives-context-blocks",children:"Block Directives (Context Blocks)"}),"\n",(0,s.jsx)(n.p,{children:"A block directive:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Contains curly braces ",(0,s.jsx)(n.code,{children:"{}"})]}),"\n",(0,s.jsx)(n.li,{children:"Can include other directives"}),"\n",(0,s.jsx)(n.li,{children:"Creates a configuration context"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"block_name {\r\n    directive1 value;\r\n    directive2 value;\r\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"Characteristics"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Defines scope and hierarchy"}),"\n",(0,s.jsx)(n.li,{children:"Contains nested directives"}),"\n",(0,s.jsx)(n.li,{children:"Does not end with ;"}),"\n",(0,s.jsx)(n.li,{children:"Controls inheritance behavior"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Common Block Directives"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Block"}),(0,s.jsx)(n.th,{children:"Purpose"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"events"})}),(0,s.jsx)(n.td,{children:"Connection handling"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"http"})}),(0,s.jsx)(n.td,{children:"Web configuration"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"server"})}),(0,s.jsx)(n.td,{children:"Virtual host"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"location"})}),(0,s.jsx)(n.td,{children:"URI matching"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"upstream"})}),(0,s.jsx)(n.td,{children:"Backend servers"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"http-block",children:"HTTP Block"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"http {\r\n    sendfile on;\r\n    keepalive_timeout 65;\r\n}\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"http"})," is a block directive"]}),"\n",(0,s.jsx)(n.li,{children:"Applies settings to all HTTP traffic"}),"\n",(0,s.jsx)(n.li,{children:"Contains multiple simple directives"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"server-block",children:"Server Block"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"server {\r\n    listen 80;\r\n    server_name example.com;\r\n}\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Defines a virtual host"}),"\n",(0,s.jsx)(n.li,{children:"Contains multiple simple directives"}),"\n",(0,s.jsx)(n.li,{children:"No semicolon after closing brace"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"key-differences",children:"Key Differences"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Feature"}),(0,s.jsx)(n.th,{children:"Directive"}),(0,s.jsx)(n.th,{children:"Block"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Ends with semicolon"}),(0,s.jsx)(n.td,{children:"\u2705 Yes"}),(0,s.jsx)(n.td,{children:"\u274c No"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Contains sub-directives"}),(0,s.jsx)(n.td,{children:"\u274c No"}),(0,s.jsx)(n.td,{children:"\u2705 Yes"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Defines context"}),(0,s.jsx)(n.td,{children:"\u274c No"}),(0,s.jsx)(n.td,{children:"\u2705 Yes"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Can be nested"}),(0,s.jsx)(n.td,{children:"\u274c No"}),(0,s.jsx)(n.td,{children:"\u2705 Yes"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Example"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"listen 80;"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"server {}"})})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"how-nginx-processes-them-together",children:"How NGINX Processes Them Together"}),"\n",(0,s.jsx)(n.p,{children:"NGINX reads configuration top-down, building a hierarchical tree of blocks and directives."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"http {\r\n    server {\r\n        location / {\r\n            root /var/www/html;\r\n        }\r\n    }\r\n}\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"http"})," block applies to all HTTP requests"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"server"})," block matches domain/IP"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"location"})," block matches URI"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"root"})," directive executes"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"inheritance--override-behavior",children:"Inheritance & Override Behavior"}),"\n",(0,s.jsx)(n.p,{children:"Directives inside blocks can:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Inherit values from parent blocks"}),"\n",(0,s.jsx)(n.li,{children:"Override parent values"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"http {\r\n    root /var/www/default;\r\n\r\n    server {\r\n        root /var/www/example;\r\n\r\n        location /images/ {\r\n            root /var/www/assets;\r\n        }\r\n    }\r\n}\n"})}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Context"}),(0,s.jsx)(n.th,{children:"Root Used"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/index.html"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/var/www/example"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/images/logo.png"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/var/www/assets"})})]})]})]})]})}function x(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}}}]);