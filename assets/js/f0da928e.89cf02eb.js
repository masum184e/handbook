"use strict";(globalThis.webpackChunkhandbook=globalThis.webpackChunkhandbook||[]).push([[14928],{28453(e,n,i){i.d(n,{R:()=>c,x:()=>l});var s=i(96540);const t={},r=s.createContext(t);function c(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),s.createElement(r.Provider,{value:n},e.children)}},85076(e,n,i){i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>o,frontMatter:()=>c,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"nginx/Basic Authentication","title":"Basic Authentication","description":"HTTP Basic Authentication is a simple authentication mechanism where:","source":"@site/docs/nginx/21. Basic Authentication.md","sourceDirName":"nginx","slug":"/nginx/Basic Authentication","permalink":"/handbook/docs/nginx/Basic Authentication","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":21,"frontMatter":{},"sidebar":"nginxApiSidebar","previous":{"title":"Restricting Access","permalink":"/handbook/docs/nginx/Restricting Access"},"next":{"title":"Log Format","permalink":"/handbook/docs/nginx/Logging/Log Format"}}');var t=i(74848),r=i(28453);const c={},l=void 0,d={},a=[{value:"Why Use Basic Auth in NGINX?",id:"why-use-basic-auth-in-nginx",level:2},{value:"How Basic Auth Works Internally",id:"how-basic-auth-works-internally",level:2},{value:"HTTP Flow",id:"http-flow",level:3},{value:"Core Directives for Basic Authentication",id:"core-directives-for-basic-authentication",level:2},{value:"<code>auth_basic</code>",id:"auth_basic",level:3},{value:"<code>auth_basic_user_file</code>",id:"auth_basic_user_file",level:3},{value:"Creating the Password File (.htpasswd)",id:"creating-the-password-file-htpasswd",level:2},{value:"Install tools",id:"install-tools",level:3},{value:"Create user",id:"create-user",level:3},{value:"Add more users",id:"add-more-users",level:3},{value:"Basic Authentication Example (Location-Level)",id:"basic-authentication-example-location-level",level:2},{value:"Server-Wide Basic Authentication",id:"server-wide-basic-authentication",level:2},{value:"Disable Auth for Specific Paths",id:"disable-auth-for-specific-paths",level:2},{value:"Combining Basic Auth with IP Restrictions (Best Practice)",id:"combining-basic-auth-with-ip-restrictions-best-practice",level:2},{value:"Protecting APIs with Basic Auth",id:"protecting-apis-with-basic-auth",level:2},{value:"Security Considerations &amp; Risks",id:"security-considerations--risks",level:2},{value:"Recommended Security Enhancements",id:"recommended-security-enhancements",level:2},{value:"Basic Auth vs Other Auth Methods",id:"basic-auth-vs-other-auth-methods",level:2},{value:"Common Mistakes",id:"common-mistakes",level:2},{value:"Best-Practice Production Setup",id:"best-practice-production-setup",level:2}];function h(e){const n={blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.p,{children:"HTTP Basic Authentication is a simple authentication mechanism where:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Client requests a protected resource"}),"\n",(0,t.jsxs)(n.li,{children:["Server responds with ",(0,t.jsx)(n.code,{children:"401 Unauthorized"})]}),"\n",(0,t.jsx)(n.li,{children:"Browser prompts for username & password"}),"\n",(0,t.jsxs)(n.li,{children:["Credentials are sent in the ",(0,t.jsx)(n.code,{children:"Authorization"})," header (Base64-encoded)"]}),"\n",(0,t.jsx)(n.li,{children:"NGINX validates credentials and allows or denies access"}),"\n"]}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"Base64 encoding is not encryption \u2014 credentials must be protected with HTTPS."}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"why-use-basic-auth-in-nginx",children:"Why Use Basic Auth in NGINX?"}),"\n",(0,t.jsx)(n.p,{children:"Basic Auth is best suited for:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Admin panels"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Internal dashboards"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Staging environments"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Quick protection for private endpoints"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Temporary security layers"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Easy to set up"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Handled at NGINX (no app changes)"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Not suitable for large public user bases"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"how-basic-auth-works-internally",children:"How Basic Auth Works Internally"}),"\n",(0,t.jsx)(n.h3,{id:"http-flow",children:"HTTP Flow"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Client \u2192 GET /admin\r\nServer \u2192 401 + WWW-Authenticate\r\nClient \u2192 Authorization: Basic dXNlcjpwYXNz\r\nServer \u2192 Validate \u2192 200 OK\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Credentials are sent with every request"}),"\n",(0,t.jsx)(n.li,{children:"Browser usually caches them for the session"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"core-directives-for-basic-authentication",children:"Core Directives for Basic Authentication"}),"\n",(0,t.jsx)(n.h3,{id:"auth_basic",children:(0,t.jsx)(n.code,{children:"auth_basic"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'auth_basic "Restricted Area";\n'})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Enables Basic Auth"}),"\n",(0,t.jsx)(n.li,{children:"The string is shown in the browser prompt"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"auth_basic_user_file",children:(0,t.jsx)(n.code,{children:"auth_basic_user_file"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"auth_basic_user_file /etc/nginx/.htpasswd;\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Path to credential file"}),"\n",(0,t.jsxs)(n.li,{children:["Format: ",(0,t.jsx)(n.code,{children:"username:hashed_password"})]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"creating-the-password-file-htpasswd",children:"Creating the Password File (.htpasswd)"}),"\n",(0,t.jsx)(n.h3,{id:"install-tools",children:"Install tools"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"sudo apt install apache2-utils # Debian/Ubuntu\r\nsudo yum install httpd-tools # RHEL/CentOS\n"})}),"\n",(0,t.jsx)(n.h3,{id:"create-user",children:"Create user"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"htpasswd -c /etc/nginx/.htpasswd admin\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"-c"})," \u2192 create file (use once)"]}),"\n",(0,t.jsx)(n.li,{children:"You\u2019ll be prompted for a password"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"add-more-users",children:"Add more users"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"htpasswd /etc/nginx/.htpasswd devuser\n"})}),"\n",(0,t.jsx)(n.h2,{id:"basic-authentication-example-location-level",children:"Basic Authentication Example (Location-Level)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'server {\r\n    listen 443 ssl;\r\n    server_name example.com;\r\n\r\n        ssl_certificate     /path/fullchain.pem;\r\n        ssl_certificate_key /path/privkey.pem;\r\n\r\n        location /admin/ {\r\n            auth_basic "Admin Area";\r\n            auth_basic_user_file /etc/nginx/.htpasswd;\r\n\r\n            root /var/www/admin;\r\n            index index.html;\r\n        }\r\n\r\n    }\n'})}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Directive"}),(0,t.jsx)(n.th,{children:"Purpose"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"auth_basic"})}),(0,t.jsx)(n.td,{children:"Enables authentication"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"auth_basic_user_file"})}),(0,t.jsx)(n.td,{children:"Credential store"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"location /admin/"})}),(0,t.jsx)(n.td,{children:"Protects only admin area"})]})]})]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Public site stays open"}),"\n",(0,t.jsx)(n.li,{children:"Admin area secured"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"server-wide-basic-authentication",children:"Server-Wide Basic Authentication"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'   server {\r\n   listen 443 ssl;\r\n   auth_basic "Private Site";\r\n   auth_basic_user_file /etc/nginx/.htpasswd;\r\n   }\n'})}),"\n",(0,t.jsx)(n.p,{children:"All paths are protected unless overridden."}),"\n",(0,t.jsx)(n.h2,{id:"disable-auth-for-specific-paths",children:"Disable Auth for Specific Paths"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"   location /health {\r\n   auth_basic off;\r\n   }\n"})}),"\n",(0,t.jsx)(n.p,{children:"Useful for load balancer health checks"}),"\n",(0,t.jsx)(n.h2,{id:"combining-basic-auth-with-ip-restrictions-best-practice",children:"Combining Basic Auth with IP Restrictions (Best Practice)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'    location /admin/ {\r\n    allow 192.168.1.0/24;\r\n    deny all;\r\n\r\n        auth_basic "Admin Area";\r\n        auth_basic_user_file /etc/nginx/.htpasswd;\r\n\r\n    }\n'})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Defense in depth"}),"\n",(0,t.jsx)(n.li,{children:"Reduces brute-force exposure"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"protecting-apis-with-basic-auth",children:"Protecting APIs with Basic Auth"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'    location /api/ {\r\n    auth_basic "API Access";\r\n    auth_basic_user_file /etc/nginx/api_users;\r\n    }\n'})}),"\n",(0,t.jsx)(n.p,{children:"Clients must send:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Authorization: Basic base64(user:password)\n"})}),"\n",(0,t.jsx)(n.h2,{id:"security-considerations--risks",children:"Security Considerations & Risks"}),"\n",(0,t.jsx)(n.p,{children:"Major Risks"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Risk"}),(0,t.jsx)(n.th,{children:"Mitigation"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Credentials visible over HTTP"}),(0,t.jsx)(n.td,{children:"Always use HTTPS"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Brute-force attacks"}),(0,t.jsxs)(n.td,{children:["Rate limit ",(0,t.jsx)(n.code,{children:"/admin"})]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Shared credentials"}),(0,t.jsx)(n.td,{children:"Use per-user accounts"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"No logout mechanism"}),(0,t.jsx)(n.td,{children:"Use short sessions"})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"recommended-security-enhancements",children:"Recommended Security Enhancements"}),"\n",(0,t.jsx)(n.p,{children:"Add Rate Limiting"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"location /admin/ {\r\n    limit_req zone=login burst=3 nodelay;\r\n}\n"})}),"\n",(0,t.jsx)(n.p,{children:"Log Authentication Failures"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"error_log /var/log/nginx/auth_error.log warn;\n"})}),"\n",(0,t.jsx)(n.h2,{id:"basic-auth-vs-other-auth-methods",children:"Basic Auth vs Other Auth Methods"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Risk"}),(0,t.jsx)(n.th,{children:"Mitigation"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Credentials visible over HTTP"}),(0,t.jsx)(n.td,{children:"Always use HTTPS"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Brute-force attacks"}),(0,t.jsxs)(n.td,{children:["Rate limit ",(0,t.jsx)(n.code,{children:"/admin"})]})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Shared credentials"}),(0,t.jsx)(n.td,{children:"Use per-user accounts"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"No logout mechanism"}),(0,t.jsx)(n.td,{children:"Use short sessions"})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"common-mistakes",children:"Common Mistakes"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Mistake"}),(0,t.jsx)(n.th,{children:"Impact"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Using Basic Auth without HTTPS"}),(0,t.jsx)(n.td,{children:"Credential theft"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsxs)(n.td,{children:["World-readable ",(0,t.jsx)(n.code,{children:".htpasswd"})]}),(0,t.jsx)(n.td,{children:"Security breach"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Reusing passwords"}),(0,t.jsx)(n.td,{children:"Account compromise"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"No rate limiting"}),(0,t.jsx)(n.td,{children:"Brute-force"})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"best-practice-production-setup",children:"Best-Practice Production Setup"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'location /admin/ {\r\n    allow 192.168.1.0/24;\r\n    deny all;\r\n\r\n    auth_basic "Admin Area";\r\n    auth_basic_user_file /etc/nginx/.htpasswd;\r\n\r\n    limit_req zone=admin burst=2 nodelay;\r\n}\n'})})]})}function o(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}}}]);