"use strict";(globalThis.webpackChunkhandbook=globalThis.webpackChunkhandbook||[]).push([[65872],{28453(e,n,s){s.d(n,{R:()=>r,x:()=>c});var l=s(96540);const i={},o=l.createContext(i);function r(e){const n=l.useContext(o);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),l.createElement(o.Provider,{value:n},e.children)}},30252(e,n,s){s.r(n),s.d(n,{assets:()=>t,contentTitle:()=>c,default:()=>u,frontMatter:()=>r,metadata:()=>l,toc:()=>d});const l=JSON.parse('{"id":"reactjs/Hooks/useMemo","title":"useMemo","description":"The useMemo hook is a React Hook used for performance optimization. It helps you avoid expensive recalculations by memoizing a computed value and recomputing it only when its dependencies change.","source":"@site/docs/reactjs/11. Hooks/3. useMemo.md","sourceDirName":"reactjs/11. Hooks","slug":"/reactjs/Hooks/useMemo","permalink":"/handbook/docs/reactjs/Hooks/useMemo","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{},"sidebar":"reactjsApiSidebar","previous":{"title":"useRef","permalink":"/handbook/docs/reactjs/Hooks/useRef"},"next":{"title":"useCallback","permalink":"/handbook/docs/reactjs/Hooks/useCallback"}}');var i=s(74848),o=s(28453);const r={},c=void 0,t={},d=[{value:"What is <code>useMemo</code>",id:"what-is-usememo",level:2},{value:"Why Do We Need <code>useMemo</code>",id:"why-do-we-need-usememo",level:2},{value:"When Should You Use useMemo?",id:"when-should-you-use-usememo",level:2},{value:"Syntax of useMemo",id:"syntax-of-usememo",level:2},{value:"How useMemo Works Internally (Concept)",id:"how-usememo-works-internally-concept",level:2},{value:"Simple Example \u2013 Basic Calculation",id:"simple-example--basic-calculation",level:2},{value:"Without useMemo (Inefficient)",id:"without-usememo-inefficient",level:3},{value:"Expensive Calculation Example",id:"expensive-calculation-example",level:2},{value:"Slow Function",id:"slow-function",level:3},{value:"Without <code>useMemo</code>",id:"without-usememo",level:3},{value:"With <code>useMemo</code>",id:"with-usememo",level:3},{value:"<code>useMemo</code> with Arrays (Filtering Example)",id:"usememo-with-arrays-filtering-example",level:2},{value:"useMemo with Objects &amp; Referential Equality",id:"usememo-with-objects--referential-equality",level:2},{value:"<code>useMemo</code> vs <code>useCallback</code>",id:"usememo-vs-usecallback",level:2},{value:"Common Mistakes",id:"common-mistakes",level:2}];function a(e){const n={code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"useMemo"})," hook is a React Hook used for performance optimization. It helps you avoid expensive recalculations by memoizing a computed value and recomputing it only when its dependencies change."]}),"\n",(0,i.jsxs)(n.h2,{id:"what-is-usememo",children:["What is ",(0,i.jsx)(n.code,{children:"useMemo"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"useMemo"})," memorizes the result of a function. It returns a cached value and recalculates it only when its dependencies change."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"const memoizedValue = useMemo(() => computeExpensiveValue(), [dependencies]);\n"})}),"\n",(0,i.jsxs)(n.h2,{id:"why-do-we-need-usememo",children:["Why Do We Need ",(0,i.jsx)(n.code,{children:"useMemo"})]}),"\n",(0,i.jsx)(n.p,{children:"In React:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Components re-render frequently"}),"\n",(0,i.jsx)(n.li,{children:"All functions inside a component run again on every render"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"If you have:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Heavy calculations"}),"\n",(0,i.jsx)(n.li,{children:"Large loops"}),"\n",(0,i.jsx)(n.li,{children:"Expensive filtering or sorting"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"useMemo"})," prevents unnecessary recalculations and improves performance."]}),"\n",(0,i.jsx)(n.h2,{id:"when-should-you-use-usememo",children:"When Should You Use useMemo?"}),"\n",(0,i.jsxs)(n.p,{children:["Use ",(0,i.jsx)(n.code,{children:"useMemo"})," when:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"A calculation is expensive"}),"\n",(0,i.jsx)(n.li,{children:"The same value is recalculated on every render"}),"\n",(0,i.jsx)(n.li,{children:"Performance issues are noticeable"}),"\n",(0,i.jsx)(n.li,{children:"A derived value depends on props or state"}),"\n",(0,i.jsx)(n.li,{children:"You want referential equality for objects or arrays"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Do not overuse ",(0,i.jsx)(n.code,{children:"useMemo"}),". It also has a cost."]}),"\n",(0,i.jsx)(n.h2,{id:"syntax-of-usememo",children:"Syntax of useMemo"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"const memoizedValue = useMemo(() => {\r\n  return someCalculation;\r\n}, [dependency1, dependency2]);\n"})}),"\n",(0,i.jsx)(n.p,{children:"Parameters"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Callback function \u2013 returns the computed value"}),"\n",(0,i.jsx)(n.li,{children:"Dependency array \u2013 controls when recalculation happens"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"how-usememo-works-internally-concept",children:"How useMemo Works Internally (Concept)"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"React stores the computed value"}),"\n",(0,i.jsxs)(n.li,{children:["On re-render:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"If dependencies did not change \u2192 return cached value"}),"\n",(0,i.jsx)(n.li,{children:"If dependencies changed \u2192 recompute value"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"simple-example--basic-calculation",children:"Simple Example \u2013 Basic Calculation"}),"\n",(0,i.jsx)(n.h3,{id:"without-usememo-inefficient",children:"Without useMemo (Inefficient)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"function App() {\r\n  const [count, setCount] = React.useState(0);\r\n\r\n  const double = count * 2;\r\n\r\n  return (\r\n    <>\r\n      <h2>{double}</h2>\r\n      <button onClick={() => setCount(count + 1)}>+</button>\r\n    </>\r\n  );\r\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"This is fine for simple calculations."}),"\n",(0,i.jsx)(n.h2,{id:"expensive-calculation-example",children:"Expensive Calculation Example"}),"\n",(0,i.jsx)(n.h3,{id:"slow-function",children:"Slow Function"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:'function slowFunction(num) {\r\n  console.log("Calculating...");\r\n  for (let i = 0; i < 1e9; i++) {}\r\n  return num * 2;\r\n}\n'})}),"\n",(0,i.jsxs)(n.h3,{id:"without-usememo",children:["Without ",(0,i.jsx)(n.code,{children:"useMemo"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:'function App() {\r\n  const [count, setCount] = React.useState(0);\r\n  const [text, setText] = React.useState("");\r\n\r\n  const result = slowFunction(count);\r\n\r\n  return (\r\n    <>\r\n      <h2>Result: {result}</h2>\r\n      <input onChange={(e) => setText(e.target.value)} />\r\n      <button onClick={() => setCount(count + 1)}>+</button>\r\n    </>\r\n  );\r\n}\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Typing in the input causes re-render"}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"slowFunction"})," runs every time"]}),"\n",(0,i.jsx)(n.li,{children:"App becomes slow"}),"\n"]}),"\n",(0,i.jsxs)(n.h3,{id:"with-usememo",children:["With ",(0,i.jsx)(n.code,{children:"useMemo"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:'import { useMemo, useState } from "react";\r\n\r\nfunction App() {\r\n  const [count, setCount] = useState(0);\r\n  const [text, setText] = useState("");\r\n\r\n  const result = useMemo(() => {\r\n    return slowFunction(count);\r\n  }, [count]);\r\n\r\n  return (\r\n    <>\r\n      <h2>Result: {result}</h2>\r\n      <input onChange={(e) => setText(e.target.value)} />\r\n      <button onClick={() => setCount(count + 1)}>+</button>\r\n    </>\r\n  );\r\n}\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"slowFunction"})," runs only when ",(0,i.jsx)(n.code,{children:"count"})," changes"]}),"\n",(0,i.jsx)(n.li,{children:"Typing in input no longer triggers heavy computation"}),"\n",(0,i.jsx)(n.li,{children:"Performance improves significantly"}),"\n"]}),"\n",(0,i.jsxs)(n.h2,{id:"usememo-with-arrays-filtering-example",children:[(0,i.jsx)(n.code,{children:"useMemo"})," with Arrays (Filtering Example)"]}),"\n",(0,i.jsxs)(n.p,{children:["Without ",(0,i.jsx)(n.code,{children:"useMemo"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"const filteredUsers = users.filter((user) => user.age > 18);\n"})}),"\n",(0,i.jsx)(n.p,{children:"Runs on every render."}),"\n",(0,i.jsxs)(n.p,{children:["With ",(0,i.jsx)(n.code,{children:"useMemo"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"const filteredUsers = useMemo(() => {\r\n  return users.filter((user) => user.age > 18);\r\n}, [users]);\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Filter runs only when ",(0,i.jsx)(n.code,{children:"users"})," changes"]}),"\n",(0,i.jsx)(n.li,{children:"Useful for large lists"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"usememo-with-objects--referential-equality",children:"useMemo with Objects & Referential Equality"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Problem"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:'const options = { mode: "dark" };\r\n\r\n<ChildComponent options={options} />;\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"New object created on every render"}),"\n",(0,i.jsx)(n.li,{children:"Child re-renders unnecessarily"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsxs)(n.strong,{children:["Solution with ",(0,i.jsx)(n.code,{children:"useMemo"})]})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:'const options = useMemo(() => {\r\n  return { mode: "dark" };\r\n}, []);\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Explanation"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Same object reference is reused"}),"\n",(0,i.jsx)(n.li,{children:"Prevents unnecessary child re-renders"}),"\n"]}),"\n",(0,i.jsxs)(n.h2,{id:"usememo-vs-usecallback",children:[(0,i.jsx)(n.code,{children:"useMemo"})," vs ",(0,i.jsx)(n.code,{children:"useCallback"})]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"useMemo"}),(0,i.jsx)(n.th,{children:"useCallback"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsxs)(n.td,{children:["Memoizes a ",(0,i.jsx)(n.strong,{children:"value"})]}),(0,i.jsxs)(n.td,{children:["Memoizes a ",(0,i.jsx)(n.strong,{children:"function"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Returns result"}),(0,i.jsx)(n.td,{children:"Returns function"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Used for calculations"}),(0,i.jsx)(n.td,{children:"Used for event handlers"})]})]})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"useCallback(fn, deps) === useMemo(() => fn, deps);\n"})}),"\n",(0,i.jsx)(n.h2,{id:"common-mistakes",children:"Common Mistakes"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Overusing useMemo"}),"\n",(0,i.jsx)(n.li,{children:"Using it for cheap calculations"}),"\n",(0,i.jsx)(n.li,{children:"Missing dependencies"}),"\n",(0,i.jsx)(n.li,{children:"Using it to fix logic bugs"}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}}}]);