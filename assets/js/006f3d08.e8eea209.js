"use strict";(globalThis.webpackChunkhandbook=globalThis.webpackChunkhandbook||[]).push([[3406],{14714(e,n,i){i.r(n),i.d(n,{assets:()=>t,contentTitle:()=>l,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"nextjs/Image Optimization","title":"Image Optimization","description":"Optimized images reduce page load time, improving user experience and SEO.","source":"@site/docs/nextjs/7. Image Optimization.md","sourceDirName":"nextjs","slug":"/nextjs/Image Optimization","permalink":"/handbook/docs/nextjs/Image Optimization","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":8,"frontMatter":{"title":"Image Optimization","sidebar_position":8},"sidebar":"nextjsSidebar","previous":{"title":"Router","permalink":"/handbook/docs/nextjs/Router"},"next":{"title":"Font Optimization","permalink":"/handbook/docs/nextjs/Font Optimization"}}');var r=i(74848),o=i(28453);const a={title:"Image Optimization",sidebar_position:8},l=void 0,t={},d=[{value:"<code>&lt;Image&gt;</code> Component",id:"image-component",level:2},{value:"Responsive Images",id:"responsive-images",level:3},{value:"Serve Next-Gen Formats",id:"serve-next-gen-formats",level:3},{value:"Blur Placeholder for Lazy-Loaded Images",id:"blur-placeholder-for-lazy-loaded-images",level:3},{value:"How Lazy Loading Works",id:"how-lazy-loading-works",level:2},{value:"Configuring External Image",id:"configuring-external-image",level:2},{value:"Configuring External Image Domains",id:"configuring-external-image-domains",level:3},{value:"Advance Configuration",id:"advance-configuration",level:3}];function c(e){const n={code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:"Optimized images reduce page load time, improving user experience and SEO."}),"\n",(0,r.jsxs)(n.h2,{id:"image-component",children:[(0,r.jsx)("code",{children:"<Image>"})," Component"]}),"\n",(0,r.jsxs)(n.p,{children:["The Next.js ",(0,r.jsx)("code",{children:"<Image>"})," component provides automatic optimizations:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Lazy loading (except for priority images)"}),"\n",(0,r.jsx)(n.li,{children:"Responsive resizing based on device viewport"}),"\n",(0,r.jsx)(n.li,{children:"Automatic WebP/AVIF conversion (when supported by the browser)"}),"\n",(0,r.jsxs)(n.li,{children:["Prevents layout shift by requiring ",(0,r.jsx)(n.code,{children:"width"})," & ",(0,r.jsx)(n.code,{children:"height"})," or ",(0,r.jsx)(n.code,{children:"fill"})]}),"\n",(0,r.jsx)(n.li,{children:"CDN caching (if deployed on Vercel, images are globally cached)"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:'<Image\r\n  src="/example.jpg"\r\n  alt="Example Image"\r\n  width={500}\r\n  height={300}\r\n  quality={80} // default is 75\r\n  priority // preloads the image\r\n/>\n'})}),"\n",(0,r.jsxs)(n.p,{children:["Instead of setting a fixed width and height, use ",(0,r.jsx)(n.code,{children:'layout="responsive"'})," to make the image adjust dynamically."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:'<Image\r\n  src="/my-image.jpg"\r\n  alt="Responsive Image"\r\n  layout="responsive"\r\n  width={16} // Aspect ratio\r\n  height={9} // Aspect ratio\r\n/>\n'})}),"\n",(0,r.jsx)(n.h3,{id:"responsive-images",children:"Responsive Images"}),"\n",(0,r.jsxs)(n.p,{children:["Instead of fixed dimensions, use ",(0,r.jsx)(n.code,{children:"fill"})," with a parent container for responsive layouts:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:'<div className="relative w-full h-64">\r\n  <Image\r\n    src="/my-image.jpg"\r\n    alt="Responsive Image"\r\n    fill\r\n    sizes="(max-width: 768px) 100vw, 50vw" // helps with responsive optimization\r\n    priority\r\n  />\r\n</div>\n'})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"fill"})," makes the image automatically scale within the container."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"sizes"})," ensures the browser only downloads the necessary image size."]}),"\n",(0,r.jsx)(n.li,{children:"No layout shift, since the container controls dimensions"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"serve-next-gen-formats",children:"Serve Next-Gen Formats"}),"\n",(0,r.jsx)(n.p,{children:"WebP and AVIF formats reduce file size while maintaining quality.\r\nNext.js automatically detects browser support and serves optimized formats without extra configuration."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:'<Image\r\n  src="/example.jpg"\r\n  alt="Optimized Image"\r\n  width={500}\r\n  height={300}\r\n  quality={80}\r\n  formats={["image/webp", "image/avif"]} // Converts to WebP/AVIF\r\n/>\n'})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Smaller file sizes compared to PNG/JPG"}),"\n",(0,r.jsx)(n.li,{children:"Better performance with no extra setup needed"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"blur-placeholder-for-lazy-loaded-images",children:"Blur Placeholder for Lazy-Loaded Images"}),"\n",(0,r.jsx)(n.p,{children:"Next.js supports showing a low-resolution blurred version before the full image loads, improving perceived performance."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-tsx",children:'<Image\r\n  src="/example.jpg"\r\n  alt="Blurred Image"\r\n  width={500}\r\n  height={300}\r\n  placeholder="blur"\r\n  blurDataURL="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQ..."\r\n/>\n'})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Enhances user experience for slow connections"}),"\n",(0,r.jsx)(n.li,{children:"Useful for large or hero images"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"how-lazy-loading-works",children:"How Lazy Loading Works"}),"\n",(0,r.jsx)(n.p,{children:"Lazy Loading means images below the viewport are not loaded until scrolled into view, reducing initial page load time."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["By default, Next.js ",(0,r.jsx)("code",{children:"<Image>"})," uses ",(0,r.jsx)(n.code,{children:'loading="lazy"'})," for any image that is not in the initial viewport."]}),"\n",(0,r.jsx)(n.li,{children:"That means images below the fold will load only when needed, saving bandwidth."}),"\n",(0,r.jsxs)(n.li,{children:["You can override this behavior with ",(0,r.jsx)(n.code,{children:"priority={true}"})," (for critical images like logos or hero banners)."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"configuring-external-image",children:"Configuring External Image"}),"\n",(0,r.jsxs)(n.p,{children:["By default, Next.js ",(0,r.jsx)("code",{children:"<Image>"})," only optimizes images stored locally in your project (",(0,r.jsx)(n.code,{children:"/public"}),").\r\nIf you want to use images hosted on external domains (e.g., a CDN, CMS, or API like Unsplash, Cloudinary, Strapi, Sanity), you must explicitly allow those domains in your Next.js config."]}),"\n",(0,r.jsx)(n.p,{children:"This is required because:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"It prevents abuse (e.g., optimizing someone else\u2019s images without permission)."}),"\n",(0,r.jsx)(n.li,{children:"Ensures Next.js knows which domains are trusted for optimization."}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"configuring-external-image-domains",children:"Configuring External Image Domains"}),"\n",(0,r.jsxs)(n.p,{children:["You configure allowed domains in ",(0,r.jsx)(n.code,{children:"next.config.js"})," under the ",(0,r.jsx)(n.code,{children:"images.domains"})," property."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:'// next.config.js\r\nmodule.exports = {\r\n  images: {\r\n    domains: ["images.unsplash.com", "res.cloudinary.com"],\r\n  },\r\n};\n'})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"images.unsplash.com"})," \u2192 lets you use Unsplash images."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"res.cloudinary.com"})," \u2192 allows Cloudinary-hosted images."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Explaination"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"The src points to external URLs."}),"\n",(0,r.jsxs)(n.li,{children:["Next.js will:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Fetch and cache the image on first request."}),"\n",(0,r.jsx)(n.li,{children:"Optimize and serve it in modern formats (WebP/AVIF)."}),"\n",(0,r.jsx)(n.li,{children:"Generate responsive sizes automatically."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Because we added domains in ",(0,r.jsx)(n.code,{children:"next.config.js"}),", Next.js trusts these sources."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"advance-configuration",children:"Advance Configuration"}),"\n",(0,r.jsxs)(n.p,{children:["If your images come from multiple subdomains or APIs, you can use ",(0,r.jsx)(n.code,{children:"remotePatterns"})," (more flexible than ",(0,r.jsx)(n.code,{children:"domains"}),")."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:'// next.config.js\r\nmodule.exports = {\r\n  images: {\r\n    remotePatterns: [\r\n      {\r\n        protocol: "https",\r\n        hostname: "example.com",\r\n        port: "",\r\n        pathname: "/images/**",\r\n      },\r\n      {\r\n        protocol: "https",\r\n        hostname: "cdn.myapp.com",\r\n        pathname: "/assets/**",\r\n      },\r\n    ],\r\n  },\r\n};\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Why This Matters"})}),"\n",(0,r.jsx)(n.p,{children:"Without this config, you\u2019ll see an error like:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"Invalid src prop (https://...) on `next/image`, hostname not configured under images in your `next.config.js`\n"})}),"\n",(0,r.jsx)(n.p,{children:"Configuring domains makes your app secure, optimized, and production-ready."})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},28453(e,n,i){i.d(n,{R:()=>a,x:()=>l});var s=i(96540);const r={},o=s.createContext(r);function a(e){const n=s.useContext(o);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);