"use strict";(globalThis.webpackChunkhandbook=globalThis.webpackChunkhandbook||[]).push([[3758],{28453(e,n,r){r.d(n,{R:()=>l,x:()=>d});var i=r(96540);const s={},t=i.createContext(s);function l(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),i.createElement(t.Provider,{value:n},e.children)}},35854(e,n,r){r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>d,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"mysql/Triggers","title":"Triggers","description":"A Trigger in MySQL is a database object that is automatically executed (\u201cfired\u201d) when a specific event (INSERT, UPDATE, DELETE) occurs on a table.","source":"@site/docs/mysql/14. Triggers.md","sourceDirName":"mysql","slug":"/mysql/Triggers","permalink":"/handbook/docs/mysql/Triggers","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":15,"frontMatter":{"sidebar_position":15},"sidebar":"mysqlSidebar","previous":{"title":"Stored Function","permalink":"/handbook/docs/mysql/Stored Function"},"next":{"title":"Events","permalink":"/handbook/docs/mysql/Events"}}');var s=r(74848),t=r(28453);const l={sidebar_position:15},d=void 0,a={},c=[{value:"Syntax for Creating a Trigger",id:"syntax-for-creating-a-trigger",level:2},{value:"BEFORE INSERT Trigger (data validation)",id:"before-insert-trigger-data-validation",level:2},{value:"AFTER INSERT Trigger (audit logging)",id:"after-insert-trigger-audit-logging",level:2},{value:"Managing Triggers",id:"managing-triggers",level:2},{value:"Common Use Cases for Triggers",id:"common-use-cases-for-triggers",level:2},{value:"Summary of Use Cases of Triggers",id:"summary-of-use-cases-of-triggers",level:3}];function o(e){const n={code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.p,{children:["A Trigger in MySQL is a database object that is automatically executed (\u201cfired\u201d) when a specific event (",(0,s.jsx)(n.code,{children:"INSERT"}),", ",(0,s.jsx)(n.code,{children:"UPDATE"}),", ",(0,s.jsx)(n.code,{children:"DELETE"}),") occurs on a table."]}),"\n",(0,s.jsx)(n.p,{children:"They\u2019re useful for:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Enforcing business rules"}),"\n",(0,s.jsx)(n.li,{children:"Maintaining audit logs"}),"\n",(0,s.jsx)(n.li,{children:"Automatically updating related tables"}),"\n",(0,s.jsx)(n.li,{children:"Validating or transforming data before saving"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"syntax-for-creating-a-trigger",children:"Syntax for Creating a Trigger"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"CREATE TRIGGER trigger_name\r\ntrigger_time trigger_event\r\nON table_name\r\nFOR EACH ROW\r\nBEGIN\r\n   -- SQL statements\r\nEND;\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"trigger_name"})," \u2192 Name of the trigger (must be unique per table + event + timing)."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"trigger_time"})," \u2192 Either ",(0,s.jsx)(n.code,{children:"BEFORE"})," or ",(0,s.jsx)(n.code,{children:"AFTER"})," (when the trigger runs relative to the event)."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"trigger_event"})," \u2192 The event that activates the trigger:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"INSERT"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"UPDATE"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"DELETE"})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"table_name"})," \u2192 The table on which the trigger is defined."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"FOR EACH ROW"})," \u2192 Trigger executes once for every affected row."]}),"\n",(0,s.jsxs)(n.li,{children:["Inside the body, you can use:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"NEW.column_name"})," \u2192 Refers to new values (for ",(0,s.jsx)(n.code,{children:"INSERT"}),"/",(0,s.jsx)(n.code,{children:"UPDATE"}),")"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"OLD.column_name"})," \u2192 Refers to existing values (for ",(0,s.jsx)(n.code,{children:"UPDATE"}),"/",(0,s.jsx)(n.code,{children:"DELETE"}),")"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"before-insert-trigger-data-validation",children:"BEFORE INSERT Trigger (data validation)"}),"\n",(0,s.jsx)(n.p,{children:"Suppose we want to prevent inserting employees with negative salaries:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"DELIMITER //\r\n\r\nCREATE TRIGGER before_employee_insert\r\nBEFORE INSERT ON employees\r\nFOR EACH ROW\r\nBEGIN\r\n   IF NEW.salary < 0 THEN\r\n      SET NEW.salary = 0;  -- fix invalid salary\r\n   END IF;\r\nEND //\r\n\r\nDELIMITER ;\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Runs before an ",(0,s.jsx)(n.code,{children:"INSERT"})," on ",(0,s.jsx)(n.code,{children:"employees"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["If someone tries to insert a salary ",(0,s.jsx)(n.code,{children:"< 0"}),", it automatically changes it to ",(0,s.jsx)(n.code,{children:"0"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"after-insert-trigger-audit-logging",children:"AFTER INSERT Trigger (audit logging)"}),"\n",(0,s.jsxs)(n.p,{children:["Suppose we want to log every new employee added into an ",(0,s.jsx)(n.code,{children:"employee_audit"})," table:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE employee_audit (\r\n   audit_id INT AUTO_INCREMENT PRIMARY KEY,\r\n   employee_id INT,\r\n   action VARCHAR(50),\r\n   action_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP\r\n);\n"})}),"\n",(0,s.jsx)(n.p,{children:"Now create the trigger:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"DELIMITER //\r\n\r\nCREATE TRIGGER after_employee_insert\r\nAFTER INSERT ON employees\r\nFOR EACH ROW\r\nBEGIN\r\n   INSERT INTO employee_audit (employee_id, action)\r\n   VALUES (NEW.employee_id, 'INSERT');\r\nEND //\r\n\r\nDELIMITER ;\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Runs after inserting a row into ",(0,s.jsx)(n.code,{children:"employees"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Writes a record in ",(0,s.jsx)(n.code,{children:"employee_audit"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"managing-triggers",children:"Managing Triggers"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Show triggers in a database: ",(0,s.jsx)(n.code,{children:"SHOW TRIGGERS"})]}),"\n",(0,s.jsxs)(n.li,{children:["Drop a trigger: ",(0,s.jsx)(n.code,{children:"DROP TRIGGER after_employee_insert;"})]}),"\n",(0,s.jsxs)(n.li,{children:["Check trigger definition: ",(0,s.jsx)(n.code,{children:"SHOW CREATE TRIGGER before_employee_update"})]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"common-use-cases-for-triggers",children:"Common Use Cases for Triggers"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Audit Logging (Tracking Changes):"})," Keep a record of all changes (INSERT, UPDATE, DELETE) to critical tables (like employees, accounts, orders)."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Data Validation and Integrity:"})," Prevent invalid data from being inserted/updated (business rules enforcement)."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Cascading Actions (Automatic Updates/Deletes):"})," Maintain consistency between related tables."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Derived/Computed Values:"})," Automatically calculate or update derived fields."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Enforcing Security Rules:"})," Restrict certain operations automatically."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Synchronizing Tables (Replication-like Behavior):"})," Automatically keep a summary table in sync."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"summary-of-use-cases-of-triggers",children:"Summary of Use Cases of Triggers"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Use Case"}),(0,s.jsx)(n.th,{children:"Trigger Type"}),(0,s.jsx)(n.th,{children:"Example"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Audit logging"})}),(0,s.jsx)(n.td,{children:"AFTER INSERT/UPDATE/DELETE"}),(0,s.jsx)(n.td,{children:"Track who changed what & when"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Validation"})}),(0,s.jsx)(n.td,{children:"BEFORE INSERT/UPDATE"}),(0,s.jsx)(n.td,{children:"Prevent invalid salaries"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Cascading actions"})}),(0,s.jsx)(n.td,{children:"AFTER DELETE"}),(0,s.jsx)(n.td,{children:"Archive deleted rows"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Computed values"})}),(0,s.jsx)(n.td,{children:"BEFORE INSERT/UPDATE"}),(0,s.jsx)(n.td,{children:"Auto-calc total price"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Security enforcement"})}),(0,s.jsx)(n.td,{children:"BEFORE DELETE"}),(0,s.jsx)(n.td,{children:"Prevent deleting managers"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Synchronization"})}),(0,s.jsx)(n.td,{children:"AFTER INSERT/UPDATE"}),(0,s.jsx)(n.td,{children:"Maintain summary table"})]})]})]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}}}]);