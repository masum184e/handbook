"use strict";(globalThis.webpackChunkhandbook=globalThis.webpackChunkhandbook||[]).push([[6095],{28453(e,s,n){n.d(s,{R:()=>d,x:()=>l});var r=n(96540);const t={},i=r.createContext(t);function d(e){const s=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:d(e.components),r.createElement(i.Provider,{value:s},e.children)}},62836(e,s,n){n.r(s),n.d(s,{assets:()=>o,contentTitle:()=>l,default:()=>u,frontMatter:()=>d,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"system-design/Queue","title":"Queue","description":"Queue is a data structure or service that temporarily holds tasks, messages, or requests in a First-In-First-Out (FIFO) manner until they can be processed. It acts as a buffer between components that produce and consume data at different speeds.","source":"@site/docs/system-design/11. Queue.md","sourceDirName":"system-design","slug":"/system-design/Queue","permalink":"/handbook/docs/system-design/Queue","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":12,"frontMatter":{"sidebar_position":12},"sidebar":"systemDesignSidebar","previous":{"title":"Performance","permalink":"/handbook/docs/system-design/Performance"},"next":{"title":"Latency","permalink":"/handbook/docs/system-design/Latency/Latency"}}');var t=n(74848),i=n(28453);const d={sidebar_position:12},l=void 0,o={},c=[{value:"Why Use a Queue",id:"why-use-a-queue",level:2},{value:"Types of Queue",id:"types-of-queue",level:2},{value:"Where does a queue build up",id:"where-does-a-queue-build-up",level:2},{value:"Example of Queue",id:"example-of-queue",level:2},{value:"Without a Queue (Synchronous):",id:"without-a-queue-synchronous",level:3},{value:"With a Queue (Asynchronous):",id:"with-a-queue-asynchronous",level:3},{value:"Common Queue Tools",id:"common-queue-tools",level:2},{value:"Strategy to Prevent Queue",id:"strategy-to-prevent-queue",level:2}];function h(e){const s={code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.p,{children:"Queue is a data structure or service that temporarily holds tasks, messages, or requests in a First-In-First-Out (FIFO) manner until they can be processed. It acts as a buffer between components that produce and consume data at different speeds."}),"\n",(0,t.jsx)(s.h2,{id:"why-use-a-queue",children:"Why Use a Queue"}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Decoupling"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Producers (e.g., web servers) and consumers (e.g., workers) operate independently."}),"\n",(0,t.jsx)(s.li,{children:"A failure or slowdown in one does not directly impact the other."}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Scalability"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Multiple consumers can be added to process messages in parallel."}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Load Buffering"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Sudden spikes in traffic can be absorbed by the queue instead of overwhelming the system."}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Reliability and Persistence"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Messages can be persisted until processed, ensuring tasks aren\u2019t lost on failure."}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.strong,{children:"Asynchronous Processing"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Time-consuming tasks (e.g., video rendering, email sending) can be deferred without blocking user requests."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"types-of-queue",children:"Types of Queue"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Queue Type"}),(0,t.jsx)(s.th,{children:"Description"}),(0,t.jsx)(s.th,{children:"Example Use Case"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"Message Queue"})}),(0,t.jsx)(s.td,{children:"Carries messages between services."}),(0,t.jsx)(s.td,{children:"RabbitMQ, ActiveMQ, Amazon SQS"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"Task Queue"})}),(0,t.jsx)(s.td,{children:"Holds jobs/tasks for background workers."}),(0,t.jsx)(s.td,{children:"Celery (Python), Sidekiq (Ruby)"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"Priority Queue"})}),(0,t.jsx)(s.td,{children:"Tasks with higher priority go first."}),(0,t.jsx)(s.td,{children:"Support ticketing system"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"Delay Queue"})}),(0,t.jsx)(s.td,{children:"Messages are held for a period before sent."}),(0,t.jsx)(s.td,{children:"Scheduled notifications"})]})]})]}),"\n",(0,t.jsx)(s.h2,{id:"where-does-a-queue-build-up",children:"Where does a queue build up"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Layer / Component"}),(0,t.jsx)(s.th,{children:"Where the Queue Builds"}),(0,t.jsx)(s.th,{children:"Reason"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"Web Server / Load Balancer"})}),(0,t.jsx)(s.td,{children:"Incoming request queue"}),(0,t.jsx)(s.td,{children:"Too many simultaneous user requests"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsxs)(s.td,{children:[(0,t.jsx)(s.strong,{children:"Message Queue System"})," (e.g., Kafka, RabbitMQ, SQS)"]}),(0,t.jsx)(s.td,{children:"Task queue"}),(0,t.jsx)(s.td,{children:"Worker is slow or unavailable"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"Database"})}),(0,t.jsx)(s.td,{children:"Connection pool queue"}),(0,t.jsx)(s.td,{children:"Too many concurrent queries, slow queries"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"Thread Pools"})}),(0,t.jsx)(s.td,{children:"Thread/task execution queue"}),(0,t.jsx)(s.td,{children:"CPU-bound or I/O-bound bottlenecks"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"Disk / File I/O"})}),(0,t.jsx)(s.td,{children:"File write buffer queue"}),(0,t.jsx)(s.td,{children:"Slow disks, too many write ops"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"API Gateway"})}),(0,t.jsx)(s.td,{children:"Request queue for backend service"}),(0,t.jsx)(s.td,{children:"Backend throttled or overloaded"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"Cache Layer (e.g., Redis)"})}),(0,t.jsx)(s.td,{children:"Command execution queue"}),(0,t.jsx)(s.td,{children:"Too many cache ops / eviction pressure"})]})]})]}),"\n",(0,t.jsx)(s.h2,{id:"example-of-queue",children:"Example of Queue"}),"\n",(0,t.jsx)(s.p,{children:"A user uploads an image, and the system must resize it into multiple resolutions (thumbnail, medium, high-res)."}),"\n",(0,t.jsx)(s.h3,{id:"without-a-queue-synchronous",children:"Without a Queue (Synchronous):"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Upload \u2192 Resize \u2192 Save \u2192 Respond"}),"\n",(0,t.jsx)(s.li,{children:"Slow, blocks user request"}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"with-a-queue-asynchronous",children:"With a Queue (Asynchronous):"}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsx)(s.li,{children:"User uploads image"}),"\n",(0,t.jsx)(s.li,{children:"API Server stores image metadata and sends a task to the queue:"}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-json",children:'{\r\n  "image_id": "123",\r\n  "resize_sizes": ["100x100", "300x300"]\r\n}\n'})}),"\n",(0,t.jsxs)(s.ol,{start:"3",children:["\n",(0,t.jsx)(s.li,{children:"Queue holds the task"}),"\n",(0,t.jsx)(s.li,{children:"Worker picks up the task, resizes the image, and saves the results"}),"\n",(0,t.jsx)(s.li,{children:"User gets a fast response, and image processing happens in the background"}),"\n"]}),"\n",(0,t.jsx)(s.p,{children:"Queue = buffer between upload and processing"}),"\n",(0,t.jsx)(s.h2,{id:"common-queue-tools",children:"Common Queue Tools"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Tool"}),(0,t.jsx)(s.th,{children:"Description"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"RabbitMQ"})}),(0,t.jsx)(s.td,{children:"Open-source message broker"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"Kafka"})}),(0,t.jsx)(s.td,{children:"Distributed streaming platform"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"Amazon SQS"})}),(0,t.jsx)(s.td,{children:"Fully managed message queue service"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"Redis"})}),(0,t.jsx)(s.td,{children:"Can be used for simple in-memory queues"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.strong,{children:"Celery"})}),(0,t.jsx)(s.td,{children:"Distributed task queue in Python"})]})]})]}),"\n",(0,t.jsx)(s.h2,{id:"strategy-to-prevent-queue",children:"Strategy to Prevent Queue"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Strategy"}),(0,t.jsx)(s.th,{children:"Prevents"}),(0,t.jsx)(s.th,{children:"Example Tool/Tech"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Auto-scale consumers"}),(0,t.jsx)(s.td,{children:"Slow processing"}),(0,t.jsx)(s.td,{children:"AWS Lambda, Kubernetes"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Rate limiting"}),(0,t.jsx)(s.td,{children:"Burst producer load"}),(0,t.jsx)(s.td,{children:"API Gateway, NGINX"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Queue monitoring"}),(0,t.jsx)(s.td,{children:"Silent queue growth"}),(0,t.jsx)(s.td,{children:"Prometheus, CloudWatch"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Backpressure"}),(0,t.jsx)(s.td,{children:"System overload"}),(0,t.jsx)(s.td,{children:"Node.js, Kafka"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"DLQ"}),(0,t.jsx)(s.td,{children:"Retry storm, poisoned messages"}),(0,t.jsx)(s.td,{children:"SQS DLQ, RabbitMQ"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Timeouts + exponential retry"}),(0,t.jsx)(s.td,{children:"Worker hang, retry floods"}),(0,t.jsx)(s.td,{children:"Celery, Sidekiq"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Priority or multiple queues"}),(0,t.jsx)(s.td,{children:"Starvation of urgent tasks"}),(0,t.jsx)(s.td,{children:"RabbitMQ, Redis, Kafka"})]})]})]})]})}function u(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}}}]);