"use strict";(globalThis.webpackChunkhandbook=globalThis.webpackChunkhandbook||[]).push([[10219],{23961(e,r,n){n.r(r),n.d(r,{assets:()=>a,contentTitle:()=>d,default:()=>o,frontMatter:()=>c,metadata:()=>s,toc:()=>t});const s=JSON.parse('{"id":"rust/Project Structure/Crates","title":"Crates","description":"A crate is the smallest unit of compilation in Rust.","source":"@site/docs/rust/13. Project Structure/2. Crates.md","sourceDirName":"rust/13. Project Structure","slug":"/rust/Project Structure/Crates","permalink":"/handbook/docs/rust/Project Structure/Crates","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{},"sidebar":"rustApiSidebar","previous":{"title":"Modules","permalink":"/handbook/docs/rust/Project Structure/Modules"},"next":{"title":"use Keyword","permalink":"/handbook/docs/rust/Project Structure/use Keyword"}}');var i=n(74848),l=n(28453);const c={},d=void 0,a={},t=[{value:"Types of Crates",id:"types-of-crates",level:2},{value:"Binary Crate (Executable)",id:"binary-crate-executable",level:2},{value:"Example: Simple Binary Crate",id:"example-simple-binary-crate",level:3},{value:"Binary Crate with Modules",id:"binary-crate-with-modules",level:2},{value:"Multiple Binary Crates in One Project",id:"multiple-binary-crates-in-one-project",level:2},{value:"Library Crate (Reusable Code)",id:"library-crate-reusable-code",level:2},{value:"Example: Simple Library Crate",id:"example-simple-library-crate",level:3},{value:"Using a Library Crate in a Binary Crate",id:"using-a-library-crate-in-a-binary-crate",level:2},{value:"Library Crate with Modules",id:"library-crate-with-modules",level:2},{value:"Binary + Library Together (Very Common)",id:"binary--library-together-very-common",level:2},{value:"Crate Root Explained",id:"crate-root-explained",level:2},{value:"<code>crate::</code> vs External Crates",id:"crate-vs-external-crates",level:2},{value:"<code>Cargo.toml</code> and Crates",id:"cargotoml-and-crates",level:2},{value:"How Modules &amp; Crates Fit Together",id:"how-modules--crates-fit-together",level:2},{value:"Key Differences: Crate vs Module",id:"key-differences-crate-vs-module",level:2},{value:"When to Use What",id:"when-to-use-what",level:2}];function h(e){const r={blockquote:"blockquote",br:"br",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.p,{children:"A crate is the smallest unit of compilation in Rust."}),"\n",(0,i.jsx)(r.p,{children:"In simple terms:"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:"A crate = one compiled output"}),"\n",(0,i.jsxs)(r.li,{children:["It can produce:","\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:"an executable \u2192 binary crate"}),"\n",(0,i.jsx)(r.li,{children:"a reusable package \u2192 library crate"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(r.p,{children:["Modules organize code inside a crate",(0,i.jsx)(r.br,{}),"\n","Crates organize code at the compilation level"]}),"\n",(0,i.jsx)(r.h2,{id:"types-of-crates",children:"Types of Crates"}),"\n",(0,i.jsx)(r.p,{children:"Rust has two main crate types:"}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"Crate Type"}),(0,i.jsx)(r.th,{children:"Output"}),(0,i.jsx)(r.th,{children:"Entry File"})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"Binary crate"}),(0,i.jsx)(r.td,{children:"Executable program"}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"main.rs"})})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"Library crate"}),(0,i.jsx)(r.td,{children:"Reusable code"}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"lib.rs"})})]})]})]}),"\n",(0,i.jsx)(r.h2,{id:"binary-crate-executable",children:"Binary Crate (Executable)"}),"\n",(0,i.jsx)(r.p,{children:"A binary crate:"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:"produces a runnable executable"}),"\n",(0,i.jsxs)(r.li,{children:["must have a ",(0,i.jsx)(r.code,{children:"main()"})," function"]}),"\n",(0,i.jsxs)(r.li,{children:["starts execution from ",(0,i.jsx)(r.code,{children:"main()"})]}),"\n"]}),"\n",(0,i.jsx)(r.h3,{id:"example-simple-binary-crate",children:"Example: Simple Binary Crate"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{children:"my_app/\r\n \u251c\u2500\u2500 Cargo.toml\r\n \u2514\u2500\u2500 src/\r\n      \u2514\u2500\u2500 main.rs\n"})}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.code,{children:"main.rs"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-rust",children:'fn main() {\r\n    println!("Hello from binary crate!");\r\n}\n'})}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"main.rs"})," is the crate root"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"main()"})," is the program entry point"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"cargo"})," run builds and executes this crate"]}),"\n"]}),"\n",(0,i.jsx)(r.h2,{id:"binary-crate-with-modules",children:"Binary Crate with Modules"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{children:"src/\r\n \u251c\u2500\u2500 main.rs\r\n \u2514\u2500\u2500 utils.rs\n"})}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.code,{children:"main.rs"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-rust",children:"mod utils;\r\n\r\nfn main() {\r\n    utils::say_hi();\r\n}\n"})}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.code,{children:"utils.rs"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-rust",children:'pub fn say_hi() {\r\n    println!("Hi from utils module");\r\n}\n'})}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"main.rs"})," is still the crate root"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"utils"})," is a module inside the crate"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"pub"})," allows access from ",(0,i.jsx)(r.code,{children:"main"})]}),"\n"]}),"\n",(0,i.jsx)(r.h2,{id:"multiple-binary-crates-in-one-project",children:"Multiple Binary Crates in One Project"}),"\n",(0,i.jsx)(r.p,{children:"Rust allows multiple binaries in one package."}),"\n",(0,i.jsx)(r.p,{children:"Structure"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{children:"src/\r\n \u251c\u2500\u2500 main.rs        // default binary\r\n \u2514\u2500\u2500 bin/\r\n      \u251c\u2500\u2500 server.rs\r\n      \u2514\u2500\u2500 client.rs\n"})}),"\n",(0,i.jsx)(r.p,{children:"Running binaries"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{children:"cargo run           # runs main.rs\r\ncargo run --bin server\r\ncargo run --bin client\n"})}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:["Each file in ",(0,i.jsx)(r.code,{children:"src/bin/"})," is a separate binary crate"]}),"\n",(0,i.jsxs)(r.li,{children:["All share the same ",(0,i.jsx)(r.code,{children:"Cargo.toml"})]}),"\n",(0,i.jsx)(r.li,{children:"Useful for CLI tools, microservices, or test apps"}),"\n"]}),"\n",(0,i.jsx)(r.h2,{id:"library-crate-reusable-code",children:"Library Crate (Reusable Code)"}),"\n",(0,i.jsx)(r.p,{children:"A library crate:"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:["does NOT have ",(0,i.jsx)(r.code,{children:"main()"})]}),"\n",(0,i.jsx)(r.li,{children:"exposes reusable functionality"}),"\n",(0,i.jsxs)(r.li,{children:["is imported by other crates using ",(0,i.jsx)(r.code,{children:"use"})]}),"\n"]}),"\n",(0,i.jsx)(r.h3,{id:"example-simple-library-crate",children:"Example: Simple Library Crate"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{children:"my_lib/\r\n \u251c\u2500\u2500 Cargo.toml\r\n \u2514\u2500\u2500 src/\r\n      \u2514\u2500\u2500 lib.rs\n"})}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.code,{children:"lib.rs"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-rust",children:'pub fn greet() {\r\n    println!("Hello from library crate");\r\n}\n'})}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"lib.rs"})," is the crate root"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"pub"})," exposes the function to other crates"]}),"\n",(0,i.jsxs)(r.li,{children:["Built with ",(0,i.jsx)(r.code,{children:"cargo build"})]}),"\n"]}),"\n",(0,i.jsx)(r.h2,{id:"using-a-library-crate-in-a-binary-crate",children:"Using a Library Crate in a Binary Crate"}),"\n",(0,i.jsx)(r.p,{children:"Workspace-like usage (same project)"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{children:"src/\r\n \u251c\u2500\u2500 main.rs\r\n \u2514\u2500\u2500 lib.rs\n"})}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.code,{children:"lib.rs"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-rust",children:"pub fn add(a: i32, b: i32) -> i32 {\r\n    a + b\r\n}\n"})}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.code,{children:"main.rs"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-rust",children:'use my_project::add;\r\n\r\nfn main() {\r\n    println!("{}", add(2, 3));\r\n}\n'})}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"my_project"})," = crate name from ",(0,i.jsx)(r.code,{children:"Cargo.toml"})]}),"\n",(0,i.jsx)(r.li,{children:"Binary crate automatically depends on the library crate"}),"\n",(0,i.jsx)(r.li,{children:"Common Rust pattern \ud83d\udc4d"}),"\n"]}),"\n",(0,i.jsx)(r.h2,{id:"library-crate-with-modules",children:"Library Crate with Modules"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{children:"src/\r\n \u251c\u2500\u2500 lib.rs\r\n \u251c\u2500\u2500 math/\r\n \u2502    \u251c\u2500\u2500 mod.rs\r\n \u2502    \u2514\u2500\u2500 add.rs\r\n \u2514\u2500\u2500 utils.rs\n"})}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.code,{children:"lib.rs"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-rust",children:"pub mod math;\r\npub mod utils;\n"})}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.code,{children:"math/mod.rs"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-rust",children:"pub mod add;\n"})}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.code,{children:"math/add.rs"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-rust",children:"pub fn add(a: i32, b: i32) -> i32 {\r\n    a + b\r\n}\n"})}),"\n",(0,i.jsx)(r.p,{children:"Usage in another crate"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-rust",children:"use my_lib::math::add::add;\n"})}),"\n",(0,i.jsx)(r.h2,{id:"binary--library-together-very-common",children:"Binary + Library Together (Very Common)"}),"\n",(0,i.jsx)(r.p,{children:"This is idiomatic Rust."}),"\n",(0,i.jsx)(r.p,{children:"Structure"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{children:"src/\r\n \u251c\u2500\u2500 main.rs   // binary crate\r\n \u2514\u2500\u2500 lib.rs    // library crate\n"})}),"\n",(0,i.jsx)(r.p,{children:"Why do this?"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:["Put logic in ",(0,i.jsx)(r.code,{children:"lib.rs"})]}),"\n",(0,i.jsxs)(r.li,{children:["Keep ",(0,i.jsx)(r.code,{children:"main.rs"})," thin"]}),"\n",(0,i.jsx)(r.li,{children:"Improves testability and reuse"}),"\n"]}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.code,{children:"lib.rs"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-rust",children:'pub mod auth {\r\n    pub fn login() {\r\n        println!("User logged in");\r\n    }\r\n}\n'})}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.code,{children:"main.rs"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-rust",children:"use my_app::auth::login;\r\n\r\nfn main() {\r\n    login();\r\n}\n"})}),"\n",(0,i.jsx)(r.h2,{id:"crate-root-explained",children:"Crate Root Explained"}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"Crate Type"}),(0,i.jsx)(r.th,{children:"Crate Root"})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"Binary"}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"main.rs"})})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"Library"}),(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"lib.rs"})})]})]})]}),"\n",(0,i.jsx)(r.p,{children:"The crate root:"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:"defines the module tree"}),"\n",(0,i.jsx)(r.li,{children:"controls what is public"}),"\n",(0,i.jsxs)(r.li,{children:["is where ",(0,i.jsx)(r.code,{children:"crate::"})," paths start"]}),"\n"]}),"\n",(0,i.jsxs)(r.h2,{id:"crate-vs-external-crates",children:[(0,i.jsx)(r.code,{children:"crate::"})," vs External Crates"]}),"\n",(0,i.jsx)(r.p,{children:"Inside the same crate"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-rust",children:"crate::math::add::add();\n"})}),"\n",(0,i.jsx)(r.p,{children:"External crate"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-rust",children:"use serde::Serialize;\n"})}),"\n",(0,i.jsx)(r.p,{children:"Rust clearly separates:"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:["internal modules \u2192 ",(0,i.jsx)(r.code,{children:"crate::"})]}),"\n",(0,i.jsx)(r.li,{children:"external crates \u2192 crate name"}),"\n"]}),"\n",(0,i.jsxs)(r.h2,{id:"cargotoml-and-crates",children:[(0,i.jsx)(r.code,{children:"Cargo.toml"})," and Crates"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-toml",children:'[package]\r\nname = "my_app"\r\nversion = "0.1.0"\r\nedition = "2021"\n'})}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"name"})," = crate name used in ",(0,i.jsx)(r.code,{children:"use"})]}),"\n",(0,i.jsxs)(r.li,{children:["Dependencies listed under ",(0,i.jsx)(r.code,{children:"[dependencies]"})]}),"\n",(0,i.jsx)(r.li,{children:"Cargo builds each crate independently"}),"\n"]}),"\n",(0,i.jsx)(r.h2,{id:"how-modules--crates-fit-together",children:"How Modules & Crates Fit Together"}),"\n",(0,i.jsx)(r.p,{children:"Think of it like this:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{children:"Workspace (optional)\r\n \u2514\u2500\u2500 Package (Cargo.toml)\r\n      \u251c\u2500\u2500 Crate (binary or library)\r\n      \u2502    \u2514\u2500\u2500 Modules\r\n      \u2502         \u2514\u2500\u2500 Functions / structs\n"})}),"\n",(0,i.jsx)(r.h2,{id:"key-differences-crate-vs-module",children:"Key Differences: Crate vs Module"}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"Feature"}),(0,i.jsx)(r.th,{children:"Crate"}),(0,i.jsx)(r.th,{children:"Module"})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"Compiled separately"}),(0,i.jsx)(r.td,{children:"\u2705"}),(0,i.jsx)(r.td,{children:"\u274c"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"Has crate root"}),(0,i.jsx)(r.td,{children:"\u2705"}),(0,i.jsx)(r.td,{children:"\u274c"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"Controls visibility"}),(0,i.jsx)(r.td,{children:"\u2705"}),(0,i.jsx)(r.td,{children:"\u2705"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"Can be published"}),(0,i.jsx)(r.td,{children:"\u2705"}),(0,i.jsx)(r.td,{children:"\u274c"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:"File-based"}),(0,i.jsx)(r.td,{children:"Yes"}),(0,i.jsx)(r.td,{children:"Yes"})]})]})]}),"\n",(0,i.jsx)(r.h2,{id:"when-to-use-what",children:"When to Use What"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:"Modules \u2192 organize logic inside a crate"}),"\n",(0,i.jsx)(r.li,{children:"Library crate \u2192 reusable core logic"}),"\n",(0,i.jsx)(r.li,{children:"Binary crate \u2192 executable behavior"}),"\n"]}),"\n",(0,i.jsx)(r.p,{children:"Rust strongly encourages:"}),"\n",(0,i.jsxs)(r.blockquote,{children:["\n",(0,i.jsx)(r.p,{children:"\u201cWrite libraries, then write small binaries that use them.\u201d"}),"\n"]})]})}function o(e={}){const{wrapper:r}={...(0,l.R)(),...e.components};return r?(0,i.jsx)(r,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},28453(e,r,n){n.d(r,{R:()=>c,x:()=>d});var s=n(96540);const i={},l=s.createContext(i);function c(e){const r=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function d(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),s.createElement(l.Provider,{value:r},e.children)}}}]);