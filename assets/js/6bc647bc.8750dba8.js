"use strict";(globalThis.webpackChunkhandbook=globalThis.webpackChunkhandbook||[]).push([[2346],{6179:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>t,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"database-design/Database Security","title":"Database Security","description":"User Roles and Privileges","source":"@site/docs/database-design/22. Database Security.md","sourceDirName":"database-design","slug":"/database-design/Database Security","permalink":"/handbook/docs/database-design/Database Security","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":23,"frontMatter":{"sidebar_position":23}}');var i=s(4848),l=s(8453);const a={sidebar_position:23},t=void 0,d={},c=[{value:"User Roles and Privileges",id:"user-roles-and-privileges",level:2},{value:"Why Roles and Privileges Matter in Database Design",id:"why-roles-and-privileges-matter-in-database-design",level:2},{value:"Example of User Role",id:"example-of-user-role",level:3},{value:"Advanced Security Features",id:"advanced-security-features",level:3},{value:"Data Encryption",id:"data-encryption",level:2},{value:"Types of Encryption in Databases",id:"types-of-encryption-in-databases",level:3},{value:"Example of Column-Level Encryption",id:"example-of-column-level-encryption",level:3},{value:"SQL Injection",id:"sql-injection",level:2},{value:"SQL Injection Prevention at Database Design Level",id:"sql-injection-prevention-at-database-design-level",level:3},{value:"Use Parameterized Queries / Prepared Statements",id:"use-parameterized-queries--prepared-statements",level:4},{value:"Stored Procedures with Parameters",id:"stored-procedures-with-parameters",level:4},{value:"Use the Principle of Least Privilege",id:"use-the-principle-of-least-privilege",level:4},{value:"Input Validation &amp; Constraints at Schema Level",id:"input-validation--constraints-at-schema-level",level:4},{value:"Use Views for Restricted Access",id:"use-views-for-restricted-access",level:4}];function o(e){const n={code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"user-roles-and-privileges",children:"User Roles and Privileges"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"User"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"An individual or application connecting to the database."}),"\n",(0,i.jsx)(n.li,{children:"Identified by a username (and usually a password)."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Privileges (Permissions)"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Specific rights to perform actions on database objects."}),"\n",(0,i.jsxs)(n.li,{children:["Examples:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["System Privileges \u2192 ",(0,i.jsx)(n.code,{children:"CREATE TABLE"}),", ",(0,i.jsx)(n.code,{children:"CREATE USER"}),", ",(0,i.jsx)(n.code,{children:"SHUTDOWN"})," (affect the whole DB)."]}),"\n",(0,i.jsxs)(n.li,{children:["Object Privileges \u2192 ",(0,i.jsx)(n.code,{children:"SELECT"}),", ",(0,i.jsx)(n.code,{children:"INSERT"}),", ",(0,i.jsx)(n.code,{children:"UPDATE"}),", ",(0,i.jsx)(n.code,{children:"DELETE"})," (affect specific tables, views, procedures)."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Roles"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"A role is a collection of privileges."}),"\n",(0,i.jsx)(n.li,{children:"Makes privilege management easier (instead of assigning many privileges to each user)."}),"\n",(0,i.jsx)(n.li,{children:"Users are granted roles, and roles contain privileges."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"why-roles-and-privileges-matter-in-database-design",children:"Why Roles and Privileges Matter in Database Design"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Security \u2192 Protect sensitive data from unauthorized access."}),"\n",(0,i.jsx)(n.li,{children:"Integrity \u2192 Ensure only authorized users can change data (e.g., only HR can update salaries)."}),"\n",(0,i.jsx)(n.li,{children:"Accountability \u2192 Track who did what."}),"\n",(0,i.jsx)(n.li,{children:"Least Privilege Principle \u2192 Users should only get the minimum permissions required to perform their tasks."}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"example-of-user-role",children:"Example of User Role"}),"\n",(0,i.jsx)(n.p,{children:"Let\u2019s imagine a University Database with three types of users:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Admin \u2192 Full control."}),"\n",(0,i.jsx)(n.li,{children:"Professor \u2192 Can view and update grades."}),"\n",(0,i.jsx)(n.li,{children:"Student \u2192 Can only view their own courses/grades."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Step 1: Create Users"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"-- Create three users\r\nCREATE USER admin_user IDENTIFIED BY 'adminpass';\r\nCREATE USER professor_user IDENTIFIED BY 'profpass';\r\nCREATE USER student_user IDENTIFIED BY 'studentpass';\n"})}),"\n",(0,i.jsx)(n.p,{children:"Step 2: Create Roles"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"-- Create roles\r\nCREATE ROLE admin_role;\r\nCREATE ROLE professor_role;\r\nCREATE ROLE student_role;\n"})}),"\n",(0,i.jsx)(n.p,{children:"Step 3: Assign Privileges to Roles"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"-- Admin can do everything\r\nGRANT ALL PRIVILEGES TO admin_role;\r\n\r\n-- Professors can SELECT and UPDATE grades table\r\nGRANT SELECT, UPDATE ON Grades TO professor_role;\r\n\r\n-- Students can only SELECT (read-only access)\r\nGRANT SELECT ON Grades TO student_role;\n"})}),"\n",(0,i.jsx)(n.p,{children:"Step 4: Assign Roles to Users"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"-- Assign roles to specific users\r\nGRANT admin_role TO admin_user;\r\nGRANT professor_role TO professor_user;\r\nGRANT student_role TO student_user;\n"})}),"\n",(0,i.jsx)(n.p,{children:"Step 5: Usage Example"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"If professor_user logs in and tries:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"UPDATE Grades SET score = 90 WHERE student_id = 101 AND course_id = 'CS101';\n"})}),"\n",(0,i.jsx)(n.p,{children:"Allowed (since professor has UPDATE privilege)."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"If student_user tries:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"UPDATE Grades SET score = 100 WHERE student_id = 101;\n"})}),"\n",(0,i.jsx)(n.p,{children:"Fails (student only has SELECT privilege)."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"If student_user runs:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"SELECT * FROM Grades WHERE student_id = 101;\n"})}),"\n",(0,i.jsx)(n.p,{children:"Allowed (read-only access)."}),"\n",(0,i.jsx)(n.h3,{id:"advanced-security-features",children:"Advanced Security Features"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Column-Level Privileges"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Limit access to specific columns."}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"GRANT SELECT (student_id, course_id) ON Grades TO student_role;\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Views for Security"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Instead of giving direct access, create views."}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"CREATE VIEW student_view AS\r\nSELECT student_id, course_id, score\r\nFROM Grades\r\nWHERE student_id = SYS_CONTEXT('USERENV','SESSION_USER');\r\nGRANT SELECT ON student_view TO student_role;\n"})}),"\n",(0,i.jsx)(n.p,{children:"Each student only sees their own grades."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Revoking Privileges"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"If a user should no longer access data:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"REVOKE UPDATE ON Grades FROM professor_role;\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"data-encryption",children:"Data Encryption"}),"\n",(0,i.jsx)(n.p,{children:"Encryption = the process of converting plain text (readable data) into cipher text (unreadable format) using an encryption algorithm and key."}),"\n",(0,i.jsx)(n.p,{children:"Decryption = converting ciphertext back into plaintext with the correct key."}),"\n",(0,i.jsx)(n.p,{children:"The purpose: even if unauthorized users access the database or backups, they cannot read sensitive data without the decryption key."}),"\n",(0,i.jsx)(n.h3,{id:"types-of-encryption-in-databases",children:"Types of Encryption in Databases"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Encryption at Rest","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Protects stored data (disk files, backups, logs)."}),"\n",(0,i.jsx)(n.li,{children:"If someone steals the physical storage, data remains unreadable."}),"\n",(0,i.jsx)(n.li,{children:"Example: Transparent Data Encryption (TDE) in Oracle, SQL Server, PostgreSQL."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Encryption in Transit","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Protects data moving between client \u2194 database server over the network."}),"\n",(0,i.jsx)(n.li,{children:"Uses protocols like TLS/SSL."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Column-Level or Field-Level Encryption","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Encrypts specific sensitive columns in tables (e.g., passwords, credit card numbers)."}),"\n",(0,i.jsx)(n.li,{children:"Provides fine-grained protection but may impact performance."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Application-Level Encryption","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Application encrypts data before inserting into DB and decrypts after fetching."}),"\n",(0,i.jsx)(n.li,{children:"Database only stores ciphertext."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"example-of-column-level-encryption",children:"Example of Column-Level Encryption"}),"\n",(0,i.jsxs)(n.p,{children:["Suppose we design a Banking Database where ",(0,i.jsx)(n.code,{children:"credit_card_number"})," must be encrypted."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE Customers (\r\n    customer_id INT PRIMARY KEY,\r\n    name VARCHAR(100),\r\n    credit_card_number VARBINARY(256) -- store as encrypted\r\n);\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Insert with Encryption:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"-- Create a symmetric key\r\nCREATE SYMMETRIC KEY CreditCardKey\r\nWITH ALGORITHM = AES_256\r\nENCRYPTION BY PASSWORD = 'StrongPassword123';\r\n\r\n-- Open the key\r\nOPEN SYMMETRIC KEY CreditCardKey\r\nDECRYPTION BY PASSWORD = 'StrongPassword123';\r\n\r\n-- Insert encrypted value\r\nINSERT INTO Customers (customer_id, name, credit_card_number)\r\nVALUES (1, 'Alice', EncryptByKey(Key_GUID('CreditCardKey'), '4111111111111111'));\n"})}),"\n",(0,i.jsx)(n.p,{children:"The card number is stored in the database as ciphertext, not plain text."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Decrypt when Reading:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-SQL",children:"-- Decrypt the credit card number\r\nSELECT name,\r\n       CONVERT(VARCHAR, DecryptByKey(credit_card_number)) AS credit_card_number\r\nFROM Customers;\n"})}),"\n",(0,i.jsx)(n.p,{children:"Only users with the right key/password can view the real number."}),"\n",(0,i.jsx)(n.h2,{id:"sql-injection",children:"SQL Injection"}),"\n",(0,i.jsx)(n.p,{children:"SQL Injection (SQLi) happens when untrusted input is concatenated directly into an SQL query, allowing attackers to manipulate the query."}),"\n",(0,i.jsx)(n.p,{children:"Example of a vulnerable query (string concatenation):"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"-- Suppose 'username' and 'password' come directly from user input\r\nSELECT * FROM Users\r\nWHERE username = ' \" + user_input + \" '\r\nAND password = ' \" + pass_input + \" ';\n"})}),"\n",(0,i.jsx)(n.p,{children:"If an attacker enters:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"username = 'admin'"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"password = \"' OR '1'='1\""})}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"The query becomes:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"SELECT * FROM Users\r\nWHERE username = 'admin'\r\nAND password = '' OR '1'='1';\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"'1'='1'"})," is always true, so the attacker logs in without a valid password."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"sql-injection-prevention-at-database-design-level",children:"SQL Injection Prevention at Database Design Level"}),"\n",(0,i.jsx)(n.p,{children:"When designing a secure database system, you don\u2019t just rely on the application \u2014 you enforce controls at multiple layers:"}),"\n",(0,i.jsx)(n.h4,{id:"use-parameterized-queries--prepared-statements",children:"Use Parameterized Queries / Prepared Statements"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Instead of embedding input directly into SQL, use placeholders (",(0,i.jsx)(n.code,{children:"?"})," or ",(0,i.jsx)(n.code,{children:":param"}),")."]}),"\n",(0,i.jsx)(n.li,{children:"DB engine treats inputs as data, not executable SQL."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Example in Python (safe with placeholders):"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:'cursor.execute(\r\n    "SELECT * FROM Users WHERE username = %s AND password = %s",\r\n    (username, password)\r\n)\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Here, even if ",(0,i.jsx)(n.code,{children:"password = \"' OR '1'='1\""}),", it is treated as a string, not SQL code."]}),"\n",(0,i.jsx)(n.h4,{id:"stored-procedures-with-parameters",children:"Stored Procedures with Parameters"}),"\n",(0,i.jsx)(n.p,{children:"Encapsulate queries in stored procedures, and only allow execution via defined parameters."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"CREATE PROCEDURE AuthenticateUser (@username NVARCHAR(50), @password NVARCHAR(50))\r\nAS\r\nBEGIN\r\n    SELECT * FROM Users\r\n    WHERE username = @username AND password = @password;\r\nEND;\n"})}),"\n",(0,i.jsx)(n.p,{children:"Prevents direct manipulation of SQL strings."}),"\n",(0,i.jsx)(n.h4,{id:"use-the-principle-of-least-privilege",children:"Use the Principle of Least Privilege"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Application accounts should have only the privileges they need."}),"\n",(0,i.jsxs)(n.li,{children:["Example:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"The web app should only SELECT/INSERT into Users."}),"\n",(0,i.jsx)(n.li,{children:"It should NOT have DROP TABLE, ALTER, or GRANT privileges."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"GRANT SELECT, INSERT, UPDATE ON Users TO app_user;\n"})}),"\n",(0,i.jsx)(n.p,{children:"Even if SQL injection happens, the attacker\u2019s damage is limited."}),"\n",(0,i.jsx)(n.h4,{id:"input-validation--constraints-at-schema-level",children:"Input Validation & Constraints at Schema Level"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Use CHECK constraints, data types, NOT NULL, foreign keys to enforce valid inputs."}),"\n",(0,i.jsx)(n.li,{children:"Example:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE Users (\r\n    user_id INT PRIMARY KEY,\r\n    username VARCHAR(50) NOT NULL UNIQUE,\r\n    password_hash CHAR(64) NOT NULL,\r\n    email VARCHAR(100) CHECK (email LIKE '%@%')\r\n);\n"})}),"\n",(0,i.jsx)(n.p,{children:"Even if injected input reaches DB, invalid formats get rejected."}),"\n",(0,i.jsx)(n.h4,{id:"use-views-for-restricted-access",children:"Use Views for Restricted Access"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Instead of exposing sensitive tables directly, create views with limited columns."}),"\n",(0,i.jsx)(n.li,{children:"Example:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"CREATE VIEW SafeUsers AS\r\nSELECT user_id, username, email\r\nFROM Users;\r\nGRANT SELECT ON SafeUsers TO app_user;\n"})}),"\n",(0,i.jsx)(n.p,{children:"Prevents SQL injection from exposing sensitive fields (like password hashes)."})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>t});var r=s(6540);const i={},l=r.createContext(i);function a(e){const n=r.useContext(l);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),r.createElement(l.Provider,{value:n},e.children)}}}]);