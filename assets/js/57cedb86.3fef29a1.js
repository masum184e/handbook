"use strict";(globalThis.webpackChunkhandbook=globalThis.webpackChunkhandbook||[]).push([[8639],{28453(e,n,i){i.d(n,{R:()=>c,x:()=>t});var r=i(96540);const s={},l=r.createContext(s);function c(e){const n=r.useContext(l);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),r.createElement(l.Provider,{value:n},e.children)}},78002(e,n,i){i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>t,default:()=>a,frontMatter:()=>c,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"nginx/Static Files","title":"Static Files","description":"Static files are files that are sent as-is to the client, without backend processing.","source":"@site/docs/nginx/11. Static Files.md","sourceDirName":"nginx","slug":"/nginx/Static Files","permalink":"/handbook/docs/nginx/Static Files","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":11,"frontMatter":{},"sidebar":"nginxApiSidebar","previous":{"title":"Health Checks","permalink":"/handbook/docs/nginx/Health Checks"},"next":{"title":"MIME Types","permalink":"/handbook/docs/nginx/MIME Types"}}');var s=i(74848),l=i(28453);const c={},t=void 0,d={},o=[{value:"Simple Static File Server Example",id:"simple-static-file-server-example",level:2},{value:"<code>root</code> Directive (Most Common)",id:"root-directive-most-common",level:2},{value:"<code>alias</code> Directive (Important Difference)",id:"alias-directive-important-difference",level:2},{value:"Default Files with <code>index</code>",id:"default-files-with-index",level:2},{value:"File Existence Control with <code>try_files</code>",id:"file-existence-control-with-try_files",level:2},{value:"Serving Assets from a Separate Directory",id:"serving-assets-from-a-separate-directory",level:2},{value:"Auto Directory Listing (<code>autoindex</code>)",id:"auto-directory-listing-autoindex",level:2},{value:"MIME Types &amp; Content-Type",id:"mime-types--content-type",level:2},{value:"Performance Optimizations",id:"performance-optimizations",level:2},{value:"Static Files + Reverse Proxy (Hybrid Setup)",id:"static-files--reverse-proxy-hybrid-setup",level:2},{value:"Security Best Practices",id:"security-best-practices",level:2},{value:"Real-World Production Example",id:"real-world-production-example",level:2},{value:"Common Mistakes",id:"common-mistakes",level:2}];function h(e){const n={code:"code",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:"Static files are files that are sent as-is to the client, without backend processing."}),"\n",(0,s.jsxs)(n.p,{children:["Examples: HTML (",(0,s.jsx)(n.code,{children:".html"}),"), CSS (",(0,s.jsx)(n.code,{children:".css"}),"), JavaScript (",(0,s.jsx)(n.code,{children:".js"}),"), Images (",(0,s.jsx)(n.code,{children:".png"}),", ",(0,s.jsx)(n.code,{children:".jpg"}),"), Downloads (",(0,s.jsx)(n.code,{children:".zip"}),", ",(0,s.jsx)(n.code,{children:".pdf"}),")"]}),"\n",(0,s.jsx)(n.p,{children:"NGINX is extremely efficient at serving static content due to:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Event-driven architecture"}),"\n",(0,s.jsxs)(n.li,{children:["Zero-copy (",(0,s.jsx)(n.code,{children:"sendfile"}),")"]}),"\n",(0,s.jsx)(n.li,{children:"Kernel-level optimizations"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Basic Request Flow for Static Files"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Client \u2192 NGINX \u2192 File System \u2192 Client\n"})}),"\n",(0,s.jsx)(n.p,{children:"No application server is involved."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Core Directives Used for Static Files"})}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Directive"}),(0,s.jsx)(n.th,{children:"Purpose"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"root"})}),(0,s.jsx)(n.td,{children:"Defines base directory"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"alias"})}),(0,s.jsx)(n.td,{children:"Maps URI to different path"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"index"})}),(0,s.jsx)(n.td,{children:"Default file"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"try_files"})}),(0,s.jsx)(n.td,{children:"File existence check"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"autoindex"})}),(0,s.jsx)(n.td,{children:"Directory listing"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"sendfile"})}),(0,s.jsx)(n.td,{children:"Efficient file transfer"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"expires"})}),(0,s.jsx)(n.td,{children:"Client-side caching"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"gzip"})}),(0,s.jsx)(n.td,{children:"Compression"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"simple-static-file-server-example",children:"Simple Static File Server Example"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"server {\r\n    listen 80;\r\n    server_name example.com;\r\n\r\n        root /var/www/html;\r\n        index index.html;\r\n\r\n    }\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Request: ",(0,s.jsx)(n.code,{children:"http://example.com/about.html"})]}),"\n",(0,s.jsxs)(n.li,{children:["NGINX looks for: ",(0,s.jsx)(n.code,{children:"/var/www/html/about.html"})]}),"\n",(0,s.jsx)(n.li,{children:"If found \u2192 served directly"}),"\n",(0,s.jsx)(n.li,{children:"If not \u2192 404"}),"\n"]}),"\n",(0,s.jsxs)(n.h2,{id:"root-directive-most-common",children:[(0,s.jsx)(n.code,{children:"root"})," Directive (Most Common)"]}),"\n",(0,s.jsx)(n.p,{children:"Syntax"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"root path;\n"})}),"\n",(0,s.jsx)(n.p,{children:"How Path Is Built"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Full path = root + URI\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"location /images/ {\r\nroot /var/www;\r\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"Request:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"/images/logo.png\n"})}),"\n",(0,s.jsx)(n.p,{children:"File served:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"/var/www/images/logo.png\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"alias-directive-important-difference",children:[(0,s.jsx)(n.code,{children:"alias"})," Directive (Important Difference)"]}),"\n",(0,s.jsx)(n.p,{children:"Syntax"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"alias path;\n"})}),"\n",(0,s.jsx)(n.p,{children:"Example"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"location /images/ {\r\nalias /data/pictures/;\r\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"Request:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"/images/logo.png\n"})}),"\n",(0,s.jsx)(n.p,{children:"File served:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"/data/pictures/logo.png\n"})}),"\n",(0,s.jsx)(n.p,{children:"Key Difference"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"root"}),(0,s.jsx)(n.th,{children:"alias"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Appends URI"}),(0,s.jsx)(n.td,{children:"Replaces URI"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"More common"}),(0,s.jsx)(n.td,{children:"Needs care"})]})]})]}),"\n",(0,s.jsxs)(n.h2,{id:"default-files-with-index",children:["Default Files with ",(0,s.jsx)(n.code,{children:"index"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"index index.html index.htm;\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Example"})}),"\n",(0,s.jsxs)(n.p,{children:["Request: ",(0,s.jsx)(n.code,{children:"http://example.com/"})]}),"\n",(0,s.jsx)(n.p,{children:"NGINX tries:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"/var/www/html/index.html"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"/var/www/html/index.htm"})}),"\n"]}),"\n",(0,s.jsxs)(n.h2,{id:"file-existence-control-with-try_files",children:["File Existence Control with ",(0,s.jsx)(n.code,{children:"try_files"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"location / {\r\n   try_files $uri $uri/ =404;\r\n}\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Checks if file exists"}),"\n",(0,s.jsx)(n.li,{children:"Prevents unwanted proxying"}),"\n",(0,s.jsx)(n.li,{children:"Improves security"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"serving-assets-from-a-separate-directory",children:"Serving Assets from a Separate Directory"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"location /assets/ {\r\n   root /var/www;\r\n   expires 30d;\r\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"Request:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"/assets/style.css\n"})}),"\n",(0,s.jsx)(n.p,{children:"File:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"/var/www/assets/style.css\n"})}),"\n",(0,s.jsx)(n.p,{children:"Adds caching:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Cache-Control: max-age=2592000\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"auto-directory-listing-autoindex",children:["Auto Directory Listing (",(0,s.jsx)(n.code,{children:"autoindex"}),")"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"location /downloads/ {\r\n    root /var/www;\r\n    autoindex on;\r\n}\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Lists files if no index file exists"}),"\n",(0,s.jsx)(n.li,{children:"Use carefully (security risk)"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"mime-types--content-type",children:"MIME Types & Content-Type"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"http {\r\n    include mime.types;\r\n    default_type application/octet-stream;\r\n}\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Correct ",(0,s.jsx)(n.code,{children:"Content-Type"})," headers"]}),"\n",(0,s.jsx)(n.li,{children:"Browser renders files properly"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"performance-optimizations",children:"Performance Optimizations"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"sendfile"}),": ",(0,s.jsx)(n.code,{children:"sendfile on;"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Uses zero-copy file transfer."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"TCP Optimizations"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"tcp_nopush on;\r\ntcp_nodelay on;\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Gzip Compression"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"gzip on;\r\ngzip_types text/css application/javascript;\n"})}),"\n",(0,s.jsx)(n.h2,{id:"static-files--reverse-proxy-hybrid-setup",children:"Static Files + Reverse Proxy (Hybrid Setup)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"server {\r\n    listen 80;\r\n\r\n        location / {\r\n            root /var/www/html;\r\n            try_files $uri $uri/ @backend;\r\n        }\r\n\r\n        location @backend {\r\n            proxy_pass http://app_backend;\r\n        }\r\n\r\n    }\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Static files served directly"}),"\n",(0,s.jsx)(n.li,{children:"Dynamic requests proxied"}),"\n",(0,s.jsx)(n.li,{children:"Best performance pattern"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"security-best-practices",children:"Security Best Practices"}),"\n",(0,s.jsx)(n.p,{children:"Disable access to hidden files:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"location ~ /\\. {\r\ndeny all;\r\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"Prevent directory traversal:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"disable_symlinks on;\n"})}),"\n",(0,s.jsx)(n.p,{children:"Restrict file types:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"location ~ \\.(php|sh)$ {\r\ndeny all;\r\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"real-world-production-example",children:"Real-World Production Example"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"server {\r\n    listen 80;\r\n    server_name example.com;\r\n\r\n        root /var/www/app/public;\r\n        index index.html;\r\n\r\n        location / {\r\n            try_files $uri $uri/ =404;\r\n        }\r\n\r\n        location /static/ {\r\n            expires 7d;\r\n            access_log off;\r\n        }\r\n\r\n    }\n"})}),"\n",(0,s.jsx)(n.h2,{id:"common-mistakes",children:"Common Mistakes"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Mixing ",(0,s.jsx)(n.code,{children:"root"})," and ",(0,s.jsx)(n.code,{children:"alias"})," incorrectly"]}),"\n",(0,s.jsxs)(n.li,{children:["Forgetting trailing slash with ",(0,s.jsx)(n.code,{children:"alias"})]}),"\n",(0,s.jsxs)(n.li,{children:["Leaving ",(0,s.jsx)(n.code,{children:"autoindex"})," enabled"]}),"\n",(0,s.jsx)(n.li,{children:"Not setting cache headers"}),"\n"]})]})}function a(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}}}]);