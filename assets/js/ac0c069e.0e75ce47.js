"use strict";(globalThis.webpackChunkhandbook=globalThis.webpackChunkhandbook||[]).push([[64232],{3687(e,n,r){r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>d,default:()=>h,frontMatter:()=>t,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"rust/Error Handling.md/Result & Option","title":"Result & Option","description":"Option \u2014 Handling \u201cmaybe a value\u201d","source":"@site/docs/rust/12. Error Handling.md/2. Result & Option.md","sourceDirName":"rust/12. Error Handling.md","slug":"/rust/Error Handling.md/Result & Option","permalink":"/handbook/docs/rust/Error Handling.md/Result & Option","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{},"sidebar":"rustApiSidebar","previous":{"title":"Panic","permalink":"/handbook/docs/rust/Error Handling.md/Panic"},"next":{"title":"Unwrap and Expect","permalink":"/handbook/docs/rust/Error Handling.md/Unwrap and Expect"}}');var l=r(74848),s=r(28453);const t={},d=void 0,o={},a=[{value:"<code>Option&lt;T&gt;</code> \u2014 Handling \u201cmaybe a value\u201d",id:"optiont--handling-maybe-a-value",level:2},{value:"Example 1: Finding a value in a list",id:"example-1-finding-a-value-in-a-list",level:3},{value:"Common <code>Option</code> methods",id:"common-option-methods",level:3},{value:"<code>Result&lt;T, E&gt;</code> \u2014 Handling recoverable errors",id:"resultt-e--handling-recoverable-errors",level:2},{value:"Example 2: Safe division",id:"example-2-safe-division",level:3},{value:"Example 3: Reading a file",id:"example-3-reading-a-file",level:3},{value:"Converting between <code>Option</code> and <code>Result</code>",id:"converting-between-option-and-result",level:2},{value:"<code>Option</code> vs <code>Result</code> \u2014 When to use which",id:"option-vs-result--when-to-use-which",level:2},{value:"The <code>?</code> operator (works with both!)",id:"the--operator-works-with-both",level:2},{value:"Summary",id:"summary",level:2}];function c(e){const n={code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(n.h2,{id:"optiont--handling-maybe-a-value",children:[(0,l.jsx)(n.code,{children:"Option<T>"})," \u2014 Handling \u201cmaybe a value\u201d"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-rust",children:"enum Option<T> {\r\n    Some(T),\r\n    None,\r\n}\n"})}),"\n",(0,l.jsxs)(n.p,{children:["Use ",(0,l.jsx)(n.code,{children:"Option<T>"})," when:"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"A value might be present."}),"\n",(0,l.jsx)(n.li,{children:"Absence is normal and not an error (e.g., searching, optional fields)."}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"example-1-finding-a-value-in-a-list",children:"Example 1: Finding a value in a list"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-rust",children:'fn find_even(numbers: &[i32]) -> Option<i32> {\r\n    for &n in numbers {\r\n        if n % 2 == 0 {\r\n            return Some(n);\r\n        }\r\n    }\r\n    None\r\n}\r\n\r\nfn main() {\r\n    let nums = vec![1, 3, 5, 8, 9];\r\n\r\n    match find_even(&nums) {\r\n        Some(value) => println!("Found even number: {}", value),\r\n        None => println!("No even number found"),\r\n    }\r\n}\n'})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"Some(value)"})," \u2192 success."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"None"})," \u2192 nothing found."]}),"\n",(0,l.jsx)(n.li,{children:"The compiler forces you to handle both cases."}),"\n"]}),"\n",(0,l.jsxs)(n.h3,{id:"common-option-methods",children:["Common ",(0,l.jsx)(n.code,{children:"Option"})," methods"]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:"unwrap()"})," (may panic)"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-rust",children:'let x = Some(10);\r\nprintln!("{}", x.unwrap()); // prints 10\n'})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.code,{children:"unwrap_or()"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-rust",children:'let x: Option<i32> = None;\r\nprintln!("{}", x.unwrap_or(0)); // prints 0\n'})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:"if let"})," shorthand"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-rust",children:'if let Some(value) = find_even(&nums) {\r\n    println!("Found: {}", value);\r\n}\n'})}),"\n",(0,l.jsxs)(n.h2,{id:"resultt-e--handling-recoverable-errors",children:[(0,l.jsx)(n.code,{children:"Result<T, E>"})," \u2014 Handling recoverable errors"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-rust",children:"enum Result<T, E> {\r\n    Ok(T),\r\n    Err(E),\r\n}\n"})}),"\n",(0,l.jsxs)(n.p,{children:["Use ",(0,l.jsx)(n.code,{children:"Result<T, E>"})," when:"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"An operation might fail."}),"\n",(0,l.jsx)(n.li,{children:"You want to explain why it failed."}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"example-2-safe-division",children:"Example 2: Safe division"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-rust",children:'fn divide(a: i32, b: i32) -> Result<i32, String> {\r\n    if b == 0 {\r\n        Err("Cannot divide by zero".to_string())\r\n    } else {\r\n        Ok(a / b)\r\n    }\r\n}\r\n\r\nfn main() {\r\n    match divide(10, 0) {\r\n        Ok(result) => println!("Result: {}", result),\r\n        Err(e) => println!("Error: {}", e),\r\n    }\r\n}\n'})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"Ok(result)"})," \u2192 success."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"Err(error_message)"})," \u2192 failure with reason."]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"example-3-reading-a-file",children:"Example 3: Reading a file"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-rust",children:'use std::fs::File;\r\nuse std::io::{self, Read};\r\n\r\nfn read_file(path: &str) -> Result<String, io::Error> {\r\n    let mut file = File::open(path)?;  // may fail\r\n    let mut contents = String::new();\r\n    file.read_to_string(&mut contents)?; // may fail\r\n    Ok(contents)\r\n}\r\n\r\nfn main() {\r\n    match read_file("hello.txt") {\r\n        Ok(text) => println!("File contents:\\n{}", text),\r\n        Err(e) => println!("Failed to read file: {}", e),\r\n    }\r\n}\n'})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"?"})," propagates errors automatically."]}),"\n",(0,l.jsxs)(n.li,{children:["The function returns ",(0,l.jsx)(n.code,{children:"Result<String, io::Error>"}),"."]}),"\n"]}),"\n",(0,l.jsxs)(n.h2,{id:"converting-between-option-and-result",children:["Converting between ",(0,l.jsx)(n.code,{children:"Option"})," and ",(0,l.jsx)(n.code,{children:"Result"})]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:"Option"})," \u2192 ",(0,l.jsx)(n.code,{children:"Result"})]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-rust",children:'let value: Option<i32> = None;\r\nlet result = value.ok_or("Value was missing");\n'})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:"Result"})," \u2192 ",(0,l.jsx)(n.code,{children:"Option"})]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-rust",children:"let result: Result<i32, &str> = Ok(5);\r\nlet option = result.ok();\n"})}),"\n",(0,l.jsxs)(n.h2,{id:"option-vs-result--when-to-use-which",children:[(0,l.jsx)(n.code,{children:"Option"})," vs ",(0,l.jsx)(n.code,{children:"Result"})," \u2014 When to use which"]}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.th,{children:["Use ",(0,l.jsx)(n.code,{children:"Option<T>"})," when\u2026"]}),(0,l.jsxs)(n.th,{children:["Use ",(0,l.jsx)(n.code,{children:"Result<T, E>"})," when\u2026"]})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Value may or may not exist"}),(0,l.jsx)(n.td,{children:"Operation may fail"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Absence is normal"}),(0,l.jsx)(n.td,{children:"You need an error reason"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"No error details needed"}),(0,l.jsx)(n.td,{children:"Error details matter"})]})]})]}),"\n",(0,l.jsxs)(n.h2,{id:"the--operator-works-with-both",children:["The ",(0,l.jsx)(n.code,{children:"?"})," operator (works with both!)"]}),"\n",(0,l.jsxs)(n.p,{children:["With ",(0,l.jsx)(n.code,{children:"Result"}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-rust",children:"fn get_number() -> Result<i32, String> {\r\n    let n = divide(10, 2)?; // if Err, returns early\r\n    Ok(n * 2)\r\n}\n"})}),"\n",(0,l.jsxs)(n.p,{children:["With ",(0,l.jsx)(n.code,{children:"Option"}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-rust",children:"fn double_first_even(nums: &[i32]) -> Option<i32> {\r\n    let even = find_even(nums)?; // if None, returns None\r\n    Some(even * 2)\r\n}\n"})}),"\n",(0,l.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"Option<T>"})," = \u201cThere might be a value.\u201d"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"Result<T, E>"})," = \u201cThis might fail, and here\u2019s why.\u201d"]}),"\n",(0,l.jsx)(n.li,{children:"Both force you to handle errors at compile time."}),"\n",(0,l.jsxs)(n.li,{children:["Use ",(0,l.jsx)(n.code,{children:"match"}),", ",(0,l.jsx)(n.code,{children:"if let"}),", ",(0,l.jsx)(n.code,{children:"unwrap_or"}),", or ",(0,l.jsx)(n.code,{children:"?"})," to handle them cleanly."]}),"\n",(0,l.jsxs)(n.li,{children:["Prefer ",(0,l.jsx)(n.code,{children:"Result"})," over ",(0,l.jsx)(n.code,{children:"panic!"})," for recoverable errors."]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(c,{...e})}):c(e)}},28453(e,n,r){r.d(n,{R:()=>t,x:()=>d});var i=r(96540);const l={},s=i.createContext(l);function t(e){const n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:t(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);