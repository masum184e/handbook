"use strict";(globalThis.webpackChunkhandbook=globalThis.webpackChunkhandbook||[]).push([[8767],{28453(r,e,n){n.d(e,{R:()=>t,x:()=>l});var s=n(96540);const i={},o=s.createContext(i);function t(r){const e=s.useContext(o);return s.useMemo(function(){return"function"==typeof r?r(e):{...e,...r}},[e,r])}function l(r){let e;return e=r.disableParentContext?"function"==typeof r.components?r.components(i):r.components||i:t(r.components),s.createElement(o.Provider,{value:e},r.children)}},78931(r,e,n){n.r(e),n.d(e,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>t,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"prisma/Error Handling","title":"Error Handling","description":"When deploying Prisma applications, proper error handling is critical to ensure:","source":"@site/docs/prisma/16. Error Handling.md","sourceDirName":"prisma","slug":"/prisma/Error Handling","permalink":"/handbook/docs/prisma/Error Handling","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":16,"frontMatter":{"sidebar_position":16},"sidebar":"prismaApiSidebar","previous":{"title":"Deployment","permalink":"/handbook/docs/prisma/Deployment"}}');var i=n(74848),o=n(28453);const t={sidebar_position:16},l=void 0,d={},c=[{value:"Catching Prisma Errors",id:"catching-prisma-errors",level:2},{value:"Common Prisma Error Codes",id:"common-prisma-error-codes",level:2},{value:"Logging Queries &amp; Errors",id:"logging-queries--errors",level:2}];function a(r){const e={code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...r.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.p,{children:"When deploying Prisma applications, proper error handling is critical to ensure:"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Stability of your production system"}),"\n",(0,i.jsx)(e.li,{children:"Quick identification of issues"}),"\n",(0,i.jsx)(e.li,{children:"Proper response to users"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"Prisma interacts with databases, so errors can occur at different layers:"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Query errors"})," \u2013 invalid queries, missing records"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Constraint errors"})," \u2013 unique constraint violations, foreign key errors"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Connection errors"})," \u2013 database unreachable or timeout"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Runtime errors"})," \u2013 programming mistakes"]}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"catching-prisma-errors",children:"Catching Prisma Errors"}),"\n",(0,i.jsxs)(e.p,{children:["Prisma provides specialized error classes via ",(0,i.jsx)(e.code,{children:"@prisma/client/runtime"}),". The most commonly used is ",(0,i.jsx)(e.code,{children:"Prisma.PrismaClientKnownRequestError"}),"."]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-ts",children:'import { PrismaClient, Prisma } from "@prisma/client";\r\n\r\nconst prisma = new PrismaClient();\r\n\r\nasync function createUser(email: string, name: string) {\r\n  try {\r\n    const user = await prisma.user.create({\r\n      data: { email, name },\r\n    });\r\n    return user;\r\n  } catch (error) {\r\n    if (error instanceof Prisma.PrismaClientKnownRequestError) {\r\n      // Known Prisma errors\r\n      if (error.code === "P2002") {\r\n        // Unique constraint failed\r\n        console.error("Unique constraint failed:", error.meta);\r\n        throw new Error("Email already exists.");\r\n      }\r\n    }\r\n    // Unknown or other errors\r\n    console.error("Unexpected error:", error);\r\n    throw error;\r\n  }\r\n}\n'})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"P2002"})," \u2192 Unique constraint violation"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"PrismaClientKnownRequestError"})," allows fine-grained handling of Prisma-specific errors"]}),"\n",(0,i.jsx)(e.li,{children:"Always log errors for debugging, but avoid exposing raw DB errors to users"}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"common-prisma-error-codes",children:"Common Prisma Error Codes"}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"Code"}),(0,i.jsx)(e.th,{children:"Meaning"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"P2000"})}),(0,i.jsx)(e.td,{children:"Value too long for column"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"P2002"})}),(0,i.jsx)(e.td,{children:"Unique constraint failed"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"P2003"})}),(0,i.jsx)(e.td,{children:"Foreign key constraint failed"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"P2025"})}),(0,i.jsx)(e.td,{children:"Record not found for update/delete"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"P1001"})}),(0,i.jsx)(e.td,{children:"Database connection error"})]})]})]}),"\n",(0,i.jsx)(e.h2,{id:"logging-queries--errors",children:"Logging Queries & Errors"}),"\n",(0,i.jsx)(e.p,{children:"Prisma allows logging of queries, info, warnings, and errors. This is helpful for performance monitoring and debugging production issues."}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-ts",children:'const prisma = new PrismaClient({\r\n  log: [\r\n    { emit: "stdout", level: "query" },\r\n    { emit: "stdout", level: "info" },\r\n    { emit: "stdout", level: "warn" },\r\n    { emit: "stdout", level: "error" },\r\n  ],\r\n});\n'})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"query"})," \u2192 logs every SQL query executed"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"info"})," \u2192 general info events"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"warn"})," \u2192 warnings, e.g., potential issues"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"error"})," \u2192 errors"]}),"\n"]})]})}function h(r={}){const{wrapper:e}={...(0,o.R)(),...r.components};return e?(0,i.jsx)(e,{...r,children:(0,i.jsx)(a,{...r})}):a(r)}}}]);