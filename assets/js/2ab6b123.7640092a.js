"use strict";(globalThis.webpackChunkhandbook=globalThis.webpackChunkhandbook||[]).push([[3490],{364(e,n,s){s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"rest-api-design/Authentication","title":"Authentication","description":"Digest Authentication","source":"@site/docs/rest-api-design/20. Authentication.md","sourceDirName":"rest-api-design","slug":"/rest-api-design/Authentication","permalink":"/handbook/docs/rest-api-design/Authentication","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":22,"frontMatter":{"title":"Authentication","sidebar_position":22},"sidebar":"restApiSidebar","previous":{"title":"Developer Portal","permalink":"/handbook/docs/rest-api-design/Developer Portal"},"next":{"title":"Access Control","permalink":"/handbook/docs/rest-api-design/Access Control"}}');var i=s(74848),r=s(28453);const o={title:"Authentication",sidebar_position:22},a=void 0,c={},l=[{value:"Digest Authentication",id:"digest-authentication",level:2},{value:"How It Works",id:"how-it-works",level:3}];function d(e){const n={code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"digest-authentication",children:"Digest Authentication"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Digest Auth improves on Basic Auth by avoiding sending raw credentials."}),"\n",(0,i.jsx)(n.li,{children:"Instead, it uses hashing with a nonce (number used once) to prove identity."}),"\n",(0,i.jsx)(n.li,{children:"Password is never sent directly \u2014 the server challenges the client, and the client responds with a hashed value."}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"how-it-works",children:"How It Works"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Initial request \u2192 Client sends a request without credentials."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Server challenge \u2192 Server responds with ",(0,i.jsx)(n.code,{children:"401 Unauthorized"})," and a ",(0,i.jsx)(n.code,{children:"WWW-Authenticate"})," header containing:"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"A realm (scope of protection)."}),"\n",(0,i.jsx)(n.li,{children:"A nonce (unique random string)."}),"\n",(0,i.jsx)(n.li,{children:"The hashing algorithm."}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'HTTP/1.1 401 Unauthorized\r\nWWW-Authenticate: Digest realm="example.com",\r\n                  qop="auth",\r\n                  nonce="dcd98b7102dd2f0e8b11d0f600bfb0c093",\r\n                  opaque="5ccc069c403ebaf9f0171e9517f40e41"\n'})}),"\n",(0,i.jsxs)(n.ol,{start:"3",children:["\n",(0,i.jsxs)(n.li,{children:["Client response \u2192 Client uses the nonce, username, password, and request details to create a hashed response and resends the request with an ",(0,i.jsx)(n.code,{children:"Authorization: Digest"})," header."]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'GET /user/profile HTTP/1.1\r\nHost: api.example.com\r\nAuthorization: Digest username="masum",\r\n               realm="example.com",\r\n               nonce="dcd98b7102dd2f0e8b11d0f600bfb0c093",\r\n               uri="/user/profile",\r\n               response="6629fae49393a05397450978507c4ef1",\r\n               opaque="5ccc069c403ebaf9f0171e9517f40e41"\n'})}),"\n",(0,i.jsxs)(n.ol,{start:"4",children:["\n",(0,i.jsx)(n.li,{children:"Server verification \u2192 The server calculates the same hash and compares it."}),"\n"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"If it matches \u2192 grant access."}),"\n",(0,i.jsx)(n.li,{children:"If not \u2192 reject."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Digest Auth Example Explained"})}),"\n",(0,i.jsx)(n.p,{children:"The response value is typically an MD5 hash of:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-scss",children:"MD5( username:realm:password ) + MD5( method:uri ) + nonce\n"})}),"\n",(0,i.jsx)(n.p,{children:"This way, the password is never transmitted directly."})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},28453(e,n,s){s.d(n,{R:()=>o,x:()=>a});var t=s(96540);const i={},r=t.createContext(i);function o(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);