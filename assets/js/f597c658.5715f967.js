"use strict";(globalThis.webpackChunkhandbook=globalThis.webpackChunkhandbook||[]).push([[1600],{28453(e,n,r){r.d(n,{R:()=>d,x:()=>a});var s=r(96540);const i={},t=s.createContext(i);function d(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),s.createElement(t.Provider,{value:n},e.children)}},83655(e,n,r){r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>d,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"prisma/Prisma Client","title":"Prisma Client","description":"Prisma Client is the auto-generated database client that Prisma creates based on your schema.prisma.","source":"@site/docs/prisma/5. Prisma Client.md","sourceDirName":"prisma","slug":"/prisma/Prisma Client","permalink":"/handbook/docs/prisma/Prisma Client","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"prismaApiSidebar","previous":{"title":"Migration","permalink":"/handbook/docs/prisma/Migration"},"next":{"title":"Advanced Query","permalink":"/handbook/docs/prisma/Advanced Query"}}');var i=r(74848),t=r(28453);const d={sidebar_position:5},a=void 0,l={},o=[{value:"How Prisma Client is Generated",id:"how-prisma-client-is-generated",level:2},{value:"Using Prisma Client",id:"using-prisma-client",level:2},{value:"CRUD",id:"crud",level:2},{value:"Create",id:"create",level:3},{value:"Read",id:"read",level:3},{value:"<code>findUnique</code>",id:"findunique",level:4},{value:"<code>findMany</code>",id:"findmany",level:4},{value:"<code>findFirst</code>",id:"findfirst",level:4},{value:"Nested Reads",id:"nested-reads",level:4},{value:"Update",id:"update",level:3},{value:"Delete",id:"delete",level:3},{value:"Upsert",id:"upsert",level:2},{value:"Pagination",id:"pagination",level:2},{value:"Offset-based Pagination",id:"offset-based-pagination",level:3},{value:"Cursor-based Pagination",id:"cursor-based-pagination",level:3},{value:"Lazy Loading",id:"lazy-loading",level:2},{value:"Prisma\u2019s Alternatives to Lazy Loading",id:"prismas-alternatives-to-lazy-loading",level:3},{value:"Eager Loading with <code>include</code>",id:"eager-loading-with-include",level:4},{value:"Explicit Separate Queries (Manual Lazy Loading)",id:"explicit-separate-queries-manual-lazy-loading",level:4},{value:"Batching with <code>Prisma.$transaction</code>",id:"batching-with-prismatransaction",level:4},{value:"Dataloader Pattern (N+1 Solution)",id:"dataloader-pattern-n1-solution",level:3}];function c(e){const n={code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:["Prisma Client is the auto-generated database client that Prisma creates based on your ",(0,i.jsx)(n.code,{children:"schema.prisma"}),"."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"It lets you interact with your database using JavaScript/TypeScript methods (instead of raw SQL)."}),"\n",(0,i.jsx)(n.li,{children:"It\u2019s type-safe: if you use TypeScript, Prisma knows your schema and will catch mistakes at compile time."}),"\n",(0,i.jsx)(n.li,{children:"It supports all CRUD (Create, Read, Update, Delete) operations."}),"\n",(0,i.jsx)(n.li,{children:"It\u2019s database-agnostic \u2192 works with PostgreSQL, MySQL, SQLite, MongoDB, etc."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"You don\u2019t write Prisma Client code by hand. Instead, you define your schema \u2192 Prisma generates the client for you \u2192 then you import and use it."}),"\n",(0,i.jsx)(n.h2,{id:"how-prisma-client-is-generated",children:"How Prisma Client is Generated"}),"\n",(0,i.jsx)(n.p,{children:"When you run:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"npx prisma generate\n"})}),"\n",(0,i.jsx)(n.p,{children:"Prisma:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Reads your ",(0,i.jsx)(n.code,{children:"schema.prisma"})," file."]}),"\n",(0,i.jsxs)(n.li,{children:["Generates the Prisma Client in ",(0,i.jsx)(n.code,{children:"node_modules/.prisma/client"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Makes it available as ",(0,i.jsx)(n.code,{children:"@prisma/client"})," for you to use."]}),"\n",(0,i.jsx)(n.li,{children:"You can now use Prisma Client in your code"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"using-prisma-client",children:"Using Prisma Client"}),"\n",(0,i.jsx)(n.p,{children:"First, import and initialize:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'import { PrismaClient } from "@prisma/client";\r\n\r\nconst prisma = new PrismaClient();\n'})}),"\n",(0,i.jsx)(n.p,{children:"Now you can access your models as methods:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"prisma.user"})," \u2192 for the ",(0,i.jsx)(n.code,{children:"User"})," model."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"prisma.post"})," \u2192 for the ",(0,i.jsx)(n.code,{children:"Post"})," model."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Each model automatically gets CRUD functions like: ",(0,i.jsx)(n.code,{children:".create()"}),", ",(0,i.jsx)(n.code,{children:".findMany()"}),", ",(0,i.jsx)(n.code,{children:".findUnique()"}),", ",(0,i.jsx)(n.code,{children:".update()"}),", ",(0,i.jsx)(n.code,{children:".delete()"})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Keep ",(0,i.jsx)(n.code,{children:"datasource"})," and ",(0,i.jsx)(n.code,{children:"generator"})," at the top of ",(0,i.jsx)(n.code,{children:"schema.prisma"})," (before ",(0,i.jsx)(n.code,{children:"model"}),"s)."]}),"\n",(0,i.jsxs)(n.li,{children:["Use one ",(0,i.jsx)(n.code,{children:"datasource"})," per project (Prisma currently doesn\u2019t support multiple DBs in one schema)."]}),"\n",(0,i.jsxs)(n.li,{children:["You can have multiple ",(0,i.jsx)(n.code,{children:"generator"}),"s (e.g., one for Prisma Client, one for GraphQL schema)."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"crud",children:"CRUD"}),"\n",(0,i.jsx)(n.h3,{id:"create",children:"Create"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"create"})," method requires you to pass a ",(0,i.jsx)(n.code,{children:"data"})," object that matches your Prisma schema model fields. Only required fields must be provided; optional fields can be omitted or set to ",(0,i.jsx)(n.code,{children:"null"})," if allowed."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"const createdRecord = await prisma.modelName.create({\r\n  data: {\r\n    field1: value1,\r\n    field2: value2,\r\n    // ... other fields\r\n  },\r\n});\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"prisma.modelName"})," \u2192 Replace ",(0,i.jsx)(n.code,{children:"modelName"})," with your Prisma model (e.g., ",(0,i.jsx)(n.code,{children:"user"}),", ",(0,i.jsx)(n.code,{children:"post"}),")."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"data"})," \u2192 Object containing the data for the new record."]}),"\n",(0,i.jsx)(n.li,{children:"Returns the newly created record."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Nested Writes:"})}),"\n",(0,i.jsx)(n.p,{children:"Prisma supports creating related records in one query"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-prisma",children:"model Post {\r\n  id      Int    @id @default(autoincrement())\r\n  title   String\r\n  content String?\r\n  author  User   @relation(fields: [authorId], references: [id])\r\n  authorId Int\r\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"Create a user with a post"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'const newUserWithPost = await prisma.user.create({\r\n  data: {\r\n    name: "Charlie",\r\n    email: "charlie@example.com",\r\n    posts: {\r\n      create: { title: "My first post", content: "Hello World!" },\r\n    },\r\n  },\r\n  include: {\r\n    posts: true, // return posts as well\r\n  },\r\n});\n'})}),"\n",(0,i.jsx)(n.h3,{id:"read",children:"Read"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Method"}),(0,i.jsx)(n.th,{children:"Purpose"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"findUnique"})}),(0,i.jsxs)(n.td,{children:["Fetch ",(0,i.jsx)(n.strong,{children:"one record"})," by a ",(0,i.jsx)(n.strong,{children:"unique field"})," (like ",(0,i.jsx)(n.code,{children:"id"})," or unique column)."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"findMany"})}),(0,i.jsxs)(n.td,{children:["Fetch ",(0,i.jsx)(n.strong,{children:"multiple records"}),", optionally filtered, sorted, or paginated."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"findFirst"})}),(0,i.jsxs)(n.td,{children:["Fetch the ",(0,i.jsx)(n.strong,{children:"first record"})," that matches a filter, if multiple records match."]})]})]})]}),"\n",(0,i.jsx)(n.h4,{id:"findunique",children:(0,i.jsx)(n.code,{children:"findUnique"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Retrieve a single record by a unique field."}),"\n",(0,i.jsxs)(n.li,{children:["Returns ",(0,i.jsx)(n.code,{children:"null"})," if no record matches."]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'const user = await prisma.user.findUnique({\r\n  where: {\r\n    email: "alice@example.com", // must be a unique field\r\n  },\r\n});\n'})}),"\n",(0,i.jsx)(n.h4,{id:"findmany",children:(0,i.jsx)(n.code,{children:"findMany"})}),"\n",(0,i.jsx)(n.p,{children:"Retrieve multiple records, with optional filters, sorting, and pagination."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'const users = await prisma.user.findMany({\r\n  where: {\r\n    age: {\r\n      gte: 18, // users with age >= 18\r\n    },\r\n  },\r\n  orderBy: {\r\n    name: "asc", // sort by name ascending\r\n  },\r\n  skip: 0, // skip first N records\r\n  take: 10, // limit number of records\r\n});\n'})}),"\n",(0,i.jsx)(n.h4,{id:"findfirst",children:(0,i.jsx)(n.code,{children:"findFirst"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Retrieve the first record that matches a filter."}),"\n",(0,i.jsxs)(n.li,{children:["Returns a single record or ",(0,i.jsx)(n.code,{children:"null"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'const firstAdult = await prisma.user.findFirst({\r\n  where: { age: { gte: 18 } },\r\n  orderBy: { age: "asc" }, // the "first" one according to this order\r\n});\n'})}),"\n",(0,i.jsx)(n.h4,{id:"nested-reads",children:"Nested Reads"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"const userWithPosts = await prisma.user.findUnique({\r\n  where: { id: 1 },\r\n  include: { posts: true }, // include related posts\r\n});\r\n\r\nconsole.log(userWithPosts);\n"})}),"\n",(0,i.jsxs)(n.p,{children:["If you don\u2019t need all fields, use ",(0,i.jsx)(n.code,{children:"select"})," for fine-grained control."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"const posts = await prisma.post.findMany({\r\n  select: {\r\n    title: true,\r\n    author: {\r\n      select: { name: true }, // only get author's name\r\n    },\r\n    comments: {\r\n      select: { text: true }, // only get comment text\r\n    },\r\n  },\r\n});\r\n\r\nconsole.log(posts);\n"})}),"\n",(0,i.jsxs)(n.p,{children:["This is similar to SQL joins or ORM features like ",(0,i.jsx)(n.code,{children:"populate"})," (Mongoose) or ",(0,i.jsx)(n.code,{children:"include"})," (Sequelize/TypeORM)."]}),"\n",(0,i.jsx)(n.p,{children:"If you want:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"A user\u2019s details"}),"\n",(0,i.jsx)(n.li,{children:"AND all of their posts"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"You have two options:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Lazy Loading (multiple queries):"}),"\n"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Query the user"}),"\n",(0,i.jsx)(n.li,{children:"Then separately query the posts"}),"\n"]}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsx)(n.li,{children:"Eager Loading (include):"}),"\n"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Fetch user with posts in one Prisma query"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"update",children:"Update"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"update"})," operation is used to modify existing records in the database. Prisma Client provides:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"update"})," \u2192 Update a single record identified by a unique field."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"updateMany"})," \u2192 Update multiple records at once (optional, returns count of updated records)."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Key points:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["You must provide a unique identifier (",(0,i.jsx)(n.code,{children:"where"}),") for ",(0,i.jsx)(n.code,{children:"update"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["The ",(0,i.jsx)(n.code,{children:"data"})," object contains the fields you want to modify."]}),"\n",(0,i.jsx)(n.li,{children:"Prisma automatically validates field types and constraints."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Single Records Update"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"const updatedRecord = await prisma.modelName.update({\r\n  where: {\r\n    uniqueField: value, // e.g., id or email\r\n  },\r\n  data: {\r\n    field1: newValue1,\r\n    field2: newValue2,\r\n    // ...other fields\r\n  },\r\n});\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Multiple Record Update"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"const result = await prisma.modelName.updateMany({\r\n  where: { age: { lt: 18 } }, // filter records to update\r\n  data: { isMinor: true },\r\n});\r\n\r\nconsole.log(result.count); // number of records updated\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Returns ",(0,i.jsx)(n.code,{children:"{ count: number }"})," indicating how many records were updated."]}),"\n",(0,i.jsxs)(n.li,{children:["Cannot return the updated records themselves (use ",(0,i.jsx)(n.code,{children:"findMany"})," afterwards if needed)."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Nested Record Updated:"})}),"\n",(0,i.jsx)(n.p,{children:"Update a post and change its author name in a nested update"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'const updatedPost = await prisma.post.update({\r\n  where: { id: 1 },\r\n  data: {\r\n    title: "Updated Post Title",\r\n    author: {\r\n      update: { name: "Updated Author Name" }, // nested update\r\n    },\r\n  },\r\n});\r\n\r\nconsole.log(updatedPost);\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Prisma allows nested updates if relations are defined."}),"\n",(0,i.jsx)(n.li,{children:"Both the record and its related records can be updated in one query."}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"delete",children:"Delete"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Method"}),(0,i.jsx)(n.th,{children:"Purpose"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"delete"})}),(0,i.jsxs)(n.td,{children:["Delete a ",(0,i.jsx)(n.strong,{children:"single record"})," by a unique field (like ",(0,i.jsx)(n.code,{children:"id"})," or unique column)."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"deleteMany"})}),(0,i.jsxs)(n.td,{children:["Delete ",(0,i.jsx)(n.strong,{children:"multiple records"})," that match a filter."]})]})]})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"delete"})," requires a unique identifier (",(0,i.jsx)(n.code,{children:"where"}),") to locate the record."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"deleteMany"})," allows filtering multiple records."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Single Record Delete"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"const deletedRecord = await prisma.modelName.delete({\r\n  where: {\r\n    uniqueField: value, // e.g., id or email\r\n  },\r\n});\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Prisma returns the deleted record."}),"\n",(0,i.jsx)(n.li,{children:"If no record matches, Prisma throws an error."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Multiple Record Delete"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"const result = await prisma.modelName.deleteMany({\r\n  where: { age: { lt: 18 } }, // delete users under 18\r\n});\r\n\r\nconsole.log(result.count); // number of records deleted\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Returns ",(0,i.jsx)(n.code,{children:"{ count: number }"})," indicating the number of records deleted."]}),"\n",(0,i.jsxs)(n.li,{children:["If no records match, ",(0,i.jsx)(n.code,{children:"count"})," is 0."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Cascading Deletes"})}),"\n",(0,i.jsxs)(n.p,{children:["Assume a ",(0,i.jsx)(n.code,{children:"Post"})," model related to ",(0,i.jsx)(n.code,{children:"User"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-prisma",children:"model Post {\r\n  id       Int    @id @default(autoincrement())\r\n  title    String\r\n  content  String?\r\n  author   User   @relation(fields: [authorId], references: [id], onDelete: Cascade)\r\n  authorId Int\r\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:["If ",(0,i.jsx)(n.code,{children:"onDelete: Cascade"})," is set, deleting a user automatically deletes all their posts:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'const deletedUser = await prisma.user.delete({\r\n  where: { id: 2 },\r\n});\r\n\r\nconsole.log("Deleted user and their posts:", deletedUser);\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Cascading deletes are controlled by the schema relation."}),"\n",(0,i.jsxs)(n.li,{children:["Without ",(0,i.jsx)(n.code,{children:"Cascade"}),", deleting a parent may fail if child records exist."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"upsert",children:"Upsert"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Upsert = Update + Insert"})}),"\n",(0,i.jsx)(n.p,{children:"It\u2019s a single database operation that:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Updates a record if it already exists."}),"\n",(0,i.jsx)(n.li,{children:"Creates a new record if it doesn\u2019t exist."}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["This is super useful when you don\u2019t know whether the record is already in the database, and you want to ensure that either way, you end up with a record in the right state \u2014 without having to run multiple queries (",(0,i.jsx)(n.code,{children:"find \u2192 update/create"}),")."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-prisma",children:"prisma.modelName.upsert({\r\n  where: { uniqueField: value },\r\n  update: { ...fieldsToUpdate },\r\n  create: { ...fieldsToCreate },\r\n})\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"where"}),": Defines the unique identifier to check if the record exists. It must be a unique field (like id or a field with a unique constraint)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"update"}),": What to update if the record already exists."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"create"}),": What to insert if the record doesn\u2019t exist."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"pagination",children:"Pagination"}),"\n",(0,i.jsx)(n.h3,{id:"offset-based-pagination",children:"Offset-based Pagination"}),"\n",(0,i.jsx)(n.p,{children:"This is the most common (and simple) type of pagination."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"skip"}),": number of records to skip."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"take"}),": number of records to return (positive = forward, negative = backward)."]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"const users = await prisma.user.findMany({\r\n  skip: 5,   // skip the first 5\r\n  take: 5,   // get the next 5\r\n})\n"})}),"\n",(0,i.jsx)(n.h3,{id:"cursor-based-pagination",children:"Cursor-based Pagination"}),"\n",(0,i.jsx)(n.p,{children:"Instead of skipping records (which can get slow on large datasets), cursor pagination starts from a specific record."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"cursor"}),": defines the starting point (requires a unique field)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"skip"}),": often used with cursor to move past the cursor item."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"take"}),": how many to fetch from that point."]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"const users = await prisma.user.findMany({\r\n  cursor: { id: 10 }, // start at user with id=10\r\n  skip: 1,            // skip that cursor item itself\r\n  take: 5,            // fetch 5 after it\r\n})\n"})}),"\n",(0,i.jsx)(n.h2,{id:"lazy-loading",children:"Lazy Loading"}),"\n",(0,i.jsx)(n.p,{children:"In traditional ORMs, lazy loading means related records are only fetched when you explicitly access them, often through a proxy object."}),"\n",(0,i.jsx)(n.p,{children:"Example (in Sequelize/TypeORM-like systems):"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"const user = await User.findOne({ where: { id: 1 } });\r\nconst posts = await user.posts; // triggers a new SQL query on access\n"})}),"\n",(0,i.jsx)(n.p,{children:"But Prisma does not support true lazy loading."}),"\n",(0,i.jsx)(n.p,{children:"Why?"}),"\n",(0,i.jsx)(n.p,{children:"Because Prisma returns plain JavaScript objects (not \u201clive\u201d model instances with proxies). Once the query is executed, Prisma doesn\u2019t keep a connection between objects and the database."}),"\n",(0,i.jsx)(n.h3,{id:"prismas-alternatives-to-lazy-loading",children:"Prisma\u2019s Alternatives to Lazy Loading"}),"\n",(0,i.jsx)(n.p,{children:"Since Prisma doesn\u2019t provide automatic lazy loading, you have two main alternatives:"}),"\n",(0,i.jsxs)(n.h4,{id:"eager-loading-with-include",children:["Eager Loading with ",(0,i.jsx)(n.code,{children:"include"})]}),"\n",(0,i.jsx)(n.p,{children:"Fetch related records together with the parent in one query."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"const userWithPosts = await prisma.user.findUnique({\r\n  where: { id: 1 },\r\n  include: {\r\n    posts: true, // eager load relation\r\n  },\r\n});\r\n\r\nconsole.log(userWithPosts);\n"})}),"\n",(0,i.jsx)(n.h4,{id:"explicit-separate-queries-manual-lazy-loading",children:"Explicit Separate Queries (Manual Lazy Loading)"}),"\n",(0,i.jsx)(n.p,{children:"Instead of Prisma automatically lazy loading, you can explicitly query related data when you need it. This mimics lazy loading."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"// Step 1: Load user only\r\nconst user = await prisma.user.findUnique({\r\n  where: { id: 1 },\r\n});\r\n\r\nconsole.log(user);\r\n\r\n// Step 2: Later, only when needed, load posts\r\nconst posts = await prisma.post.findMany({\r\n  where: { authorId: user?.id },\r\n});\r\n\r\nconsole.log(posts);\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Avoids over-fetching unnecessary data."}),"\n",(0,i.jsx)(n.li,{children:"Two queries (can lead to N+1 problem if repeated in loops)."}),"\n"]}),"\n",(0,i.jsxs)(n.h4,{id:"batching-with-prismatransaction",children:["Batching with ",(0,i.jsx)(n.code,{children:"Prisma.$transaction"})]}),"\n",(0,i.jsx)(n.p,{children:"If you want to mimic lazy loading but avoid multiple round-trips, you can batch queries."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"const [user, posts] = await prisma.$transaction([\r\n  prisma.user.findUnique({ where: { id: 1 } }),\r\n  prisma.post.findMany({ where: { authorId: 1 } }),\r\n]);\r\n\r\nconsole.log(user, posts);\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Still two queries, but batched together \u2192 fewer network round trips."}),"\n",(0,i.jsx)(n.li,{children:"Better performance than doing them separately."}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"dataloader-pattern-n1-solution",children:"Dataloader Pattern (N+1 Solution)"}),"\n",(0,i.jsx)(n.p,{children:"If you need lazy-like loading for many records, you can integrate Prisma with DataLoader."}),"\n",(0,i.jsx)(n.p,{children:"Example use case: In GraphQL resolvers, instead of fetching posts per user individually (N+1 problem), batch them."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:'import DataLoader from "dataloader";\r\n\r\n// Create a DataLoader for posts by userId\r\nconst postsLoader = new DataLoader(async (userIds: number[]) => {\r\n  const posts = await prisma.post.findMany({\r\n    where: { authorId: { in: userIds } },\r\n  });\r\n\r\n  // group by authorId\r\n  return userIds.map((id) => posts.filter((p) => p.authorId === id));\r\n});\r\n\r\n// Usage\r\nconst user = await prisma.user.findUnique({ where: { id: 1 } });\r\nconst posts = await postsLoader.load(user.id);\r\n\r\nconsole.log(user, posts);\n'})})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}}}]);