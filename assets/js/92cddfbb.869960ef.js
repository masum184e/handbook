"use strict";(globalThis.webpackChunkhandbook=globalThis.webpackChunkhandbook||[]).push([[9389],{28453(e,n,i){i.d(n,{R:()=>t,x:()=>l});var s=i(96540);const r={},d=s.createContext(r);function t(e){const n=s.useContext(d);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),s.createElement(d.Provider,{value:n},e.children)}},86325(e,n,i){i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>t,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"redis/Geospatial Indexes","title":"Geospatial Indexes","description":"Redis provides built-in geospatial capabilities that allow you to:","source":"@site/docs/redis/13. Geospatial Indexes.md","sourceDirName":"redis","slug":"/redis/Geospatial Indexes","permalink":"/handbook/docs/redis/Geospatial Indexes","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":13,"frontMatter":{}}');var r=i(74848),d=i(28453);const t={},l=void 0,c={},o=[{value:"How Redis Geospatial Works Internally",id:"how-redis-geospatial-works-internally",level:2},{value:"Redis Geospatial Commands",id:"redis-geospatial-commands",level:2}];function a(e){const n={code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:"Redis provides built-in geospatial capabilities that allow you to:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Store geographic locations (longitude, latitude)"}),"\n",(0,r.jsx)(n.li,{children:"Query nearby points within a radius"}),"\n",(0,r.jsx)(n.li,{children:"Calculate distances between two locations"}),"\n",(0,r.jsx)(n.li,{children:"Sort by distance"}),"\n",(0,r.jsx)(n.li,{children:"Use bounding boxes and circular radius queries"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Redis geospatial features are built on top of the sorted set (ZSET) data structure using a technique called Geohash encoding."}),"\n",(0,r.jsx)(n.h2,{id:"how-redis-geospatial-works-internally",children:"How Redis Geospatial Works Internally"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Every geospatial point is stored as a Geohash, which is a 52-bit integer."}),"\n",(0,r.jsx)(n.li,{children:"Redis stores that integer inside a sorted set."}),"\n",(0,r.jsxs)(n.li,{children:["Geospatial commands (",(0,r.jsx)(n.code,{children:"GEOADD"}),", ",(0,r.jsx)(n.code,{children:"GEORADIUS"}),", etc.) handle encoding and querying."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Redis does not store altitude or 3D coordinates\u2014just latitude & longitude."}),"\n",(0,r.jsx)(n.h2,{id:"redis-geospatial-commands",children:"Redis Geospatial Commands"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Command"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"GEOADD"})}),(0,r.jsx)(n.td,{children:"Add a location with longitude, latitude, and name"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"GEOPOS"})}),(0,r.jsx)(n.td,{children:"Get coordinates of a member"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"GEODIST"})}),(0,r.jsx)(n.td,{children:"Get distance between two points"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"GEORADIUS"})}),(0,r.jsx)(n.td,{children:"Find members within a radius (circle)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"GEORADIUSBYMEMBER"})}),(0,r.jsx)(n.td,{children:"Radius query based on another member"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"GEORADIUS_RO"}),", ",(0,r.jsx)(n.code,{children:"GEORADIUSBYMEMBER_RO"})]}),(0,r.jsx)(n.td,{children:"Read-only versions"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"GEOHASH"})}),(0,r.jsx)(n.td,{children:"Get geohash strings"})]})]})]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Adding Geospatial Data"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:'GEOADD cities -74.00597 40.71427 "NewYork"\n'})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"cities = key name holding geospatial index"}),"\n",(0,r.jsx)(n.li,{children:"Each entry requires: longitude, latitude, member name"}),"\n",(0,r.jsx)(n.li,{children:"Redis converts data \u2192 geohash \u2192 stores in sorted set"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Retrieve Coordinates of a City"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'GEOPOS cities "NewYork"\n'})}),"\n",(0,r.jsx)(n.p,{children:"Output:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'1) 1) "-74.00596940505599976"\r\n   2) "40.71426910448555265"\n'})}),"\n",(0,r.jsx)(n.p,{children:"Redis returns the actual stored coordinates (with high precision)."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Get Distance Between Cities"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'GEODIST cities "NewYork" "Chicago" km\n'})}),"\n",(0,r.jsx)(n.p,{children:"Output"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"1146.3023\n"})}),"\n",(0,r.jsx)(n.p,{children:"Redis uses spherical Earth approximation (Haversine formula)."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Find Nearby Locations (Radius Query)"}),"\n",(0,r.jsx)(n.p,{children:"Example: Find cities within 1500 km of New York"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"GEORADIUS cities -74.00597 40.71427 1500 km\n"})}),"\n",(0,r.jsx)(n.p,{children:"Output:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'1) "Chicago"\r\n1) "NewYork"\n'})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Center \u2192 given manually (longitude/latitude)"}),"\n",(0,r.jsx)(n.li,{children:"Radius \u2192 1500 km"}),"\n",(0,r.jsx)(n.li,{children:"Returns matching cities sorted by distance from center (closest first)"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Radius Query Based on Another"}),"\n",(0,r.jsx)(n.p,{children:"Example: Cities within 1800 km of Chicago"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'GEORADIUSBYMEMBER cities "Chicago" 1800 km\n'})}),"\n",(0,r.jsx)(n.p,{children:"Output:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'1) "NewYork"\r\n1) "Chicago"\n'})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Uses Chicago\u2019s coordinates as the center automatically"}),"\n",(0,r.jsx)(n.li,{children:"Very useful for \u201cfind nearby users\u201d, \u201cfind nearby restaurants\u201d, etc."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Radius Query with Extra Details"}),"\n",(0,r.jsx)(n.p,{children:"Example: Include coordinates + distance + geohash"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:"GEORADIUS cities -74 40 1500 km WITHCOORD WITHDIST WITHHASH\n"})}),"\n",(0,r.jsx)(n.p,{children:"Output:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'1) 1) "NewYork"\r\n   2) "14.1"                 \u2190 distance\r\n   3) "3478007285230310"     \u2190 geohash\r\n   4) 1) "-74.0059"          \u2190 longitude\r\n      2) "40.7142"           \u2190 latitude\n'})}),"\n",(0,r.jsx)(n.p,{children:"Additional flags:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"WITHDIST"})," \u2192 distance from center"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"WITHCOORD"})," \u2192 return lat/lon"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"WITHHASH"})," \u2192 internal hash used in Redis"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Get Geohash Values"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'GEOHASH cities "NewYork"\n'})}),"\n",(0,r.jsx)(n.p,{children:"Output:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'1) "dr5regw3pg0"\n'})}),"\n",(0,r.jsx)(n.p,{children:"Geohashes provide:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Location encoding"}),"\n",(0,r.jsx)(n.li,{children:"Prefix similarity \u2192 spatial proximity (Locations close on map share geohash prefixes)"}),"\n"]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}}}]);