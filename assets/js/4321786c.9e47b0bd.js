"use strict";(globalThis.webpackChunkhandbook=globalThis.webpackChunkhandbook||[]).push([[45967],{28453(e,n,r){r.d(n,{R:()=>i,x:()=>o});var s=r(96540);const t={},c=s.createContext(t);function i(e){const n=s.useContext(c);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),s.createElement(c.Provider,{value:n},e.children)}},66916(e,n,r){r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>i,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"rest-api-design/Security Headers","title":"Security Headers","description":"Security headers are HTTP headers that help secure the communication between clients and servers. These headers protect APIs from a range of attacks such as cross-site scripting (XSS), clickjacking, content sniffing, and more.","source":"@site/docs/rest-api-design/17. Security Headers.md","sourceDirName":"rest-api-design","slug":"/rest-api-design/Security Headers","permalink":"/handbook/docs/rest-api-design/Security Headers","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":19,"frontMatter":{"title":"Security Headers","sidebar_position":19},"sidebar":"restApiSidebar","previous":{"title":"Jail","permalink":"/handbook/docs/rest-api-design/Jail"},"next":{"title":"API Management","permalink":"/handbook/docs/rest-api-design/API Management"}}');var t=r(74848),c=r(28453);const i={title:"Security Headers",sidebar_position:19},o=void 0,a={},l=[{value:"Common Security Headers",id:"common-security-headers",level:2},{value:"Content-Security-Policy (CSP)",id:"content-security-policy-csp",level:3},{value:"Strict-Transport-Security (HSTS)",id:"strict-transport-security-hsts",level:3},{value:"X-Content-Type-Options",id:"x-content-type-options",level:3},{value:"Access-Control-Allow-Origin (CORS)",id:"access-control-allow-origin-cors",level:3},{value:"Cache-Control",id:"cache-control",level:3},{value:"Example of Security Header",id:"example-of-security-header",level:2},{value:"Node.js Implementation",id:"nodejs-implementation",level:2}];function d(e){const n={code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,c.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.p,{children:"Security headers are HTTP headers that help secure the communication between clients and servers. These headers protect APIs from a range of attacks such as cross-site scripting (XSS), clickjacking, content sniffing, and more."}),"\n",(0,t.jsx)(n.h2,{id:"common-security-headers",children:"Common Security Headers"}),"\n",(0,t.jsx)(n.h3,{id:"content-security-policy-csp",children:"Content-Security-Policy (CSP)"}),"\n",(0,t.jsx)(n.p,{children:"Prevents cross-site scripting (XSS) and code injection by defining which resources are allowed to load."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"Content-Security-Policy: default-src 'none'; script-src 'self'; connect-src 'self' api.example.com\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"default-src 'none'"}),": block all by default"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"script-src 'self'"}),": only allow JS from the API's own domain"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"connect-src"}),": restrict fetch/XHR/websocket destinations\r\nAPIs that return HTML or are embedded in browsers benefit the most from CSP."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"strict-transport-security-hsts",children:"Strict-Transport-Security (HSTS)"}),"\n",(0,t.jsx)(n.p,{children:"Forces HTTPS-only connections to prevent man-in-the-middle (MITM) attacks."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"Strict-Transport-Security: max-age=31536000; includeSubDomains\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"max-age"}),": cache HTTPS requirement for 1 year (in seconds)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"includeSubDomains"}),": enforce for all subdomains\r\nOnly effective over HTTPS."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"x-content-type-options",children:"X-Content-Type-Options"}),"\n",(0,t.jsx)(n.p,{children:"Prevents MIME-type sniffing by browsers (which can lead to XSS)."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"X-Content-Type-Options: nosniff\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Ensures the browser uses the declared ",(0,t.jsx)(n.code,{children:"Content-Type"}),", rather than trying to guess it."]}),"\n",(0,t.jsx)(n.h3,{id:"access-control-allow-origin-cors",children:"Access-Control-Allow-Origin (CORS)"}),"\n",(0,t.jsx)(n.p,{children:"Controls which domains are allowed to access the API via browser."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"Access-Control-Allow-Origin: https://frontend.example.com\n"})}),"\n",(0,t.jsx)(n.p,{children:"Crucial for browser-based clients; not typically needed for server-to-server calls."}),"\n",(0,t.jsx)(n.h3,{id:"cache-control",children:"Cache-Control"}),"\n",(0,t.jsx)(n.p,{children:"Prevent sensitive API responses (like tokens or PII) from being cached."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"Cache-Control: no-store\r\nPragma: no-cache\r\nExpires: 0\n"})}),"\n",(0,t.jsx)(n.h2,{id:"example-of-security-header",children:"Example of Security Header"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"HTTP/1.1 200 OK\r\nContent-Type: application/json\r\nStrict-Transport-Security: max-age=31536000; includeSubDomains\r\nX-Content-Type-Options: nosniff\r\nX-Frame-Options: DENY\r\nContent-Security-Policy: default-src 'none'; connect-src 'self'\r\nReferrer-Policy: no-referrer\r\nAccess-Control-Allow-Origin: https://frontend.example.com\r\nCache-Control: no-store\r\nPragma: no-cache\n"})}),"\n",(0,t.jsx)(n.h2,{id:"nodejs-implementation",children:"Node.js Implementation"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:'const helmet = require("helmet");\r\napp.use(helmet()); // adds most security headers\r\n\r\n// Customize specific headers\r\napp.use(\r\n  helmet.contentSecurityPolicy({\r\n    directives: {\r\n      defaultSrc: ["\'none\'"],\r\n      connectSrc: ["\'self\'", "api.example.com"],\r\n    },\r\n  })\r\n);\r\n\r\napp.get("/api/data", (req, res) => {\r\n  res.set("Cache-Control", "no-store");\r\n  res.json({ data: "Secure Data" });\r\n});\n'})})]})}function h(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}}}]);