"use strict";(globalThis.webpackChunkhandbook=globalThis.webpackChunkhandbook||[]).push([[7624],{28453(e,n,i){i.d(n,{R:()=>a,x:()=>o});var r=i(96540);const s={},t=r.createContext(s);function a(e){const n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),r.createElement(t.Provider,{value:n},e.children)}},36828(e,n,i){i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>p,frontMatter:()=>a,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"prisma/Deployment","title":"Deployment","description":"Environment-specific configs","source":"@site/docs/prisma/15. Deployment.md","sourceDirName":"prisma","slug":"/prisma/Deployment","permalink":"/handbook/docs/prisma/Deployment","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":15,"frontMatter":{"sidebar_position":15},"sidebar":"prismaApiSidebar","previous":{"title":"With  GraphQL","permalink":"/handbook/docs/prisma/With  GraphQL"},"next":{"title":"Error Handling","permalink":"/handbook/docs/prisma/Error Handling"}}');var s=i(74848),t=i(28453);const a={sidebar_position:15},o=void 0,c={},l=[{value:"Environment-specific configs",id:"environment-specific-configs",level:2},{value:"Seeding databases",id:"seeding-databases",level:2},{value:"Configure a Seed Script",id:"configure-a-seed-script",level:3}];function d(e){const n={code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"environment-specific-configs",children:"Environment-specific configs"}),"\n",(0,s.jsx)(n.p,{children:"When deploying a Prisma application, you often have different environments\u2014like development, staging, and production. Each environment usually has different databases, credentials, and other settings. Managing these configs properly ensures security, stability, and flexibility."}),"\n",(0,s.jsxs)(n.p,{children:["Prisma supports environment-specific configurations primarily through environment variables and ",(0,s.jsx)(n.code,{children:".env"})," files."]}),"\n",(0,s.jsxs)(n.p,{children:["You can maintain separate ",(0,s.jsx)(n.code,{children:".env"})," files for each environment:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:".env.development"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:".env.staging"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:".env.production"})}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Then, when running Prisma commands or your app, you load the correct ",(0,s.jsx)(n.code,{children:".env"})," file:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Development\r\ncp .env.development .env && npx prisma generate\r\n\r\n# Production\r\ncp .env.production .env && npx prisma generate\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.strong,{children:["Using ",(0,s.jsx)(n.code,{children:"dotenv-cli"})," for multiple environments"]})}),"\n",(0,s.jsxs)(n.p,{children:["You can simplify environment-specific setup using ",(0,s.jsx)(n.code,{children:"dotenv-cli"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Install\r\nnpm install -D dotenv-cli\r\n\r\n# Run commands with specific env\r\ndotenv -e .env.production -- npx prisma migrate deploy\r\ndotenv -e .env.staging -- node server.js\n"})}),"\n",(0,s.jsx)(n.p,{children:"This allows you to keep one Prisma schema, but dynamically point it to different databases depending on the environment."}),"\n",(0,s.jsx)(n.h2,{id:"seeding-databases",children:"Seeding databases"}),"\n",(0,s.jsx)(n.p,{children:"Database seeding is the process of populating a database with initial or default data. This is useful for:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Development and testing"}),"\n",(0,s.jsx)(n.li,{children:"Setting up staging environments"}),"\n",(0,s.jsx)(n.li,{children:"Initial production setup (like default admin accounts, roles, or reference data)"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Prisma supports seeding via JavaScript/TypeScript scripts that use the Prisma Client."}),"\n",(0,s.jsx)(n.h3,{id:"configure-a-seed-script",children:"Configure a Seed Script"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"In your package.json, define a seed command:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\r\n  "prisma": {\r\n    "seed": "ts-node prisma/seed.ts"\r\n  }\r\n}\n'})}),"\n",(0,s.jsxs)(n.ol,{start:"2",children:["\n",(0,s.jsxs)(n.li,{children:["Create the seed file: ",(0,s.jsx)(n.code,{children:"prisma/seed.ts"})]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'import { PrismaClient } from "@prisma/client";\r\n\r\nconst prisma = new PrismaClient();\r\n\r\nasync function main() {\r\n  // Create default users\r\n  await prisma.user.upsert({\r\n    where: { email: "admin@example.com" },\r\n    update: {},\r\n    create: {\r\n      name: "Admin",\r\n      email: "admin@example.com",\r\n      role: "ADMIN",\r\n    },\r\n  });\r\n\r\n  await prisma.user.upsert({\r\n    where: { email: "user@example.com" },\r\n    update: {},\r\n    create: {\r\n      name: "User",\r\n      email: "user@example.com",\r\n      role: "USER",\r\n    },\r\n  });\r\n\r\n  console.log("Database seeding completed!");\r\n}\r\n\r\nmain()\r\n  .catch((e) => {\r\n    console.error(e);\r\n    process.exit(1);\r\n  })\r\n  .finally(async () => {\r\n    await prisma.$disconnect();\r\n  });\n'})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"upsert"})," ensures idempotency\u2014running the seed multiple times won\u2019t create duplicate records."]}),"\n",(0,s.jsxs)(n.li,{children:["Using ",(0,s.jsx)(n.code,{children:"PrismaClient"})," allows you to interact with the database the same way your app does."]}),"\n",(0,s.jsx)(n.li,{children:"Always disconnect at the end to avoid hanging connections."}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);