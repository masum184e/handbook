"use strict";(globalThis.webpackChunkhandbook=globalThis.webpackChunkhandbook||[]).push([[39226],{28453(e,n,r){r.d(n,{R:()=>l,x:()=>d});var i=r(96540);const t={},s=i.createContext(t);function l(e){const n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),i.createElement(s.Provider,{value:n},e.children)}},86651(e,n,r){r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>d,default:()=>a,frontMatter:()=>l,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"nodejs/Core Modules/Events","title":"Events","description":"The events module is a core Node.js module that provides the EventEmitter class.","source":"@site/docs/nodejs/5. Core Modules/4. Events.md","sourceDirName":"nodejs/5. Core Modules","slug":"/nodejs/Core Modules/Events","permalink":"/handbook/docs/nodejs/Core Modules/Events","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":4,"frontMatter":{},"sidebar":"nodejsApiSidebar","previous":{"title":"HTTP","permalink":"/handbook/docs/nodejs/Core Modules/HTTP"},"next":{"title":"Stream","permalink":"/handbook/docs/nodejs/Core Modules/Stream"}}');var t=r(74848),s=r(28453);const l={},d=void 0,o={},c=[{value:"Event-Driven Programming (Big Picture)",id:"event-driven-programming-big-picture",level:2},{value:"Creating an EventEmitter",id:"creating-an-eventemitter",level:2},{value:"Listening to Events (on)",id:"listening-to-events-on",level:2},{value:"Emitting Events (<code>emit</code>)",id:"emitting-events-emit",level:2},{value:"Passing Data with Events",id:"passing-data-with-events",level:2},{value:"Multiple Listeners for One Event",id:"multiple-listeners-for-one-event",level:2},{value:"One-Time Events (<code>once</code>)",id:"one-time-events-once",level:2},{value:"Removing Event Listeners",id:"removing-event-listeners",level:2},{value:"Error Events (VERY IMPORTANT)",id:"error-events-very-important",level:2},{value:"Extending EventEmitter (Real-World Pattern)",id:"extending-eventemitter-real-world-pattern",level:2},{value:"Real Example: File Download Simulation",id:"real-example-file-download-simulation",level:2},{value:"Events in Core Node APIs (Hidden in Plain Sight)",id:"events-in-core-node-apis-hidden-in-plain-sight",level:2},{value:"Event Loop &amp; Async Nature",id:"event-loop--async-nature",level:2},{value:"Common Mistakes",id:"common-mistakes",level:2},{value:"When Should You Use Events?",id:"when-should-you-use-events",level:2},{value:"Summary Cheat Sheet",id:"summary-cheat-sheet",level:2}];function h(e){const n={blockquote:"blockquote",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"events"})," module is a core Node.js module that provides the ",(0,t.jsx)(n.code,{children:"EventEmitter"})," class."]}),"\n",(0,t.jsx)(n.p,{children:"It lets you build systems based on events instead of direct function calls."}),"\n",(0,t.jsx)(n.p,{children:"In simple words"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"\u201cWhen something happens, notify whoever is listening.\u201d"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"This is the backbone of:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"HTTP servers"}),"\n",(0,t.jsx)(n.li,{children:"Streams"}),"\n",(0,t.jsx)(n.li,{children:"File system"}),"\n",(0,t.jsx)(n.li,{children:"Process events"}),"\n",(0,t.jsx)(n.li,{children:"Many libraries"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"event-driven-programming-big-picture",children:"Event-Driven Programming (Big Picture)"}),"\n",(0,t.jsx)(n.p,{children:"Instead of this (tight coupling):"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"doSomething();\r\ndoAnotherThing();\n"})}),"\n",(0,t.jsx)(n.p,{children:"You do this (loose coupling):"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'emitter.emit("done");\n'})}),"\n",(0,t.jsx)(n.p,{children:"And multiple listeners can react independently."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Event emitted \u2500\u2500\u25b6 Listener 1\r\n               \u2500\u2500\u25b6 Listener 2\r\n               \u2500\u2500\u25b6 Listener 3\n"})}),"\n",(0,t.jsx)(n.h2,{id:"creating-an-eventemitter",children:"Creating an EventEmitter"}),"\n",(0,t.jsx)(n.p,{children:"Basic Example"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'const EventEmitter = require("events");\r\n\r\nconst emitter = new EventEmitter();\n'})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"emitter"})," can emit events"]}),"\n",(0,t.jsx)(n.li,{children:"Other parts of your app can listen to them"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"listening-to-events-on",children:"Listening to Events (on)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'emitter.on("greet", () => {\r\n  console.log("Hello there!");\r\n});\n'})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:'"greet"'})," is the event name"]}),"\n",(0,t.jsx)(n.li,{children:"Callback runs every time the event is emitted"}),"\n"]}),"\n",(0,t.jsxs)(n.h2,{id:"emitting-events-emit",children:["Emitting Events (",(0,t.jsx)(n.code,{children:"emit"}),")"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'emitter.emit("greet");\n'})}),"\n",(0,t.jsx)(n.p,{children:"Output"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Hello there!\n"})}),"\n",(0,t.jsx)(n.p,{children:"Event names are just strings \u2014 but consistency matters."}),"\n",(0,t.jsx)(n.h2,{id:"passing-data-with-events",children:"Passing Data with Events"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'emitter.on("order", (item, quantity) => {\r\n  console.log(`Order received: ${quantity} ${item}`);\r\n});\r\n\r\nemitter.emit("order", "Pizza", 2);\n'})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Arguments passed to ",(0,t.jsx)(n.code,{children:"emit()"})," go directly to listeners"]}),"\n",(0,t.jsx)(n.li,{children:"No return values (fire-and-forget)"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"multiple-listeners-for-one-event",children:"Multiple Listeners for One Event"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'emitter.on("login", user => {\r\n  console.log(`User logged in: ${user}`);\r\n});\r\n\r\nemitter.on("login", user => {\r\n  console.log(`Audit log created for ${user}`);\r\n});\r\n\r\nemitter.emit("login", "Alice");\n'})}),"\n",(0,t.jsx)(n.p,{children:"Output"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"User logged in: Alice\r\nAudit log created for Alice\n"})}),"\n",(0,t.jsx)(n.p,{children:"This is decoupling in action."}),"\n",(0,t.jsxs)(n.h2,{id:"one-time-events-once",children:["One-Time Events (",(0,t.jsx)(n.code,{children:"once"}),")"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'emitter.once("init", () => {\r\n  console.log("Initialized only once");\r\n});\r\n\r\nemitter.emit("init");\r\nemitter.emit("init");\n'})}),"\n",(0,t.jsx)(n.p,{children:"Output"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Initialized only once\n"})}),"\n",(0,t.jsx)(n.p,{children:"Use cases"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Startup logic"}),"\n",(0,t.jsx)(n.li,{children:"One-time cleanup"}),"\n",(0,t.jsx)(n.li,{children:"Initialization events"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"removing-event-listeners",children:"Removing Event Listeners"}),"\n",(0,t.jsx)(n.p,{children:"Remove a specific listener"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'function handler() {\r\n  console.log("This will be removed");\r\n}\r\n\r\nemitter.on("test", handler);\r\nemitter.off("test", handler);\r\n\r\nemitter.emit("test"); // nothing happens\n'})}),"\n",(0,t.jsx)(n.p,{children:"Remove all listeners"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'emitter.removeAllListeners("test");\n'})}),"\n",(0,t.jsx)(n.h2,{id:"error-events-very-important",children:"Error Events (VERY IMPORTANT)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'emitter.on("error", err => {\r\n  console.error("Error caught:", err.message);\r\n});\r\n\r\nemitter.emit("error", new Error("Something broke"));\n'})}),"\n",(0,t.jsx)(n.p,{children:"Critical Rule"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["If an ",(0,t.jsx)(n.code,{children:'"error"'})," event is emitted without a listener, Node crashes."]}),"\n",(0,t.jsxs)(n.li,{children:["This is why streams and servers always handle ",(0,t.jsx)(n.code,{children:'"error"'}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"extending-eventemitter-real-world-pattern",children:"Extending EventEmitter (Real-World Pattern)"}),"\n",(0,t.jsx)(n.p,{children:"This is how many Node APIs are built."}),"\n",(0,t.jsx)(n.p,{children:"Custom Class with Events"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'const EventEmitter = require("events");\r\n\r\nclass OrderSystem extends EventEmitter {\r\n  placeOrder(item) {\r\n    console.log("Order placed");\r\n    this.emit("orderPlaced", item);\r\n  }\r\n}\r\n\r\nconst order = new OrderSystem();\r\n\r\norder.on("orderPlaced", item => {\r\n  console.log(`Preparing ${item}`);\r\n});\r\n\r\norder.placeOrder("Burger");\n'})}),"\n",(0,t.jsx)(n.p,{children:"Output"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Order placed\r\nPreparing Burger\n"})}),"\n",(0,t.jsx)(n.h2,{id:"real-example-file-download-simulation",children:"Real Example: File Download Simulation"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'const EventEmitter = require("events");\r\n\r\nclass Downloader extends EventEmitter {\r\n  start() {\r\n    console.log("Download started");\r\n    setTimeout(() => this.emit("progress", 50), 1000);\r\n    setTimeout(() => this.emit("progress", 100), 2000);\r\n    setTimeout(() => this.emit("done"), 2500);\r\n  }\r\n}\r\n\r\nconst download = new Downloader();\r\n\r\ndownload.on("progress", percent => {\r\n  console.log(`Progress: ${percent}%`);\r\n});\r\n\r\ndownload.on("done", () => {\r\n  console.log("Download complete!");\r\n});\r\n\r\ndownload.start();\n'})}),"\n",(0,t.jsx)(n.h2,{id:"events-in-core-node-apis-hidden-in-plain-sight",children:"Events in Core Node APIs (Hidden in Plain Sight)"}),"\n",(0,t.jsx)(n.p,{children:"You already use EventEmitter without realizing it:"}),"\n",(0,t.jsx)(n.p,{children:"HTTP Server"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'server.on("request", (req, res) => {});\n'})}),"\n",(0,t.jsx)(n.p,{children:"Streams"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'stream.on("data", chunk => {});\r\nstream.on("end", () => {});\n'})}),"\n",(0,t.jsx)(n.p,{children:"Process"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'process.on("exit", code => {});\r\nprocess.on("uncaughtException", err => {});\n'})}),"\n",(0,t.jsxs)(n.p,{children:["All of these extend ",(0,t.jsx)(n.code,{children:"EventEmitter"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"event-loop--async-nature",children:"Event Loop & Async Nature"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"emit()"})," is synchronous"]}),"\n",(0,t.jsx)(n.li,{children:"Listeners run in order of registration"}),"\n",(0,t.jsx)(n.li,{children:"But events are often triggered by async operations"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'emitter.emit("event"); // listeners run immediately\n'})}),"\n",(0,t.jsx)(n.h2,{id:"common-mistakes",children:"Common Mistakes"}),"\n",(0,t.jsx)(n.p,{children:"Memory Leaks"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Adding listeners repeatedly without removing them"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"emitter.setMaxListeners(20);\n"})}),"\n",(0,t.jsx)(n.p,{children:"Overusing Events"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Events are great for signals, not complex data flows."}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"when-should-you-use-events",children:"When Should You Use Events?"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Use when:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Multiple parts need to react"}),"\n",(0,t.jsx)(n.li,{children:"Loose coupling is desired"}),"\n",(0,t.jsx)(n.li,{children:"You\u2019re modeling real-world signals"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["Avoid when:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Simple function calls suffice"}),"\n",(0,t.jsx)(n.li,{children:"Data flow becomes hard to trace"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"summary-cheat-sheet",children:"Summary Cheat Sheet"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Feature"}),(0,t.jsx)(n.th,{children:"Description"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"EventEmitter"})}),(0,t.jsx)(n.td,{children:"Base class"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"on()"})}),(0,t.jsx)(n.td,{children:"Listen repeatedly"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"once()"})}),(0,t.jsx)(n.td,{children:"Listen once"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"emit()"})}),(0,t.jsx)(n.td,{children:"Trigger event"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"off()"})}),(0,t.jsx)(n.td,{children:"Remove listener"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:'"error"'})}),(0,t.jsx)(n.td,{children:"Must be handled"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Extend class"}),(0,t.jsx)(n.td,{children:"Real-world usage"})]})]})]})]})}function a(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}}}]);