"use strict";(globalThis.webpackChunkhandbook=globalThis.webpackChunkhandbook||[]).push([[33575],{7919(e,n,r){r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"nodejs/Streams","title":"Streams","description":"Streams","source":"@site/docs/nodejs/11. Streams.md","sourceDirName":"nodejs","slug":"/nodejs/Streams","permalink":"/handbook/docs/nodejs/Streams","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":11,"frontMatter":{},"sidebar":"nodejsApiSidebar","previous":{"title":"Debugging","permalink":"/handbook/docs/nodejs/Debugging"},"next":{"title":"Buffer","permalink":"/handbook/docs/nodejs/Buffer"}}');var t=r(74848),i=r(28453);const a={},l=void 0,d={},c=[{value:"Streams",id:"streams",level:2},{value:"Buffers",id:"buffers",level:2},{value:"Types of Streams",id:"types-of-streams",level:2},{value:"Readable Streams",id:"readable-streams",level:2},{value:"Reading a file",id:"reading-a-file",level:3},{value:"Writable Streams",id:"writable-streams",level:3},{value:"Piping: Connecting Streams",id:"piping-connecting-streams",level:3},{value:"Duplex Streams",id:"duplex-streams",level:2},{value:"Transform Streams",id:"transform-streams",level:2},{value:"File Compression",id:"file-compression",level:2},{value:"How Streams Use Buffers",id:"how-streams-use-buffers",level:2}];function o(e){const n={code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h2,{id:"streams",children:"Streams"}),"\n",(0,t.jsx)(n.p,{children:"A stream is an object that lets you read or write data piece by piece, instead of loading everything into memory at once."}),"\n",(0,t.jsx)(n.p,{children:"Think of it like drinking water through a straw instead of pouring the whole bottle into your mouth at once."}),"\n",(0,t.jsx)(n.p,{children:"Why streams matter:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Handle large files"}),"\n",(0,t.jsx)(n.li,{children:"Work with real-time data"}),"\n",(0,t.jsx)(n.li,{children:"Improve performance"}),"\n",(0,t.jsx)(n.li,{children:"Reduce memory usage"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"buffers",children:"Buffers"}),"\n",(0,t.jsx)(n.p,{children:"A Buffer is a chunk of raw binary data stored in memory."}),"\n",(0,t.jsx)(n.p,{children:"Streams often use Buffers internally to move data around."}),"\n",(0,t.jsx)(n.p,{children:"Example:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:'const buf = Buffer.from("Hello");\r\nconsole.log(buf); // <Buffer 48 65 6c 6c 6f>\r\nconsole.log(buf.toString()); // Hello\n'})}),"\n",(0,t.jsx)(n.h2,{id:"types-of-streams",children:"Types of Streams"}),"\n",(0,t.jsx)(n.p,{children:"There are 4 main types:"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Stream Type"}),(0,t.jsx)(n.th,{children:"Can Read?"}),(0,t.jsx)(n.th,{children:"Can Write?"}),(0,t.jsx)(n.th,{children:"Example"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Readable"}),(0,t.jsx)(n.td,{children:"\u2705 Yes"}),(0,t.jsx)(n.td,{children:"\u274c No"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"fs.createReadStream()"})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Writable"}),(0,t.jsx)(n.td,{children:"\u274c No"}),(0,t.jsx)(n.td,{children:"\u2705 Yes"}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"fs.createWriteStream()"})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Duplex"}),(0,t.jsx)(n.td,{children:"\u2705 Yes"}),(0,t.jsx)(n.td,{children:"\u2705 Yes"}),(0,t.jsx)(n.td,{children:"TCP socket"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Transform"}),(0,t.jsx)(n.td,{children:"\u2705 Yes"}),(0,t.jsx)(n.td,{children:"\u2705 Yes + modify data"}),(0,t.jsx)(n.td,{children:"Compression, encryption"})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"readable-streams",children:"Readable Streams"}),"\n",(0,t.jsx)(n.p,{children:"Used to read data chunk by chunk."}),"\n",(0,t.jsx)(n.h3,{id:"reading-a-file",children:"Reading a file"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:'const fs = require("fs");\r\n\r\nconst readStream = fs.createReadStream("example.txt", {\r\n  encoding: "utf8",\r\n  highWaterMark: 16, // bytes per chunk\r\n});\r\n\r\nreadStream.on("data", (chunk) => {\r\n  console.log("Received chunk:", chunk);\r\n});\r\n\r\nreadStream.on("end", () => {\r\n  console.log("Finished reading file.");\r\n});\n'})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"createReadStream()"})," creates a readable stream."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"highWaterMark"})," controls chunk size."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:'"data"'})," event fires for each chunk."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:'"end"'})," fires when file is done."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"writable-streams",children:"Writable Streams"}),"\n",(0,t.jsx)(n.p,{children:"Used to write data chunk by chunk."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:'const fs = require("fs");\r\n\r\nconst writeStream = fs.createWriteStream("output.txt");\r\n\r\nwriteStream.write("Hello ");\r\nwriteStream.write("World!");\r\nwriteStream.end();\r\n\r\nwriteStream.on("finish", () => {\r\n  console.log("Finished writing file.");\r\n});\n'})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"write()"})," sends chunks to the destination."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"end()"})," closes the stream."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:'"finish"'})," fires when all data is written."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"piping-connecting-streams",children:"Piping: Connecting Streams"}),"\n",(0,t.jsxs)(n.p,{children:["You can directly connect streams using ",(0,t.jsx)(n.code,{children:".pipe()"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:'const fs = require("fs");\r\n\r\nconst readStream = fs.createReadStream("input.txt");\r\nconst writeStream = fs.createWriteStream("copy.txt");\r\n\r\nreadStream.pipe(writeStream);\n'})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Data flows automatically from read stream \u2192 write stream."}),"\n",(0,t.jsx)(n.li,{children:"No manual chunk handling needed."}),"\n",(0,t.jsx)(n.li,{children:"This is memory efficient."}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"duplex-streams",children:"Duplex Streams"}),"\n",(0,t.jsx)(n.p,{children:"A duplex stream can both read and write independently."}),"\n",(0,t.jsx)(n.p,{children:"Example: TCP socket (client-server communication)."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:'// SImple duplex stream\r\nconst net = require("net");\r\n\r\nconst server = net.createServer((socket) => {\r\n  socket.write("Hello client!");\r\n\r\n  socket.on("data", (data) => {\r\n    console.log("Client says:", data.toString());\r\n  });\r\n});\r\n\r\nserver.listen(3000);\n'})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"The socket can send and receive data."}),"\n",(0,t.jsx)(n.li,{children:"Reading and writing are independent."}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"transform-streams",children:"Transform Streams"}),"\n",(0,t.jsx)(n.p,{children:"A transform stream is a special duplex stream that modifies the data passing through it."}),"\n",(0,t.jsx)(n.p,{children:"Example: Convert text to uppercase"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:'const { Transform } = require("stream");\r\n\r\nconst upperCaseTransform = new Transform({\r\n  transform(chunk, encoding, callback) {\r\n    const upper = chunk.toString().toUpperCase();\r\n    callback(null, upper);\r\n  }\r\n});\r\n\r\n// Usage:\r\nprocess.stdin.pipe(upperCaseTransform).pipe(process.stdout);\n'})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"transform()"})," receives each chunk."]}),"\n",(0,t.jsx)(n.li,{children:"You modify it and pass it onward."}),"\n",(0,t.jsx)(n.li,{children:"Here, user input is transformed to uppercase."}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"file-compression",children:"File Compression"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:'const fs = require("fs");\r\nconst zlib = require("zlib");\r\n\r\nconst readStream = fs.createReadStream("bigfile.txt");\r\nconst gzip = zlib.createGzip();\r\nconst writeStream = fs.createWriteStream("bigfile.txt.gz");\r\n\r\nreadStream.pipe(gzip).pipe(writeStream);\n'})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Reads file \u2192 compresses \u2192 writes compressed file."}),"\n",(0,t.jsx)(n.li,{children:"No full file loaded into memory."}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"how-streams-use-buffers",children:"How Streams Use Buffers"}),"\n",(0,t.jsx)(n.p,{children:"Internally:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Streams move data in buffers (default ~64KB)."}),"\n",(0,t.jsxs)(n.li,{children:["Each ",(0,t.jsx)(n.code,{children:"chunk"})," you receive is usually a ",(0,t.jsx)(n.code,{children:"Buffer"}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'readStream.on("data", (chunk) => {\r\n  console.log(Buffer.isBuffer(chunk)); // true\r\n});\n'})})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}},28453(e,n,r){r.d(n,{R:()=>a,x:()=>l});var s=r(96540);const t={},i=s.createContext(t);function a(e){const n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);