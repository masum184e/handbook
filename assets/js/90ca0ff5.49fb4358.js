"use strict";(globalThis.webpackChunkhandbook=globalThis.webpackChunkhandbook||[]).push([[55509],{13619(e,n,i){i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>t,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"nextjs/Deployment","title":"Deployment","description":"Vercel","source":"@site/docs/nextjs/13. Deployment.md","sourceDirName":"nextjs","slug":"/nextjs/Deployment","permalink":"/handbook/docs/nextjs/Deployment","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":15,"frontMatter":{"title":"Deployment","sidebar_position":15},"sidebar":"nextjsSidebar","previous":{"title":"Middleware","permalink":"/handbook/docs/nextjs/Middleware"},"next":{"title":"Internationalization","permalink":"/handbook/docs/nextjs/Internationlization"}}');var l=i(74848),r=i(28453);const t={title:"Deployment",sidebar_position:15},d=void 0,c={},a=[{value:"Vercel",id:"vercel",level:2},{value:"Environment Variables",id:"environment-variables",level:2},{value:"Optimizing the build process",id:"optimizing-the-build-process",level:2},{value:"What is <code>next build</code>",id:"what-is-next-build",level:3},{value:"Strategies to Optimize Next.js Build",id:"strategies-to-optimize-nextjs-build",level:3},{value:"Analyze Bundle Size",id:"analyze-bundle-size",level:4},{value:"Use Dynamic Imports",id:"use-dynamic-imports",level:4},{value:"Cache Dependencies in CI/CD",id:"cache-dependencies-in-cicd",level:4},{value:"Enable SWC Minification",id:"enable-swc-minification",level:4},{value:"Static Generation Where Possible",id:"static-generation-where-possible",level:4}];function o(e){const n={code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.h2,{id:"vercel",children:"Vercel"}),"\n",(0,l.jsx)(n.p,{children:"Handles serverless API routes, ISR (Incremental Static Regeneration), and Edge Functions out-of-the-box."}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Vercel installs dependencies (npm install)"}),"\n",(0,l.jsx)(n.li,{children:"Builds Next.js (npm run build)"}),"\n",(0,l.jsxs)(n.li,{children:["Deploys:","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Static pages (SSG) \u2192 served via CDN"}),"\n",(0,l.jsx)(n.li,{children:"API routes \u2192 deployed as serverless functions"}),"\n",(0,l.jsx)(n.li,{children:"Middleware \u2192 deployed as edge functions"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"environment-variables",children:"Environment Variables"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Variables prefixed with ",(0,l.jsx)(n.code,{children:"NEXT_PUBLIC_"})," are exposed to the browser."]}),"\n",(0,l.jsxs)(n.li,{children:["Variables without ",(0,l.jsx)(n.code,{children:"NEXT_PUBLIC_"})," are server-only and never exposed client-side."]}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-env",children:"NEXT_PUBLIC_API_URL=https://api.example.com    # accessible in browser\r\nDATABASE_URL=postgres://user:pass@host:5432/db   # server-only\r\nJWT_SECRET=mysecretkey                           # server-only\n"})}),"\n",(0,l.jsx)(n.h2,{id:"optimizing-the-build-process",children:"Optimizing the build process"}),"\n",(0,l.jsxs)(n.h3,{id:"what-is-next-build",children:["What is ",(0,l.jsx)(n.code,{children:"next build"})]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:"next build"})," is the Next.js build command that prepares your app for production. It performs:"]}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Compiling JavaScript and TypeScript"}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Generating static assets for SSG pages"}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Creating server-side rendered (SSR) pages"}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Optimizing images, CSS, and other assets"}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Tree-shaking and minifying code for production"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Optimizing this process ensures faster builds, smaller bundles, and better performance."}),"\n",(0,l.jsx)(n.h3,{id:"strategies-to-optimize-nextjs-build",children:"Strategies to Optimize Next.js Build"}),"\n",(0,l.jsx)(n.h4,{id:"analyze-bundle-size",children:"Analyze Bundle Size"}),"\n",(0,l.jsx)(n.p,{children:"Large bundles slow down both build and runtime. Use Webpack bundle analyzer:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:"npm install @next/bundle-analyzer\n"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:"next.config.js"}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:'const withBundleAnalyzer = require("@next/bundle-analyzer")({\r\n  enabled: process.env.ANALYZE === "true",\r\n});\r\n\r\nmodule.exports = withBundleAnalyzer({});\n'})}),"\n",(0,l.jsx)(n.p,{children:"Run analysis:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"ANALYZE=true next build\n"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Helps identify heavy dependencies."}),"\n",(0,l.jsx)(n.li,{children:"Allows code-splitting and dynamic imports for large components."}),"\n"]}),"\n",(0,l.jsx)(n.h4,{id:"use-dynamic-imports",children:"Use Dynamic Imports"}),"\n",(0,l.jsx)(n.p,{children:"For large components or libraries, use dynamic imports:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-tsx",children:'import dynamic from "next/dynamic";\r\n\r\nconst HeavyComponent = dynamic(() => import("../components/HeavyComponent"), {\r\n  ssr: false, // optional: render only on client\r\n});\n'})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Reduces initial JS bundle size."}),"\n",(0,l.jsx)(n.li,{children:"Improves Time to Interactive (TTI)."}),"\n"]}),"\n",(0,l.jsx)(n.h4,{id:"cache-dependencies-in-cicd",children:"Cache Dependencies in CI/CD"}),"\n",(0,l.jsxs)(n.p,{children:["In Vercel, Netlify, or GitHub Actions, caching ",(0,l.jsx)(n.code,{children:"node_modules"})," or ",(0,l.jsx)(n.code,{children:".next/cache"})," speeds up builds."]}),"\n",(0,l.jsx)(n.p,{children:"GitHub Actions Example:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"- name: Cache node modules\r\n  uses: actions/cache@v2\r\n  with:\r\n    path: ~/.npm\r\n    key: ${{ runner.os }}-node-${{ hashFiles('package-lock.json') }}\n"})}),"\n",(0,l.jsx)(n.h4,{id:"enable-swc-minification",children:"Enable SWC Minification"}),"\n",(0,l.jsx)(n.p,{children:"Next.js uses SWC compiler by default. Ensure minification is enabled:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:"// next.config.js\r\nmodule.exports = {\r\n  swcMinify: true,\r\n};\n"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Faster than Terser"}),"\n",(0,l.jsx)(n.li,{children:"Produces smaller JS bundles"}),"\n"]}),"\n",(0,l.jsx)(n.h4,{id:"static-generation-where-possible",children:"Static Generation Where Possible"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Use SSG (",(0,l.jsx)(n.code,{children:"getStaticProps"}),") instead of SSR (",(0,l.jsx)(n.code,{children:"getServerSideProps"}),") when data is mostly static."]}),"\n",(0,l.jsx)(n.li,{children:"SSG allows pre-rendering at build time, reducing runtime server load."}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:'export async function getStaticProps() {\r\n  const res = await fetch("https://api.example.com/posts");\r\n  const posts = await res.json();\r\n\r\n  return { props: { posts }, revalidate: 60 }; // ISR\r\n}\n'})}),"\n",(0,l.jsx)(n.p,{children:"ISR updates pages incrementally without rebuilding the whole site."})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(o,{...e})}):o(e)}},28453(e,n,i){i.d(n,{R:()=>t,x:()=>d});var s=i(96540);const l={},r=s.createContext(l);function t(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:t(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);