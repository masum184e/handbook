"use strict";(globalThis.webpackChunkhandbook=globalThis.webpackChunkhandbook||[]).push([[9953],{28453(e,s,n){n.d(s,{R:()=>t,x:()=>d});var r=n(96540);const i={},a=r.createContext(i);function t(e){const s=r.useContext(a);return r.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function d(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),r.createElement(a.Provider,{value:s},e.children)}},36471(e,s,n){n.r(s),n.d(s,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>t,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"redis/Real Integrations","title":"Real Integrations","description":"Redis as a Cache Layer","source":"@site/docs/redis/20. Real Integrations.md","sourceDirName":"redis","slug":"/redis/Real Integrations","permalink":"/handbook/docs/redis/Real Integrations","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":20,"frontMatter":{}}');var i=n(74848),a=n(28453);const t={},d=void 0,c={},l=[{value:"Redis as a Cache Layer",id:"redis-as-a-cache-layer",level:2},{value:"Redis for Session Storage",id:"redis-for-session-storage",level:2},{value:"Redis for Message Queues (Using Pub/Sub or Streams)",id:"redis-for-message-queues-using-pubsub-or-streams",level:2},{value:"Redis Streams for Event Processing (Advanced Integration)",id:"redis-streams-for-event-processing-advanced-integration",level:2},{value:"Redis for Distributed Locks (Redlock Pattern)",id:"redis-for-distributed-locks-redlock-pattern",level:2},{value:"Redis with Real-time Analytics / Leaderboards",id:"redis-with-real-time-analytics--leaderboards",level:2},{value:"Redis as a Rate Limiter",id:"redis-as-a-rate-limiter",level:2}];function o(e){const s={code:"code",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.h2,{id:"redis-as-a-cache-layer",children:"Redis as a Cache Layer"}),"\n",(0,i.jsx)(s.p,{children:"Apps often connect to slow data sources (SQL databases, APIs). Redis is used as a caching layer to store frequently accessed data."}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"Client \u2192 Application \u2192 Redis Cache \u2192 (fallback) Database\n"})}),"\n",(0,i.jsx)(s.p,{children:"Node.js Implementation"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-ts",children:'import express from "express";\r\nimport Redis from "ioredis";\r\nimport fetch from "node-fetch";\r\n\r\nconst app = express();\r\nconst redis = new Redis();\r\n\r\n// GET /user/123\r\napp.get("/user/:id", async (req, res) => {\r\n  const userId = req.params.id;\r\n\r\n  // 1. Check cache\r\n  const cached = await redis.get(`user:${userId}`);\r\n  if (cached) {\r\n    return res.json({ source: "redis-cache", data: JSON.parse(cached) });\r\n  }\r\n\r\n  // 2. Fetch from external DB/API\r\n  const response = await fetch(`https://jsonplaceholder.typicode.com/users/${userId}`);\r\n  const userData = await response.json();\r\n\r\n  // 3. Save to Redis for 60 sec\r\n  await redis.setex(`user:${userId}`, 60, JSON.stringify(userData));\r\n\r\n  res.json({ source: "api", data: userData });\r\n});\r\n\r\napp.listen(3000, () => console.log("Server running"));\n'})}),"\n",(0,i.jsx)(s.h2,{id:"redis-for-session-storage",children:"Redis for Session Storage"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-ts",children:'import session from "express-session";\r\nimport connectRedis from "connect-redis";\r\nimport Redis from "ioredis";\r\n\r\nconst RedisStore = connectRedis(session);\r\nconst redis = new Redis();\r\n\r\napp.use(\r\n  session({\r\n    store: new RedisStore({ client: redis }),\r\n    secret: "mySecret",\r\n    resave: false,\r\n    saveUninitialized: false,\r\n    cookie: { maxAge: 60000 }\r\n  })\r\n);\n'})}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Sessions are stored inside Redis."}),"\n",(0,i.jsx)(s.li,{children:"Any server instance can access the same session."}),"\n",(0,i.jsx)(s.li,{children:"Helps with load-balanced architectures."}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"redis-for-message-queues-using-pubsub-or-streams",children:"Redis for Message Queues (Using Pub/Sub or Streams)"}),"\n",(0,i.jsx)(s.p,{children:"Redis can integrate with microservices as a message broker."}),"\n",(0,i.jsx)(s.p,{children:"Publisher"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-ts",children:'import Redis from "ioredis";\r\nconst pub = new Redis();\r\n\r\npub.publish("orders", "Order #5001 created");\n'})}),"\n",(0,i.jsx)(s.p,{children:"Subscriber"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-ts",children:'import Redis from "ioredis";\r\nconst sub = new Redis();\r\n\r\nsub.subscribe("orders");\r\nsub.on("message", (channel, message) => {\r\n  console.log(`Received from ${channel}: ${message}`);\r\n});\n'})}),"\n",(0,i.jsx)(s.p,{children:"Explanation"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"The publisher sends messages to a channel."}),"\n",(0,i.jsx)(s.li,{children:"All subscribers listening to the channel receive the message."}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"Used in:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Notification systems"}),"\n",(0,i.jsx)(s.li,{children:"Realtime logging"}),"\n",(0,i.jsx)(s.li,{children:"Realtime analytics dashboards"}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"redis-streams-for-event-processing-advanced-integration",children:"Redis Streams for Event Processing (Advanced Integration)"}),"\n",(0,i.jsx)(s.p,{children:"Redis Streams are used for:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Event pipelines"}),"\n",(0,i.jsx)(s.li,{children:"Background workers"}),"\n",(0,i.jsx)(s.li,{children:"Ordered message processing"}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"Producer"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-ts",children:'await redis.xadd("payments-stream", "*", "user", "42", "amount", "99.00");\n'})}),"\n",(0,i.jsx)(s.p,{children:"Consumer"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-ts",children:'const messages = await redis.xread(\r\n  { block: 5000 },\r\n  "STREAMS",\r\n  "payments-stream",\r\n  "0"\r\n);\r\n\r\nconsole.log(messages);\n'})}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Stream stores messages with IDs."}),"\n",(0,i.jsx)(s.li,{children:"Consumers process them in order."}),"\n",(0,i.jsx)(s.li,{children:"Supports consumer groups for load balancing."}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"redis-for-distributed-locks-redlock-pattern",children:"Redis for Distributed Locks (Redlock Pattern)"}),"\n",(0,i.jsx)(s.p,{children:"Used to prevent:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Duplicate payments"}),"\n",(0,i.jsx)(s.li,{children:"Race condition updates"}),"\n",(0,i.jsx)(s.li,{children:"Concurrency issues"}),"\n"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-ts",children:'import Redis from "ioredis";\r\nconst redis = new Redis();\r\n\r\nasync function runCriticalSection() {\r\n  const lockKey = "lock:payment:501";\r\n  const lock = await redis.set(lockKey, "locked", "NX", "EX", 10);\r\n\r\n  if (!lock) {\r\n    console.log("Another process is already handling this!");\r\n    return;\r\n  }\r\n\r\n  console.log("Running critical work...");\r\n  \r\n  // critical logic here...\r\n\r\n  await redis.del(lockKey);\r\n}\n'})}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"NX"})," ensures key is set only if it doesn\u2019t exist."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"EX 10"})," auto-expires lock in case of crash."]}),"\n",(0,i.jsx)(s.li,{children:"Only one worker can hold the lock at a time."}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"redis-with-real-time-analytics--leaderboards",children:"Redis with Real-time Analytics / Leaderboards"}),"\n",(0,i.jsx)(s.p,{children:"Redis sorted sets (ZSET) are perfect for:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Game leaderboards"}),"\n",(0,i.jsx)(s.li,{children:"Ranking systems"}),"\n",(0,i.jsx)(s.li,{children:"Trending items"}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"Leaderboard"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-ts",children:'await redis.zadd("game:leaderboard", 1500, "player1");\r\nawait redis.zadd("game:leaderboard", 2200, "player2");\r\n\r\nconst topPlayers = await redis.zrevrange("game:leaderboard", 0, 2, "WITHSCORES");\r\nconsole.log(topPlayers);\n'})}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Sorted sets keep elements ordered automatically."}),"\n",(0,i.jsxs)(s.li,{children:["You can get top ",(0,i.jsx)(s.code,{children:"N"})," users instantly."]}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"redis-as-a-rate-limiter",children:"Redis as a Rate Limiter"}),"\n",(0,i.jsx)(s.p,{children:"Used for:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"API rate limits"}),"\n",(0,i.jsx)(s.li,{children:"Login attempt limits"}),"\n",(0,i.jsx)(s.li,{children:"Preventing abuse"}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"10 Requests Per Minute Limit"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-ts",children:"async function isRateLimited(userId) {\r\n  const key = `rate:${userId}`;\r\n  const count = await redis.incr(key);\r\n\r\n  if (count === 1) {\r\n    await redis.expire(key, 60);\r\n  }\r\n\r\n  return count > 10;\r\n}\n"})}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"incr()"})," automatically increments request count."]}),"\n",(0,i.jsx)(s.li,{children:"Key expires after 60 seconds."}),"\n",(0,i.jsx)(s.li,{children:"If count exceeds limit \u2192 block user."}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,a.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}}}]);