"use strict";(globalThis.webpackChunkhandbook=globalThis.webpackChunkhandbook||[]).push([[35107],{28453(e,n,s){s.d(n,{R:()=>t,x:()=>c});var i=s(96540);const r={},l=i.createContext(r);function t(e){const n=i.useContext(l);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),i.createElement(l.Provider,{value:n},e.children)}},92121(e,n,s){s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>t,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"rest-api-design/Security Practices","title":"Security Practices","description":"HTTPS Everywhere","source":"@site/docs/rest-api-design/22. Security Practices.md","sourceDirName":"rest-api-design","slug":"/rest-api-design/Security Practices","permalink":"/handbook/docs/rest-api-design/Security Practices","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":24,"frontMatter":{"title":"Security Practices","sidebar_position":24},"sidebar":"restApiSidebar","previous":{"title":"Access Control","permalink":"/handbook/docs/rest-api-design/Access Control"},"next":{"title":"Input Validation","permalink":"/handbook/docs/rest-api-design/Input Validation"}}');var r=s(74848),l=s(28453);const t={title:"Security Practices",sidebar_position:24},c=void 0,a={},o=[{value:"HTTPS Everywhere",id:"https-everywhere",level:2},{value:"Why HTTPS is Critical for REST APIs",id:"why-https-is-critical-for-rest-apis",level:3},{value:"How to Enforce HTTPS in REST APIs",id:"how-to-enforce-https-in-rest-apis",level:3},{value:"REST API over HTTPS",id:"rest-api-over-https",level:3},{value:"Cross-Origin Resource Sharing",id:"cross-origin-resource-sharing",level:2},{value:"Why CORS is Important in REST APIs",id:"why-cors-is-important-in-rest-apis",level:3},{value:"How CORS Works",id:"how-cors-works",level:3},{value:"CORS Headers Explained",id:"cors-headers-explained",level:3},{value:"CORS in REST API",id:"cors-in-rest-api",level:3},{value:"Best Practices for CORS in REST APIs",id:"best-practices-for-cors-in-rest-apis",level:3},{value:"Rate Limiting",id:"rate-limiting",level:2},{value:"Example of Rate Limiting",id:"example-of-rate-limiting",level:3},{value:"Common Rate Limiting Strategies",id:"common-rate-limiting-strategies",level:3},{value:"Best Practices of Rate Limiting",id:"best-practices-of-rate-limiting",level:3},{value:"Throttling",id:"throttling",level:2},{value:"Example of Throttling",id:"example-of-throttling",level:3},{value:"Rate Limiting vs Throttling",id:"rate-limiting-vs-throttling",level:3},{value:"Avoiding common vulnerabilities",id:"avoiding-common-vulnerabilities",level:2},{value:"SQL Injection",id:"sql-injection",level:3},{value:"Cross-Site Scripting",id:"cross-site-scripting",level:3},{value:"Cross-Site Request Forgery",id:"cross-site-request-forgery",level:3},{value:"API Gateway usage",id:"api-gateway-usage",level:2},{value:"Why Use an API Gateway for Security?",id:"why-use-an-api-gateway-for-security",level:3},{value:"How an API Gateway Works (Flow)",id:"how-an-api-gateway-works-flow",level:3},{value:"Key Security Features of API Gateway",id:"key-security-features-of-api-gateway",level:3},{value:"Example Scenario with API Gateway",id:"example-scenario-with-api-gateway",level:3}];function d(e){const n={code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"https-everywhere",children:"HTTPS Everywhere"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"HTTPS (Hypertext Transfer Protocol Secure) = HTTP + TLS (Transport Layer Security)."}),"\n",(0,r.jsxs)(n.li,{children:["Ensures that all communication between the client (browser, mobile app, or service) and the API server is:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Encrypted \u2192 prevents eavesdropping (man-in-the-middle attacks)."}),"\n",(0,r.jsx)(n.li,{children:"Authenticated \u2192 guarantees the server is who it claims to be."}),"\n",(0,r.jsx)(n.li,{children:"Integrity-protected \u2192 prevents data tampering in transit."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"\u201cHTTPS Everywhere\u201d means: Always enforce HTTPS for all REST API requests \u2014 no exceptions."}),"\n",(0,r.jsx)(n.h3,{id:"why-https-is-critical-for-rest-apis",children:"Why HTTPS is Critical for REST APIs"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Protects Sensitive Data"}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"API calls often include tokens, API keys, passwords, user info."}),"\n",(0,r.jsx)(n.li,{children:"Without HTTPS, this data can be stolen in plain text."}),"\n"]}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsx)(n.li,{children:"Prevents Man-in-the-Middle (MITM) Attacks"}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Attackers can intercept and modify requests on unsecured HTTP."}),"\n",(0,r.jsx)(n.li,{children:"With HTTPS, TLS ensures encryption + server authenticity."}),"\n"]}),"\n",(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsx)(n.li,{children:"Secures Authentication & Authorization"}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Mechanisms like Basic Auth, OAuth 2.0, JWT are safe only if transported via HTTPS."}),"\n"]}),"\n",(0,r.jsxs)(n.ol,{start:"4",children:["\n",(0,r.jsx)(n.li,{children:"Builds Trust"}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Most modern clients reject HTTP APIs or warn users."}),"\n",(0,r.jsx)(n.li,{children:"Browsers block mixed content (HTTPS site calling HTTP API)."}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"how-to-enforce-https-in-rest-apis",children:"How to Enforce HTTPS in REST APIs"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Redirect all HTTP requests \u2192 HTTPS"}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["If a client mistakenly calls ",(0,r.jsx)(n.code,{children:"http://api.example.com"}),", the server responds with ",(0,r.jsx)(n.code,{children:"301 Moved Permanently"})," \u2192 redirects to ",(0,r.jsx)(n.code,{children:"https://api.example.com"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsx)(n.li,{children:"Use HSTS (HTTP Strict Transport Security)"}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Tells browsers: \u201cAlways use HTTPS, even if the user types HTTP.\u201d"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Example header:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"Strict-Transport-Security: max-age=31536000; includeSubDomains\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsx)(n.li,{children:"Disable HTTP completely"}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Block port ",(0,r.jsx)(n.code,{children:"80"})," (HTTP) and only accept ",(0,r.jsx)(n.code,{children:"443"})," (HTTPS)."]}),"\n"]}),"\n",(0,r.jsxs)(n.ol,{start:"4",children:["\n",(0,r.jsx)(n.li,{children:"Use TLS Certificates (SSL)"}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Get a trusted TLS cert (e.g., from Let\u2019s Encrypt)."}),"\n",(0,r.jsx)(n.li,{children:"Keep certificates updated & rotated."}),"\n"]}),"\n",(0,r.jsxs)(n.ol,{start:"5",children:["\n",(0,r.jsx)(n.li,{children:"Validate Certificates"}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Clients should reject self-signed or invalid certs unless explicitly trusted."}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"rest-api-over-https",children:"REST API over HTTPS"}),"\n",(0,r.jsx)(n.p,{children:"Insecure HTTP Request"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"GET http://api.example.com/user/profile\r\nAuthorization: Bearer abc123token\n"})}),"\n",(0,r.jsx)(n.p,{children:"Risk: The token is sent in plain text. Anyone sniffing the network (Wi-Fi hotspot, ISP, proxy) can steal it."}),"\n",(0,r.jsx)(n.p,{children:"Secure HTTPS Request"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"GET https://api.example.com/user/profile\r\nAuthorization: Bearer abc123token\n"})}),"\n",(0,r.jsx)(n.p,{children:"The request and token are encrypted with TLS."}),"\n",(0,r.jsx)(n.p,{children:"Even if intercepted, attackers cannot read or modify it."}),"\n",(0,r.jsx)(n.h2,{id:"cross-origin-resource-sharing",children:"Cross-Origin Resource Sharing"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"CORS is a browser security mechanism that controls how web applications (running in one origin/domain) can request resources from another origin."}),"\n",(0,r.jsx)(n.li,{children:"It prevents malicious websites from making unauthorized requests to your REST API on behalf of a user."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Origin = combination of:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-nginx",children:"scheme + domain + port\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"https://app.example.com"})," \u2192 origin"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"https://api.example.com"})," \u2192 different origin"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"By default, browsers block cross-origin requests for security. CORS defines rules for when to allow them."}),"\n",(0,r.jsx)(n.h3,{id:"why-cors-is-important-in-rest-apis",children:"Why CORS is Important in REST APIs"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"REST APIs are often consumed by frontend apps hosted on different domains."}),"\n",(0,r.jsxs)(n.li,{children:["Example:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Frontend app \u2192 ",(0,r.jsx)(n.code,{children:"https://myapp.com"})]}),"\n",(0,r.jsxs)(n.li,{children:["Backend API \u2192 ",(0,r.jsx)(n.code,{children:"https://api.myapp.com"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:"Without CORS \u2192 browser blocks API calls."}),"\n",(0,r.jsx)(n.li,{children:"With properly configured CORS \u2192 only trusted domains can call the API."}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"how-cors-works",children:"How CORS Works"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Simple Request (e.g., GET with standard headers):"}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Browser sends request directly with an ",(0,r.jsx)(n.code,{children:"Origin"})," header."]}),"\n",(0,r.jsxs)(n.li,{children:["Server responds with ",(0,r.jsx)(n.code,{children:"Access-Control-Allow-Origin"})," header if allowed."]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"GET /user/profile HTTP/1.1\r\nHost: api.example.com\r\nOrigin: https://myapp.com\n"})}),"\n",(0,r.jsx)(n.p,{children:"Response:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'HTTP/1.1 200 OK\r\nAccess-Control-Allow-Origin: https://myapp.com\r\nContent-Type: application/json\r\n\r\n{ "username": "masum", "email": "masum@example.com" }\n'})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsx)(n.li,{children:"Preflight Request (for non-simple requests, e.g., POST with custom headers):"}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Browser sends an OPTIONS request first."}),"\n",(0,r.jsx)(n.li,{children:"Server replies with allowed methods, headers, origins."}),"\n",(0,r.jsx)(n.li,{children:"If valid \u2192 browser sends the actual request."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Example (Preflight request):"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"OPTIONS /user/profile HTTP/1.1\r\nHost: api.example.com\r\nOrigin: https://myapp.com\r\nAccess-Control-Request-Method: POST\r\nAccess-Control-Request-Headers: Content-Type, Authorization\n"})}),"\n",(0,r.jsx)(n.p,{children:"Response:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"HTTP/1.1 204 No Content\r\nAccess-Control-Allow-Origin: https://myapp.com\r\nAccess-Control-Allow-Methods: GET, POST, PUT, DELETE\r\nAccess-Control-Allow-Headers: Content-Type, Authorization\r\nAccess-Control-Allow-Credentials: true\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Then the browser proceeds with the real ",(0,r.jsx)(n.code,{children:"POST"})," request."]}),"\n",(0,r.jsx)(n.h3,{id:"cors-headers-explained",children:"CORS Headers Explained"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Access-Control-Allow-Origin \u2192 which domains are allowed (e.g., ",(0,r.jsx)(n.code,{children:"https://myapp.com"})," or ",(0,r.jsx)(n.code,{children:"*"}),")."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Access-Control-Allow-Methods \u2192 allowed HTTP methods (",(0,r.jsx)(n.code,{children:"GET"}),", ",(0,r.jsx)(n.code,{children:"POST"}),", ",(0,r.jsx)(n.code,{children:"PUT"}),", ",(0,r.jsx)(n.code,{children:"DELETE"}),")."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Access-Control-Allow-Headers \u2192 allowed request headers (",(0,r.jsx)(n.code,{children:"Authorization"}),", ",(0,r.jsx)(n.code,{children:"Content-Type"}),")."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Access-Control-Allow-Credentials \u2192 whether cookies/auth headers are allowed (",(0,r.jsx)(n.code,{children:"true"}),"/",(0,r.jsx)(n.code,{children:"false"}),")."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Access-Control-Max-Age \u2192 how long preflight results are cached (in seconds)."}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"cors-in-rest-api",children:"CORS in REST API"}),"\n",(0,r.jsxs)(n.p,{children:["Suppose your API is at ",(0,r.jsx)(n.code,{children:"https://api.example.com"})," and frontend at ",(0,r.jsx)(n.code,{children:"https://app.example.com"}),"."]}),"\n",(0,r.jsx)(n.p,{children:"Correct CORS Response"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"HTTP/1.1 200 OK\r\nAccess-Control-Allow-Origin: https://app.example.com\r\nAccess-Control-Allow-Methods: GET, POST, PUT, DELETE\r\nAccess-Control-Allow-Headers: Content-Type, Authorization\r\nAccess-Control-Allow-Credentials: true\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Only requests from ",(0,r.jsx)(n.code,{children:"https://app.example.com"})," are allowed."]}),"\n",(0,r.jsx)(n.li,{children:"API allows specific methods & headers."}),"\n",(0,r.jsxs)(n.li,{children:["Cookies or JWT tokens can be sent with ",(0,r.jsx)(n.code,{children:"withCredentials = true"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"best-practices-for-cors-in-rest-apis",children:"Best Practices for CORS in REST APIs"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Never use ",(0,r.jsx)(n.code,{children:"*"})," for ",(0,r.jsx)(n.code,{children:"Access-Control-Allow-Origin"})," if your API requires authentication."]}),"\n",(0,r.jsx)(n.li,{children:"Restrict allowed methods"}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Only expose what\u2019s necessary (",(0,r.jsx)(n.code,{children:"GET"}),", ",(0,r.jsx)(n.code,{children:"POST"}),")."]}),"\n"]}),"\n",(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsx)(n.li,{children:"Restrict allowed headers"}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Avoid letting clients send arbitrary headers."}),"\n"]}),"\n",(0,r.jsxs)(n.ol,{start:"4",children:["\n",(0,r.jsx)(n.li,{children:"Enable credentials only when needed"}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Access-Control-Allow-Credentials"}),": true \u2192 only for trusted apps."]}),"\n"]}),"\n",(0,r.jsxs)(n.ol,{start:"5",children:["\n",(0,r.jsx)(n.li,{children:"Use short max-age for sensitive APIs"}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Prevents browsers from caching bad CORS rules too long."}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"rate-limiting",children:"Rate Limiting"}),"\n",(0,r.jsx)(n.p,{children:"Rate limiting is the process of restricting the number of requests a client can make to an API within a specific timeframe."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Prevents DoS/DDoS attacks (attackers flooding API with requests)."}),"\n",(0,r.jsx)(n.li,{children:"Prevents brute force attacks (guessing passwords or tokens)."}),"\n",(0,r.jsx)(n.li,{children:"Ensures fair usage so one client doesn\u2019t overload the system."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Example:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Limit each client to 100 requests per minute."}),"\n",(0,r.jsxs)(n.li,{children:["If a client exceeds \u2192 return ",(0,r.jsx)(n.code,{children:"429 Too Many Requests"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"example-of-rate-limiting",children:"Example of Rate Limiting"}),"\n",(0,r.jsx)(n.p,{children:"API allows max 5 requests per minute per user."}),"\n",(0,r.jsx)(n.p,{children:"Request (6th request within 1 minute)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"GET /user/profile HTTP/1.1\r\nAuthorization: Bearer eyJhbGciOiJIUzI1NiIs...\n"})}),"\n",(0,r.jsx)(n.p,{children:"Response"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'HTTP/1.1 429 Too Many Requests\r\nRetry-After: 30\r\nContent-Type: application/json\r\n\r\n{\r\n  "error": "Rate limit exceeded. Try again in 30 seconds."\r\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"Retry-After: 30"})," \u2192 tells client how long to wait before retrying."]}),"\n",(0,r.jsx)(n.h3,{id:"common-rate-limiting-strategies",children:"Common Rate Limiting Strategies"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Fixed Window"}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Example: 100 requests per minute."}),"\n",(0,r.jsx)(n.li,{children:"Simple but can cause bursts at window edges."}),"\n"]}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsx)(n.li,{children:"Sliding Window / Rolling Window"}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Tracks requests over the last N seconds."}),"\n",(0,r.jsx)(n.li,{children:"Smoother enforcement."}),"\n"]}),"\n",(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsx)(n.li,{children:"Token Bucket (most popular)"}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:'Each client has a "bucket" of tokens (e.g., 10 tokens).'}),"\n",(0,r.jsx)(n.li,{children:"Each request consumes a token."}),"\n",(0,r.jsx)(n.li,{children:"Tokens refill at a fixed rate."}),"\n"]}),"\n",(0,r.jsxs)(n.ol,{start:"4",children:["\n",(0,r.jsx)(n.li,{children:"Leaky Bucket"}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Similar to token bucket but enforces steady outflow (good for throttling)."}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"best-practices-of-rate-limiting",children:"Best Practices of Rate Limiting"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Different limits for different endpoints","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Example: ",(0,r.jsx)(n.code,{children:"/login"})," (lower limit) vs ",(0,r.jsx)(n.code,{children:"/posts"})," (higher)."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:"Different limits per user / API key / IP"}),"\n",(0,r.jsxs)(n.li,{children:["Send helpful headers","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"X-RateLimit-Limit"})," \u2192 max allowed"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"X-RateLimit-Remaining"})," \u2192 remaining requests"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"X-RateLimit-Reset"})," \u2192 reset time"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"X-RateLimit-Limit: 100\r\nX-RateLimit-Remaining: 5\r\nX-RateLimit-Reset: 1694200320\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Use caching layer (Redis, Memcached) for fast counting."}),"\n",(0,r.jsx)(n.li,{children:"Combine with monitoring to detect abuse."}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"throttling",children:"Throttling"}),"\n",(0,r.jsx)(n.p,{children:"Throttling is slowing down or delaying requests when clients exceed certain thresholds."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Instead of outright blocking, the API may:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Queue requests."}),"\n",(0,r.jsx)(n.li,{children:"Allow fewer requests per second."}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:"Ensures system stays responsive under heavy load."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Example:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"API allows 10 requests per second."}),"\n",(0,r.jsx)(n.li,{children:"If a client sends 20, extra requests are delayed (processed later)."}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"example-of-throttling",children:"Example of Throttling"}),"\n",(0,r.jsx)(n.p,{children:"Scenario: API allows max 10 requests per second."}),"\n",(0,r.jsx)(n.p,{children:"If a client sends 15 requests:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"First 10 are processed immediately."}),"\n",(0,r.jsx)(n.li,{children:"Next 5 are delayed and spread out over time."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Client won\u2019t see errors, but responses arrive slower."}),"\n",(0,r.jsx)(n.h3,{id:"rate-limiting-vs-throttling",children:"Rate Limiting vs Throttling"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Feature"}),(0,r.jsx)(n.th,{children:"Rate Limiting \ud83d\udea6"}),(0,r.jsx)(n.th,{children:"Throttling \ud83d\udd52"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Purpose"}),(0,r.jsx)(n.td,{children:"Restrict maximum requests"}),(0,r.jsx)(n.td,{children:"Slow down requests"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Behavior"}),(0,r.jsx)(n.td,{children:"Block when limit exceeded"}),(0,r.jsx)(n.td,{children:"Delay or spread requests"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Example"}),(0,r.jsx)(n.td,{children:"100 requests/minute max"}),(0,r.jsx)(n.td,{children:"10 requests/sec, others queued"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Error Code"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"429 Too Many Requests"})}),(0,r.jsxs)(n.td,{children:["Usually still ",(0,r.jsx)(n.code,{children:"200"})," (delayed)"]})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"avoiding-common-vulnerabilities",children:"Avoiding common vulnerabilities"}),"\n",(0,r.jsx)(n.h3,{id:"sql-injection",children:"SQL Injection"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"SQL Injection happens when untrusted input is concatenated into a database query."}),"\n",(0,r.jsx)(n.li,{children:"Attackers can manipulate queries to read, modify, or delete data."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Vulnerable Example"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-py",children:'# Python pseudo-code\r\nusername = request.GET["username"]\r\nquery = f"SELECT * FROM users WHERE username = \'{username}\'"\r\ncursor.execute(query)\r\n# Python pseudo-code\r\nusername = request.GET["username"]\r\nquery = f"SELECT * FROM users WHERE username = \'{username}\'"\r\ncursor.execute(query)\n'})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["If attacker sends: ",(0,r.jsx)(n.code,{children:"username=admin' OR '1'='1"})]}),"\n",(0,r.jsxs)(n.li,{children:["Generated query: ",(0,r.jsx)(n.code,{children:"SELECT * FROM users WHERE username = 'admin' OR '1'='1';"})," Returns all users instead of just one."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Prevention"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Use Parameterized Queries / Prepared Statements: ",(0,r.jsx)(n.code,{children:'cursor.execute("SELECT * FROM users WHERE username = %s", (username,))'})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Use ORM frameworks (like Django ORM, Hibernate, SQLAlchemy)."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Validate and sanitize input (ensure type: string, int, etc.)."}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"cross-site-scripting",children:"Cross-Site Scripting"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"XSS occurs when malicious JavaScript is injected into your API\u2019s response."}),"\n",(0,r.jsx)(n.li,{children:"If your REST API is consumed by a frontend (like React, Angular), stored XSS can allow attackers to steal cookies, tokens, or session info."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Vulnerable Example"})}),"\n",(0,r.jsx)(n.p,{children:"API returns unescaped user input:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\r\n  "comment": "<script>alert(\'Hacked!\')<\/script>"\r\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"Browser frontend might render this as executable script \u2192 attacker code runs."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Prevention"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Escape or sanitize output before sending to clients."}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Use libraries like DOMPurify (JS), OWASP ESAPI (Java)."}),"\n"]}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsx)(n.li,{children:"Return only JSON, never raw HTML from REST APIs."}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{ "comment": "&lt;script&gt;alert(\'Hacked!\')&lt;/script&gt;" }\n'})}),"\n",(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsx)(n.li,{children:"Set correct headers"}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"Content-Type: application/json"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"X-Content-Type-Options: nosniff"})}),"\n"]}),"\n",(0,r.jsxs)(n.ol,{start:"4",children:["\n",(0,r.jsx)(n.li,{children:"Implement CSP (Content Security Policy) on frontend."}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"cross-site-request-forgery",children:"Cross-Site Request Forgery"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"CSRF tricks a logged-in user\u2019s browser into making an unintended request to your API."}),"\n",(0,r.jsx)(n.li,{children:"Example: If user is logged into a banking app, an attacker could trick them into transferring money using a malicious webpage."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Vulnerable Example"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["User is logged in to ",(0,r.jsx)(n.code,{children:"bank.com"})]}),"\n",(0,r.jsx)(n.li,{children:"Attacker hosts a page with:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",children:'<form action="https://bank.com/api/transfer" method="POST">\r\n  <input type="hidden" name="amount" value="1000" />\r\n  <input type="hidden" name="toAccount" value="attacker123" />\r\n</form>\r\n<script>\r\n  document.forms[0].submit();\r\n<\/script>\n'})}),"\n",(0,r.jsx)(n.p,{children:"User unknowingly sends money while visiting attacker\u2019s site."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Prevention"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Use anti-CSRF tokens"}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Include random token in forms/requests."}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{ "csrf_token": "abc123xyz" }\n'})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsx)(n.li,{children:"Use SameSite cookies"}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"Set-Cookie: session=abc123; SameSite=Strict; Secure"})}),"\n",(0,r.jsx)(n.li,{children:"Prevents cookies from being sent in cross-site requests."}),"\n"]}),"\n",(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Require re-authentication for critical actions (e.g., money transfer)."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Use JWT in headers instead of cookies for stateless APIs (but still ensure proper CORS rules)."}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"api-gateway-usage",children:"API Gateway usage"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"An API Gateway is a single entry point for all client requests to your REST APIs."}),"\n",(0,r.jsx)(n.li,{children:"Instead of clients calling services directly, they go through the gateway."}),"\n",(0,r.jsx)(n.li,{children:"The gateway then routes, filters, or modifies the requests before sending them to backend microservices."}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"why-use-an-api-gateway-for-security",children:"Why Use an API Gateway for Security?"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Centralized authentication & authorization"}),"\n",(0,r.jsx)(n.li,{children:"Rate limiting & throttling"}),"\n",(0,r.jsx)(n.li,{children:"Logging & monitoring (audit trails)"}),"\n",(0,r.jsx)(n.li,{children:"CORS & HTTPS enforcement"}),"\n",(0,r.jsx)(n.li,{children:"Input validation & threat protection (e.g., blocking SQLi, XSS patterns)"}),"\n",(0,r.jsx)(n.li,{children:"Acts as a firewall for APIs (protects backend services from direct exposure)"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"how-an-api-gateway-works-flow",children:"How an API Gateway Works (Flow)"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Client makes request to ",(0,r.jsx)(n.code,{children:"https://api.example.com"})]}),"\n",(0,r.jsx)(n.li,{children:"API Gateway intercepts request \u2192 applies policies (auth, rate limit, CORS, etc.)"}),"\n",(0,r.jsxs)(n.li,{children:["If valid \u2192 forwards to backend service (e.g., ",(0,r.jsx)(n.code,{children:"user-service"}),", ",(0,r.jsx)(n.code,{children:"payment-service"}),")"]}),"\n",(0,r.jsx)(n.li,{children:"Collects response and returns it to client"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"key-security-features-of-api-gateway",children:"Key Security Features of API Gateway"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Authentication & Authorization"}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Gateway can check API keys, JWT tokens, OAuth 2.0 tokens before forwarding requests."}),"\n",(0,r.jsx)(n.li,{children:"Example: If a request lacks a valid token \u2192 rejected at gateway (never reaches backend)."}),"\n"]}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsx)(n.li,{children:"Rate Limiting & Throttling"}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Prevents abuse and DDoS attacks."}),"\n",(0,r.jsxs)(n.li,{children:["Example: Limit ",(0,r.jsx)(n.code,{children:"100 requests/minute"})," per user."]}),"\n"]}),"\n",(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsx)(n.li,{children:"Data Protection (HTTPS Everywhere)"}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Gateway enforces TLS/SSL."}),"\n",(0,r.jsx)(n.li,{children:"Backend services can remain private (internal network only)."}),"\n"]}),"\n",(0,r.jsxs)(n.ol,{start:"4",children:["\n",(0,r.jsx)(n.li,{children:"Input Validation / Threat Protection"}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Blocks requests with malicious payloads (SQL injection, XSS, etc.)."}),"\n",(0,r.jsx)(n.li,{children:"Example: API Gateway WAF (Web Application Firewall) integration."}),"\n"]}),"\n",(0,r.jsxs)(n.ol,{start:"5",children:["\n",(0,r.jsx)(n.li,{children:"CORS Handling"}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Centralized CORS configuration instead of every microservice handling it."}),"\n"]}),"\n",(0,r.jsxs)(n.ol,{start:"6",children:["\n",(0,r.jsx)(n.li,{children:"Logging & Monitoring"}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Logs all requests/responses."}),"\n",(0,r.jsx)(n.li,{children:"Helps detect anomalies (e.g., brute force attempts)."}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"example-scenario-with-api-gateway",children:"Example Scenario with API Gateway"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Frontend app \u2192 ",(0,r.jsx)(n.code,{children:"https://app.example.com"})]}),"\n",(0,r.jsxs)(n.li,{children:["API Gateway \u2192 ",(0,r.jsx)(n.code,{children:"https://api.example.com"})]}),"\n",(0,r.jsxs)(n.li,{children:["Backend services (internal):","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"user-service.local"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"payment-service.local"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Request Flow"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"GET /users/profile HTTP/1.1\r\nHost: api.example.com\r\nAuthorization: Bearer eyJhbGciOiJIUzI1NiIs...\n"})}),"\n",(0,r.jsx)(n.p,{children:"Gateway Actions"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Check authentication \u2192 validate JWT."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Check rate limit \u2192 ensure client hasn\u2019t exceeded quota."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Check CORS policy \u2192 ensure request origin is allowed."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Forward request \u2192 ",(0,r.jsx)(n.code,{children:"user-service.local/api/profile"}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Response from Gateway"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'HTTP/1.1 200 OK\r\nContent-Type: application/json\r\n\r\n{ "id": 101, "username": "masum", "email": "masum@example.com" }\n'})}),"\n",(0,r.jsx)(n.p,{children:"If client exceeded limit:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'HTTP/1.1 429 Too Many Requests\r\nRetry-After: 60\r\nContent-Type: application/json\r\n\r\n{ "error": "Rate limit exceeded. Try again later." }\n'})})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);