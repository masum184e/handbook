"use strict";(globalThis.webpackChunkhandbook=globalThis.webpackChunkhandbook||[]).push([[38125],{17585(n,e,i){i.r(e),i.d(e,{assets:()=>t,contentTitle:()=>a,default:()=>h,frontMatter:()=>c,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"rust/Error Handling.md/Panic","title":"Panic","description":"panic! is a macro that immediately stops normal program execution when something goes seriously wrong. It\u2019s used for unrecoverable errors\u2014situations where the program cannot safely continue.","source":"@site/docs/rust/12. Error Handling.md/1. Panic.md","sourceDirName":"rust/12. Error Handling.md","slug":"/rust/Error Handling.md/Panic","permalink":"/handbook/docs/rust/Error Handling.md/Panic","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{}}');var s=i(74848),l=i(28453);const c={},a=void 0,t={},d=[{value:"How Rust handles a panic",id:"how-rust-handles-a-panic",level:2},{value:"Example 1: Simple panic!",id:"example-1-simple-panic",level:2},{value:"Example 2: Panic from an invalid operation",id:"example-2-panic-from-an-invalid-operation",level:2},{value:"Example 3: Using unwrap() (which may panic)",id:"example-3-using-unwrap-which-may-panic",level:2},{value:"Example 4: Custom panic with context",id:"example-4-custom-panic-with-context",level:2},{value:"<code>panic!</code> vs <code>Result</code>",id:"panic-vs-result",level:2},{value:"Example using <code>Result</code> instead of <code>panic!</code>:",id:"example-using-result-instead-of-panic",level:3},{value:"Catching a panic (advanced)",id:"catching-a-panic-advanced",level:2},{value:"Summary",id:"summary",level:2}];function o(n){const e={code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.code,{children:"panic!"})," is a macro that immediately stops normal program execution when something goes seriously wrong. It\u2019s used for unrecoverable errors\u2014situations where the program cannot safely continue."]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-rust",children:'panic!("Something went terribly wrong!");\n'})}),"\n",(0,s.jsx)(e.p,{children:"When this runs, Rust:"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsx)(e.li,{children:"Prints an error message."}),"\n",(0,s.jsx)(e.li,{children:"Shows a stack trace (if enabled)."}),"\n",(0,s.jsx)(e.li,{children:"Terminates the program (or unwinds the stack)."}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsxs)(e.strong,{children:["When should you use ",(0,s.jsx)(e.code,{children:"panic!"}),"?"]})}),"\n",(0,s.jsxs)(e.p,{children:["Use ",(0,s.jsx)(e.code,{children:"panic!"})," when:"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"A bug has occurred."}),"\n",(0,s.jsx)(e.li,{children:"An assumption in your code is violated."}),"\n",(0,s.jsx)(e.li,{children:"Continuing would cause incorrect behavior or data corruption."}),"\n"]}),"\n",(0,s.jsxs)(e.p,{children:["Do not use ",(0,s.jsx)(e.code,{children:"panic!"})," for expected errors like invalid user input or file-not-found\u2014those should use ",(0,s.jsx)(e.code,{children:"Result"}),"."]}),"\n",(0,s.jsx)(e.h2,{id:"how-rust-handles-a-panic",children:"How Rust handles a panic"}),"\n",(0,s.jsx)(e.p,{children:"Rust can handle panics in two ways (controlled by build settings):"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:["Unwinding (default)","\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Rust walks back through the stack and runs destructors."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["Aborting","\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Program stops immediately (faster, no cleanup)."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"example-1-simple-panic",children:"Example 1: Simple panic!"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-rust",children:'fn main() {\r\n    panic!("Crash and burn!");\r\n}\n'})}),"\n",(0,s.jsx)(e.p,{children:"Output (simplified):"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"thread 'main' panicked at 'Crash and burn!', src/main.rs:2:5\n"})}),"\n",(0,s.jsx)(e.p,{children:"The program stops immediately."}),"\n",(0,s.jsx)(e.h2,{id:"example-2-panic-from-an-invalid-operation",children:"Example 2: Panic from an invalid operation"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-rust",children:'fn main() {\r\n    let v = vec![1, 2, 3];\r\n    println!("{}", v[99]); // Out of bounds \u2192 panic!\r\n}\n'})}),"\n",(0,s.jsx)(e.p,{children:"Why this panics:"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Rust checks array bounds at runtime."}),"\n",(0,s.jsxs)(e.li,{children:["Accessing index ",(0,s.jsx)(e.code,{children:"99"})," is invalid \u2192 Rust calls ",(0,s.jsx)(e.code,{children:"panic!"})," internally."]}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"example-3-using-unwrap-which-may-panic",children:"Example 3: Using unwrap() (which may panic)"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-rust",children:'fn main() {\r\n    let number: Option<i32> = None;\r\n    let value = number.unwrap(); // panic!\r\n    println!("{}", value);\r\n}\n'})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"unwrap()"})," extracts the value if it exists."]}),"\n",(0,s.jsxs)(e.li,{children:["If the value is ",(0,s.jsx)(e.code,{children:"None"}),", it calls ",(0,s.jsx)(e.code,{children:"panic!"}),"."]}),"\n",(0,s.jsx)(e.li,{children:"This is convenient for quick prototypes but risky in production code."}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"example-4-custom-panic-with-context",children:"Example 4: Custom panic with context"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-rust",children:'fn divide(a: i32, b: i32) -> i32 {\r\n    if b == 0 {\r\n        panic!("Cannot divide by zero!");\r\n    }\r\n    a / b\r\n}\r\n\r\nfn main() {\r\n    let result = divide(10, 0);\r\n    println!("{}", result);\r\n}\n'})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Division by zero is an unrecoverable logic error here."}),"\n",(0,s.jsx)(e.li,{children:"We explicitly panic with a helpful message."}),"\n"]}),"\n",(0,s.jsxs)(e.h2,{id:"panic-vs-result",children:[(0,s.jsx)(e.code,{children:"panic!"})," vs ",(0,s.jsx)(e.code,{children:"Result"})]}),"\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsxs)(e.th,{children:["Use ",(0,s.jsx)(e.code,{children:"panic!"})," when..."]}),(0,s.jsxs)(e.th,{children:["Use ",(0,s.jsx)(e.code,{children:"Result"})," when..."]})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"Bug in the code"}),(0,s.jsx)(e.td,{children:"User input error"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"Impossible state"}),(0,s.jsx)(e.td,{children:"File not found"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"Program cannot continue safely"}),(0,s.jsx)(e.td,{children:"Network failure"})]})]})]}),"\n",(0,s.jsxs)(e.h3,{id:"example-using-result-instead-of-panic",children:["Example using ",(0,s.jsx)(e.code,{children:"Result"})," instead of ",(0,s.jsx)(e.code,{children:"panic!"}),":"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-rust",children:'fn divide(a: i32, b: i32) -> Result<i32, String> {\r\n    if b == 0 {\r\n        Err("Cannot divide by zero".to_string())\r\n    } else {\r\n        Ok(a / b)\r\n    }\r\n}\r\n\r\nfn main() {\r\n    match divide(10, 0) {\r\n        Ok(result) => println!("Result: {}", result),\r\n        Err(e) => println!("Error: {}", e),\r\n    }\r\n}\n'})}),"\n",(0,s.jsx)(e.p,{children:"This allows the program to continue safely."}),"\n",(0,s.jsx)(e.h2,{id:"catching-a-panic-advanced",children:"Catching a panic (advanced)"}),"\n",(0,s.jsxs)(e.p,{children:["You can catch panics using ",(0,s.jsx)(e.code,{children:"std::panic::catch_unwind"}),", but this is usually for:"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Testing"}),"\n",(0,s.jsx)(e.li,{children:"FFI boundaries"}),"\n",(0,s.jsx)(e.li,{children:"Highly robust systems"}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-rust",children:'use std::panic;\r\n\r\nfn main() {\r\n    let result = panic::catch_unwind(|| {\r\n        panic!("This will be caught!");\r\n    });\r\n\r\n    match result {\r\n        Ok(_) => println!("No panic."),\r\n        Err(_) => println!("Panic was caught!"),\r\n    }\r\n}\n'})}),"\n",(0,s.jsx)(e.h2,{id:"summary",children:"Summary"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"panic!"})," is for unrecoverable errors."]}),"\n",(0,s.jsx)(e.li,{children:"It stops execution immediately."}),"\n",(0,s.jsxs)(e.li,{children:["Common sources: ",(0,s.jsx)(e.code,{children:"unwrap()"}),", array out-of-bounds, explicit ",(0,s.jsx)(e.code,{children:"panic!"}),"."]}),"\n",(0,s.jsxs)(e.li,{children:["Prefer ",(0,s.jsx)(e.code,{children:"Result"})," for recoverable errors."]}),"\n",(0,s.jsxs)(e.li,{children:["Use ",(0,s.jsx)(e.code,{children:"panic!"})," to signal bugs, not user mistakes."]}),"\n"]})]})}function h(n={}){const{wrapper:e}={...(0,l.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(o,{...n})}):o(n)}},28453(n,e,i){i.d(e,{R:()=>c,x:()=>a});var r=i(96540);const s={},l=r.createContext(s);function c(n){const e=r.useContext(l);return r.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:c(n.components),r.createElement(l.Provider,{value:e},n.children)}}}]);