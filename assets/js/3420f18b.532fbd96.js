"use strict";(globalThis.webpackChunkhandbook=globalThis.webpackChunkhandbook||[]).push([[15209],{28453(e,i,n){n.d(i,{R:()=>c,x:()=>t});var s=n(96540);const r={},l=s.createContext(r);function c(e){const i=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function t(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),s.createElement(l.Provider,{value:i},e.children)}},66843(e,i,n){n.r(i),n.d(i,{assets:()=>d,contentTitle:()=>t,default:()=>h,frontMatter:()=>c,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"rust/Project Structure/Visibility","title":"Visibility","description":"Visibility controls who is allowed to access what.","source":"@site/docs/rust/13. Project Structure/4. Visibility.md","sourceDirName":"rust/13. Project Structure","slug":"/rust/Project Structure/Visibility","permalink":"/handbook/docs/rust/Project Structure/Visibility","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":4,"frontMatter":{}}');var r=n(74848),l=n(28453);const c={},t=void 0,d={},a=[{value:"The <code>pub</code> Keyword \u2013 What It Means",id:"the-pub-keyword--what-it-means",level:2},{value:"The Golden Rule of Visibility",id:"the-golden-rule-of-visibility",level:2},{value:"Private by Default (No <code>pub</code>)",id:"private-by-default-no-pub",level:2},{value:"Making Functions Public",id:"making-functions-public",level:2},{value:"Module Visibility (<code>pub mod</code>)",id:"module-visibility-pub-mod",level:2},{value:"Common mistake",id:"common-mistake",level:3},{value:"Correct version",id:"correct-version",level:3},{value:"Visibility Chains (Path Rule)",id:"visibility-chains-path-rule",level:2},{value:"Broken visibility chain",id:"broken-visibility-chain",level:3},{value:"Fixed",id:"fixed",level:3},{value:"Struct Visibility",id:"struct-visibility",level:2},{value:"Struct itself vs fields",id:"struct-itself-vs-fields",level:3},{value:"Enum Visibility",id:"enum-visibility",level:2},{value:"Method Visibility (<code>impl</code> blocks)",id:"method-visibility-impl-blocks",level:2},{value:"Visibility with <code>use</code>",id:"visibility-with-use",level:2},{value:"<code>pub(crate)</code> \u2013 Crate-Level Visibility",id:"pubcrate--crate-level-visibility",level:2},{value:"Other Visibility Modifiers",id:"other-visibility-modifiers",level:2},{value:"File-Based Example (Real Structure)",id:"file-based-example-real-structure",level:2},{value:"Re-exporting with <code>pub use</code>",id:"re-exporting-with-pub-use",level:2},{value:"Binary + Library Visibility Pattern",id:"binary--library-visibility-pattern",level:2},{value:"Why Rust Is So Strict About Visibility",id:"why-rust-is-so-strict-about-visibility",level:2}];function u(e){const i={blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.p,{children:"Visibility controls who is allowed to access what."}),"\n",(0,r.jsx)(i.p,{children:"Rust\u2019s philosophy:"}),"\n",(0,r.jsxs)(i.blockquote,{children:["\n",(0,r.jsx)(i.p,{children:"Everything is private by default."}),"\n"]}),"\n",(0,r.jsxs)(i.p,{children:["You must explicitly allow access using ",(0,r.jsx)(i.code,{children:"pub"}),"."]}),"\n",(0,r.jsx)(i.p,{children:"Visibility applies to:"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"modules"}),"\n",(0,r.jsx)(i.li,{children:"functions"}),"\n",(0,r.jsx)(i.li,{children:"structs"}),"\n",(0,r.jsx)(i.li,{children:"enums"}),"\n",(0,r.jsx)(i.li,{children:"fields"}),"\n",(0,r.jsx)(i.li,{children:"methods"}),"\n",(0,r.jsx)(i.li,{children:"constants"}),"\n",(0,r.jsx)(i.li,{children:"traits"}),"\n"]}),"\n",(0,r.jsxs)(i.h2,{id:"the-pub-keyword--what-it-means",children:["The ",(0,r.jsx)(i.code,{children:"pub"})," Keyword \u2013 What It Means"]}),"\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.code,{children:"pub"})," means:"]}),"\n",(0,r.jsxs)(i.blockquote,{children:["\n",(0,r.jsx)(i.p,{children:"\u201cThis item can be accessed from outside the current module.\u201d"}),"\n"]}),"\n",(0,r.jsxs)(i.p,{children:["But ",(0,r.jsx)(i.code,{children:"pub"})," does NOT mean globally accessible."]}),"\n",(0,r.jsx)(i.p,{children:"Visibility is still constrained by:"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"module hierarchy"}),"\n",(0,r.jsx)(i.li,{children:"crate boundaries"}),"\n"]}),"\n",(0,r.jsx)(i.h2,{id:"the-golden-rule-of-visibility",children:"The Golden Rule of Visibility"}),"\n",(0,r.jsxs)(i.blockquote,{children:["\n",(0,r.jsx)(i.p,{children:"You can only access an item if every module in the path is visible."}),"\n"]}),"\n",(0,r.jsx)(i.p,{children:"This is the most important rule to remember."}),"\n",(0,r.jsxs)(i.h2,{id:"private-by-default-no-pub",children:["Private by Default (No ",(0,r.jsx)(i.code,{children:"pub"}),")"]}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-rust",children:'mod secrets {\r\n    fn hidden() {\r\n        println!("Top secret");\r\n    }\r\n}\r\n\r\nfn main() {\r\n    // secrets::hidden(); \u274c error\r\n}\n'})}),"\n",(0,r.jsx)(i.p,{children:"Why?"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.code,{children:"hidden()"})," is private"]}),"\n",(0,r.jsxs)(i.li,{children:["Only accessible inside ",(0,r.jsx)(i.code,{children:"secrets"})]}),"\n"]}),"\n",(0,r.jsx)(i.h2,{id:"making-functions-public",children:"Making Functions Public"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-rust",children:'mod secrets {\r\n    pub fn reveal() {\r\n        println!("Not so secret");\r\n    }\r\n}\r\n\r\nfn main() {\r\n    secrets::reveal(); // \u2705\r\n}\n'})}),"\n",(0,r.jsxs)(i.h2,{id:"module-visibility-pub-mod",children:["Module Visibility (",(0,r.jsx)(i.code,{children:"pub mod"}),")"]}),"\n",(0,r.jsx)(i.p,{children:"Modules themselves must also be public."}),"\n",(0,r.jsx)(i.h3,{id:"common-mistake",children:"Common mistake"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-rust",children:"mod api {\r\n    pub fn call() {}\r\n}\r\n\r\nfn main() {\r\n    // api::call(); \u274c api is private\r\n}\n"})}),"\n",(0,r.jsx)(i.h3,{id:"correct-version",children:"Correct version"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-rust",children:"pub mod api {\r\n    pub fn call() {}\r\n}\r\n\r\nfn main() {\r\n    api::call(); // \u2705\r\n}\n"})}),"\n",(0,r.jsx)(i.h2,{id:"visibility-chains-path-rule",children:"Visibility Chains (Path Rule)"}),"\n",(0,r.jsx)(i.h3,{id:"broken-visibility-chain",children:"Broken visibility chain"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-rust",children:"mod outer {\r\n    mod inner {\r\n        pub fn run() {}\r\n    }\r\n}\r\n\r\nfn main() {\r\n    // outer::inner::run(); \u274c\r\n}\n"})}),"\n",(0,r.jsx)(i.h3,{id:"fixed",children:"Fixed"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-rust",children:"pub mod outer {\r\n    pub mod inner {\r\n        pub fn run() {}\r\n    }\r\n}\r\n\r\nfn main() {\r\n    outer::inner::run(); // \u2705\r\n}\n"})}),"\n",(0,r.jsxs)(i.p,{children:["Every level in the path must be ",(0,r.jsx)(i.code,{children:"pub"})]}),"\n",(0,r.jsx)(i.h2,{id:"struct-visibility",children:"Struct Visibility"}),"\n",(0,r.jsx)(i.h3,{id:"struct-itself-vs-fields",children:"Struct itself vs fields"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-rust",children:"mod model {\r\n    pub struct User {\r\n        pub name: String,\r\n        age: u8,\r\n    }\r\n}\n"})}),"\n",(0,r.jsx)(i.p,{children:"What\u2019s accessible?"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-rust",children:'use model::User;\r\n\r\nfn main() {\r\n    let u = User {\r\n        name: "Alice".into(),\r\n        // age: 30 \u274c private field\r\n    };\r\n\r\n    println!("{}", u.name); // \u2705\r\n}\n'})}),"\n",(0,r.jsx)(i.p,{children:"Key rule"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.code,{children:"pub struct"})," \u2192 type is public"]}),"\n",(0,r.jsxs)(i.li,{children:["fields are private unless marked ",(0,r.jsx)(i.code,{children:"pub"})]}),"\n"]}),"\n",(0,r.jsx)(i.h2,{id:"enum-visibility",children:"Enum Visibility"}),"\n",(0,r.jsx)(i.p,{children:"Enums are simpler."}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-rust",children:"pub enum Status {\r\n    Active,\r\n    Inactive,\r\n}\n"})}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"All variants are automatically public"}),"\n",(0,r.jsxs)(i.li,{children:["No need to mark each variant ",(0,r.jsx)(i.code,{children:"pub"})]}),"\n"]}),"\n",(0,r.jsxs)(i.h2,{id:"method-visibility-impl-blocks",children:["Method Visibility (",(0,r.jsx)(i.code,{children:"impl"})," blocks)"]}),"\n",(0,r.jsx)(i.p,{children:"Methods follow the same rule."}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-rust",children:"pub struct Account {\r\n    balance: i32,\r\n}\r\n\r\nimpl Account {\r\n    pub fn new() -> Self {\r\n        Self { balance: 0 }\r\n    }\r\n\r\n    fn secret_reset(&mut self) {\r\n        self.balance = 0;\r\n    }\r\n}\n"})}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.code,{children:"new()"})," \u2192 public API"]}),"\n",(0,r.jsxs)(i.li,{children:[(0,r.jsx)(i.code,{children:"secret_reset()"})," \u2192 internal helper"]}),"\n"]}),"\n",(0,r.jsxs)(i.h2,{id:"visibility-with-use",children:["Visibility with ",(0,r.jsx)(i.code,{children:"use"})]}),"\n",(0,r.jsx)(i.p,{children:"use does not change visibility."}),"\n",(0,r.jsx)(i.p,{children:"Wrong assumption"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-rust",children:"mod hidden {\r\n    fn secret() {}\r\n}\r\n\r\nuse hidden::secret; // \u274c still private\n"})}),"\n",(0,r.jsx)(i.p,{children:"Must be public first"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-rust",children:"mod hidden {\r\n    pub fn secret() {}\r\n}\r\n\r\nuse hidden::secret; // \u2705\n"})}),"\n",(0,r.jsxs)(i.h2,{id:"pubcrate--crate-level-visibility",children:[(0,r.jsx)(i.code,{children:"pub(crate)"})," \u2013 Crate-Level Visibility"]}),"\n",(0,r.jsx)(i.p,{children:"Rust offers fine-grained visibility."}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-rust",children:"pub(crate) fn internal_only() {}\n"})}),"\n",(0,r.jsx)(i.p,{children:"Accessible:"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"anywhere inside the same crate"}),"\n",(0,r.jsx)(i.li,{children:"NOT from other crates"}),"\n"]}),"\n",(0,r.jsx)(i.h2,{id:"other-visibility-modifiers",children:"Other Visibility Modifiers"}),"\n",(0,r.jsxs)(i.table,{children:[(0,r.jsx)(i.thead,{children:(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.th,{children:"Modifier"}),(0,r.jsx)(i.th,{children:"Accessible From"})]})}),(0,r.jsxs)(i.tbody,{children:[(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"pub"})}),(0,r.jsx)(i.td,{children:"Everywhere"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"pub(crate)"})}),(0,r.jsx)(i.td,{children:"Same crate"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"pub(super)"})}),(0,r.jsx)(i.td,{children:"Parent module"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"pub(self)"})}),(0,r.jsx)(i.td,{children:"Same module only"})]})]})]}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-rust",children:"mod parent {\r\n    pub(super) fn call_parent() {}\r\n}\n"})}),"\n",(0,r.jsx)(i.h2,{id:"file-based-example-real-structure",children:"File-Based Example (Real Structure)"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{children:"src/\r\n \u251c\u2500\u2500 lib.rs\r\n \u2514\u2500\u2500 auth/\r\n      \u251c\u2500\u2500 mod.rs\r\n      \u2514\u2500\u2500 login.rs\n"})}),"\n",(0,r.jsx)(i.p,{children:(0,r.jsx)(i.code,{children:"lib.rs"})}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-rust",children:"pub mod auth;\n"})}),"\n",(0,r.jsx)(i.p,{children:(0,r.jsx)(i.code,{children:"auth/mod.rs"})}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-rust",children:"pub mod login;\n"})}),"\n",(0,r.jsx)(i.p,{children:(0,r.jsx)(i.code,{children:"auth/login.rs"})}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-rust",children:'pub fn login_user() {\r\n    println!("Logged in");\r\n}\r\n\r\nfn helper() {} // private\n'})}),"\n",(0,r.jsx)(i.p,{children:"External usage"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-rust",children:"use my_lib::auth::login::login_user;\n"})}),"\n",(0,r.jsxs)(i.h2,{id:"re-exporting-with-pub-use",children:["Re-exporting with ",(0,r.jsx)(i.code,{children:"pub use"})]}),"\n",(0,r.jsx)(i.p,{children:"This lets you control your public API."}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-rust",children:"mod internal {\r\n    pub struct User;\r\n}\r\n\r\npub use internal::User;\n"})}),"\n",(0,r.jsx)(i.p,{children:"Result"}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-rust",children:"use my_lib::User;\n"})}),"\n",(0,r.jsxs)(i.p,{children:["Users don\u2019t need to know about ",(0,r.jsx)(i.code,{children:"internal"})]}),"\n",(0,r.jsx)(i.h2,{id:"binary--library-visibility-pattern",children:"Binary + Library Visibility Pattern"}),"\n",(0,r.jsx)(i.p,{children:"Recommended design"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:["Library crate","\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"exposes pub APIs"}),"\n",(0,r.jsx)(i.li,{children:"hides internals"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(i.li,{children:["Binary crate","\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"uses the public API only"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-rust",children:"// lib.rs\r\nmod engine;\r\npub use engine::run;\n"})}),"\n",(0,r.jsx)(i.h2,{id:"why-rust-is-so-strict-about-visibility",children:"Why Rust Is So Strict About Visibility"}),"\n",(0,r.jsx)(i.p,{children:"Rust forces you to:"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsx)(i.li,{children:"design clean APIs"}),"\n",(0,r.jsx)(i.li,{children:"avoid accidental coupling"}),"\n",(0,r.jsx)(i.li,{children:"make internal changes safely"}),"\n",(0,r.jsx)(i.li,{children:"think in terms of boundaries"}),"\n"]}),"\n",(0,r.jsx)(i.p,{children:"This is a feature, not friction."})]})}function h(e={}){const{wrapper:i}={...(0,l.R)(),...e.components};return i?(0,r.jsx)(i,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}}}]);