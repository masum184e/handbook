"use strict";(globalThis.webpackChunkhandbook=globalThis.webpackChunkhandbook||[]).push([[68129],{28453(e,n,s){s.d(n,{R:()=>l,x:()=>t});var r=s(96540);const i={},d=r.createContext(i);function l(e){const n=r.useContext(d);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),r.createElement(d.Provider,{value:n},e.children)}},68775(e,n,s){s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>h,frontMatter:()=>l,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"mysql/Indexing","title":"Indexing","description":"An index in a database is like the index of a book \u2014 instead of reading the whole book to find a topic, you can go directly to the page numbers listed.","source":"@site/docs/mysql/11. Indexing.md","sourceDirName":"mysql","slug":"/mysql/Indexing","permalink":"/handbook/docs/mysql/Indexing","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":12,"frontMatter":{"sidebar_position":12},"sidebar":"mysqlSidebar","previous":{"title":"Advanced SQL Statements","permalink":"/handbook/docs/mysql/Advanced SQL Statements"},"next":{"title":"Stored Procedure","permalink":"/handbook/docs/mysql/Stored Procedure"}}');var i=s(74848),d=s(28453);const l={sidebar_position:12},t=void 0,c={},o=[{value:"How Indexes Work Internally",id:"how-indexes-work-internally",level:2},{value:"Types of Indexes",id:"types-of-indexes",level:2},{value:"Creating an Index",id:"creating-an-index",level:2},{value:"Covering Index",id:"covering-index",level:2},{value:"How Indexes Improve Performance",id:"how-indexes-improve-performance",level:2},{value:"Checking Index Usage",id:"checking-index-usage",level:2},{value:"Key Columns in <code>EXPLAIN</code> Output",id:"key-columns-in-explain-output",level:3},{value:"Important <code>type</code> Values (Query Efficiency)",id:"important-type-values-query-efficiency",level:3}];function a(e){const n={code:"code",em:"em",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"An index in a database is like the index of a book \u2014 instead of reading the whole book to find a topic, you can go directly to the page numbers listed."}),"\n",(0,i.jsxs)(n.p,{children:["An Index is a database object that improves the speed of data retrieval (",(0,i.jsx)(n.code,{children:"SELECT"})," queries) but can slow down ",(0,i.jsx)(n.code,{children:"INSERT"}),", ",(0,i.jsx)(n.code,{children:"UPDATE"}),", and ",(0,i.jsx)(n.code,{children:"DELETE"})," operations because indexes must also be updated."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Index columns that are frequently used in ",(0,i.jsx)(n.code,{children:"WHERE"}),", ",(0,i.jsx)(n.code,{children:"JOIN"}),", ",(0,i.jsx)(n.code,{children:"ORDER BY"}),", and ",(0,i.jsx)(n.code,{children:"GROUP BY"})," clauses."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"In SQL:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"An index is a data structure that stores pointers to rows in a table, organized to make lookups faster."}),"\n",(0,i.jsx)(n.li,{children:"Without an index, SQL must perform a full table scan (check every row)."}),"\n",(0,i.jsx)(n.li,{children:"With an index, SQL can jump directly to the matching rows."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Why Use Indexes?"})}),"\n",(0,i.jsx)(n.p,{children:"Indexes improve performance for:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Searching (",(0,i.jsx)(n.code,{children:"SELECT"})," queries with ",(0,i.jsx)(n.code,{children:"WHERE"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:["Sorting (",(0,i.jsx)(n.code,{children:"ORDER BY"}),")"]}),"\n",(0,i.jsx)(n.li,{children:"Joining multiple tables"}),"\n",(0,i.jsx)(n.li,{children:"Filtering data with conditions"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Always index primary keys and foreign keys. Create composite indexes carefully (leftmost rule)."}),"\n",(0,i.jsx)(n.h2,{id:"how-indexes-work-internally",children:"How Indexes Work Internally"}),"\n",(0,i.jsx)(n.p,{children:"Most relational databases (MySQL, PostgreSQL, SQL Server, Oracle) use a B-Tree or B+Tree structure for standard indexes:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"B-Tree structure keeps keys sorted."}),"\n",(0,i.jsxs)(n.li,{children:["When you search, it\u2019s logarithmic time (",(0,i.jsx)(n.code,{children:"O(log n)"}),"), not linear (",(0,i.jsx)(n.code,{children:"O(n)"}),")."]}),"\n",(0,i.jsxs)(n.li,{children:["Each node contains:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Key (indexed value)"}),"\n",(0,i.jsx)(n.li,{children:"Pointer to the actual row in the table (or to more index nodes)"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:"Databases navigate the tree like searching in a phone book."}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Example for an index on ",(0,i.jsx)(n.code,{children:"last_name"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"        [Brown]\r\n       /       \\\r\n   [Adams]   [Smith]\n"})}),"\n",(0,i.jsx)(n.p,{children:'If you search for "Jones", the DB quickly jumps into the right branch instead of scanning all rows.'}),"\n",(0,i.jsx)(n.h2,{id:"types-of-indexes",children:"Types of Indexes"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Index Type"}),(0,i.jsx)(n.th,{children:"Description"}),(0,i.jsx)(n.th,{children:"Example Use Case"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Single-column index"})}),(0,i.jsx)(n.td,{children:"Index on one column"}),(0,i.jsxs)(n.td,{children:["Searching by ",(0,i.jsx)(n.code,{children:"email"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Composite index"})}),(0,i.jsx)(n.td,{children:"Index on multiple columns"}),(0,i.jsxs)(n.td,{children:["Searching by ",(0,i.jsx)(n.code,{children:"(last_name, first_name)"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Unique index"})}),(0,i.jsx)(n.td,{children:"Ensures values are unique"}),(0,i.jsx)(n.td,{children:"Primary key, unique email"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Full-text index"})}),(0,i.jsx)(n.td,{children:"For text searching"}),(0,i.jsx)(n.td,{children:"Search in articles or descriptions"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Hash index"})}),(0,i.jsx)(n.td,{children:"Uses hash table for equality searches"}),(0,i.jsx)(n.td,{children:"Exact lookups (PostgreSQL, MySQL MEMORY table)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Clustered index"})}),(0,i.jsx)(n.td,{children:"Physically orders table data by the index"}),(0,i.jsx)(n.td,{children:"Primary key in SQL Server"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Non-clustered index"})}),(0,i.jsx)(n.td,{children:"Separate from table data, points to rows"}),(0,i.jsx)(n.td,{children:"Secondary indexes"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"creating-an-index",children:"Creating an Index"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Create a Table with Index"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE employees (\r\n    emp_id INT PRIMARY KEY,\r\n    name VARCHAR(100),\r\n    department VARCHAR(50),\r\n    salary DECIMAL(10,2),\r\n    INDEX (department),       -- normal index\r\n    UNIQUE INDEX (name)       -- unique index\r\n);\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"emp_id"})," \u2192 Primary Key index."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"department"})," \u2192 Regular index (useful for searching/filtering by department)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"name"})," \u2192 Unique index (prevents duplicate names)."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Add Index to Existing Table"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"-- Add a simple index\r\nCREATE INDEX idx_department ON employees(department);\r\n\r\n-- Add a multi-column index\r\nCREATE INDEX idx_dept_salary ON employees(department, salary);\r\n\r\n-- Add a unique index\r\nCREATE UNIQUE INDEX idx_name_unique ON employees(name);\n"})}),"\n",(0,i.jsx)(n.p,{children:"Now, a query like:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"SELECT * FROM employees WHERE department = 'IT';\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Will use ",(0,i.jsx)(n.code,{children:"idx_department"})," to find the row quickly."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Composite Index Example"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"CREATE INDEX idx_dept_salary ON employees(department, salary);\r\n\r\n-- Efficient use\r\nSELECT * FROM employees WHERE department = 'IT' AND salary > 50000;\r\n\r\n-- Also works (prefix)\r\nSELECT * FROM employees WHERE department = 'IT';\r\n\r\n-- \u274c Not efficient\r\nSELECT * FROM employees WHERE salary > 50000;\n"})}),"\n",(0,i.jsx)(n.p,{children:"MySQL can only use the leftmost column(s) of a composite index."}),"\n",(0,i.jsx)(n.h2,{id:"covering-index",children:"Covering Index"}),"\n",(0,i.jsx)(n.p,{children:"If an index contains all the columns needed by a query, MySQL does not even read the table \u2192 it uses only the index. This is called a covering index."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"CREATE INDEX idx_dept_salary_name ON employees(department, salary, name);\r\n\r\nSELECT name, salary FROM employees WHERE department = 'IT';\n"})}),"\n",(0,i.jsxs)(n.p,{children:["MySQL can get ",(0,i.jsx)(n.code,{children:"department"}),", ",(0,i.jsx)(n.code,{children:"salary"}),", and ",(0,i.jsx)(n.code,{children:"name"})," directly from the index \u2192 no table lookup."]}),"\n",(0,i.jsx)(n.h2,{id:"how-indexes-improve-performance",children:"How Indexes Improve Performance"}),"\n",(0,i.jsx)(n.p,{children:"Without index:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["DB scans all rows (",(0,i.jsx)(n.code,{children:"O(n)"})," complexity)."]}),"\n",(0,i.jsx)(n.li,{children:"Slower for large datasets."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"With index:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["DB uses B-Tree navigation (",(0,i.jsx)(n.code,{children:"O(log n)"})," complexity)."]}),"\n",(0,i.jsx)(n.li,{children:"Much faster for lookups, filtering, sorting, joins."}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Downsides of Indexes"}),"\r\nIndexes are not free:"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Storage cost \u2014 They take extra disk space."}),"\n",(0,i.jsx)(n.li,{children:"Write cost \u2014 Inserts, updates, and deletes become slower because the index must also be updated."}),"\n",(0,i.jsx)(n.li,{children:"Over-indexing \u2014 Too many indexes can harm performance."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"checking-index-usage",children:"Checking Index Usage"}),"\n",(0,i.jsx)(n.p,{children:"You can check if your query uses an index:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"EXPLAIN SELECT * FROM employees WHERE department = 'IT';\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Which tables are involved"}),"\n",(0,i.jsx)(n.li,{children:"The order in which tables are read"}),"\n",(0,i.jsx)(n.li,{children:"Whether indexes are used"}),"\n",(0,i.jsx)(n.li,{children:"How many rows MySQL expects to examine"}),"\n",(0,i.jsx)(n.li,{children:"The join type MySQL chooses"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"This helps you understand why a query is slow and how to optimize it."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"EXPLAIN ANALYZE"})," runs the query and shows actual execution time and rows scanned (not just estimates)."]}),"\n",(0,i.jsxs)(n.h3,{id:"key-columns-in-explain-output",children:["Key Columns in ",(0,i.jsx)(n.code,{children:"EXPLAIN"})," Output"]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Column"}),(0,i.jsx)(n.th,{children:"Meaning"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"id"})}),(0,i.jsx)(n.td,{children:"The query step/order of execution. Higher = later execution."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"select_type"})}),(0,i.jsx)(n.td,{children:"The type of query (SIMPLE, PRIMARY, SUBQUERY, etc.)."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"table"})}),(0,i.jsx)(n.td,{children:"The table being accessed."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"type"})}),(0,i.jsxs)(n.td,{children:["The ",(0,i.jsx)(n.strong,{children:"join type"})," (VERY important for performance)."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"possible_keys"})}),(0,i.jsxs)(n.td,{children:["Indexes MySQL ",(0,i.jsx)(n.em,{children:"could"})," use."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"key"})}),(0,i.jsx)(n.td,{children:"The index MySQL actually used."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"rows"})}),(0,i.jsx)(n.td,{children:"Estimated number of rows to scan."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Extra"})}),(0,i.jsx)(n.td,{children:"Additional details (e.g., \u201cUsing where\u201d, \u201cUsing index\u201d, \u201cUsing temporary\u201d)."})]})]})]}),"\n",(0,i.jsxs)(n.h3,{id:"important-type-values-query-efficiency",children:["Important ",(0,i.jsx)(n.code,{children:"type"})," Values (Query Efficiency)"]}),"\n",(0,i.jsx)(n.p,{children:"The type column shows how MySQL reads data. Ordered from best \u2192 worst:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"system"})," / ",(0,i.jsx)(n.code,{children:"const"})," \u2192 Only 1 row (very fast)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"eq_ref"})," \u2192 Unique index lookup."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ref"})," \u2192 Non-unique index lookup."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"range"})," \u2192 Index range scan."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"index"})," \u2192 Full index scan."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ALL"})," \u2192 Full table scan (\u26a0\ufe0f slowest)."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Goal: Keep queries using ",(0,i.jsx)(n.code,{children:"ref"}),", ",(0,i.jsx)(n.code,{children:"range"}),", or ",(0,i.jsx)(n.code,{children:"const"}),". Avoid ",(0,i.jsx)(n.code,{children:"ALL"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}}}]);