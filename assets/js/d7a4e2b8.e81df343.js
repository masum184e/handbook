"use strict";(globalThis.webpackChunkhandbook=globalThis.webpackChunkhandbook||[]).push([[20696],{28453(e,n,i){i.d(n,{R:()=>t,x:()=>l});var s=i(96540);const r={},c=s.createContext(r);function t(e){const n=s.useContext(c);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),s.createElement(c.Provider,{value:n},e.children)}},80102(e,n,i){i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>t,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"nginx/SSL_TLS setup","title":"SSL_TLS setup","description":"SSL (Secure Sockets Layer) and its successor TLS (Transport Layer Security) are cryptographic protocols that:","source":"@site/docs/nginx/16. SSL_TLS setup.md","sourceDirName":"nginx","slug":"/nginx/SSL_TLS setup","permalink":"/handbook/docs/nginx/SSL_TLS setup","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":16,"frontMatter":{},"sidebar":"nginxApiSidebar","previous":{"title":"Auto Index","permalink":"/handbook/docs/nginx/Auto Index"},"next":{"title":"HTTP to HTTPS","permalink":"/handbook/docs/nginx/HTTP to HTTPS"}}');var r=i(74848),c=i(28453);const t={},l=void 0,d={},o=[{value:"Core Components of SSL/TLS in NGINX",id:"core-components-of-ssltls-in-nginx",level:2},{value:"SSL Certificate (<code>.crt</code>, <code>.pem</code>)",id:"ssl-certificate-crt-pem",level:3},{value:"Private Key (.key)",id:"private-key-key",level:3},{value:"NGINX SSL Directives Explained",id:"nginx-ssl-directives-explained",level:2},{value:"<code>ssl_certificate</code>",id:"ssl_certificate",level:3},{value:"<code>ssl_certificate_key</code>",id:"ssl_certificate_key",level:3},{value:"Basic HTTPS Server Configuration",id:"basic-https-server-configuration",level:2},{value:"Using Let\u2019s Encrypt Certificates (Recommended)",id:"using-lets-encrypt-certificates-recommended",level:2},{value:"File paths typically look like:",id:"file-paths-typically-look-like",level:3},{value:"Secure SSL/TLS Configuration (Best Practices)",id:"secure-ssltls-configuration-best-practices",level:2},{value:"Strong Protocols Only",id:"strong-protocols-only",level:3},{value:"Secure Ciphers",id:"secure-ciphers",level:3},{value:"Session Reuse (Performance)",id:"session-reuse-performance",level:3},{value:"HTTP to HTTPS Redirection",id:"http-to-https-redirection",level:3},{value:"Full Secure NGINX SSL Configuration Example",id:"full-secure-nginx-ssl-configuration-example",level:2},{value:"Certificate Chain &amp; Verification Flow",id:"certificate-chain--verification-flow",level:2},{value:"Common SSL/TLS Mistakes in NGINX",id:"common-ssltls-mistakes-in-nginx",level:2},{value:"How to Test SSL Configuration",id:"how-to-test-ssl-configuration",level:2}];function a(e){const n={code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,c.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:"SSL (Secure Sockets Layer) and its successor TLS (Transport Layer Security) are cryptographic protocols that:"}),"\n",(0,r.jsx)(n.p,{children:"Encrypt data between client (browser) and server"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Ensure confidentiality, integrity, and authentication"}),"\n",(0,r.jsxs)(n.li,{children:["Protect against:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Man-in-the-Middle (MITM) attacks"}),"\n",(0,r.jsx)(n.li,{children:"Data tampering"}),"\n",(0,r.jsx)(n.li,{children:"Credential theft"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"In NGINX, SSL/TLS is configured at the server block level to enable HTTPS."}),"\n",(0,r.jsx)(n.h2,{id:"core-components-of-ssltls-in-nginx",children:"Core Components of SSL/TLS in NGINX"}),"\n",(0,r.jsxs)(n.h3,{id:"ssl-certificate-crt-pem",children:["SSL Certificate (",(0,r.jsx)(n.code,{children:".crt"}),", ",(0,r.jsx)(n.code,{children:".pem"}),")"]}),"\n",(0,r.jsx)(n.p,{children:"An SSL certificate:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Is issued by a Certificate Authority (CA) (e.g., Let\u2019s Encrypt, DigiCert)"}),"\n",(0,r.jsxs)(n.li,{children:["Contains:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Server\u2019s public key"}),"\n",(0,r.jsx)(n.li,{children:"Domain name"}),"\n",(0,r.jsx)(n.li,{children:"Issuer details"}),"\n",(0,r.jsx)(n.li,{children:"Validity period"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:"Used by clients to verify server identity"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"File formats"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:".crt"})," \u2013 certificate file"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:".pem"})," \u2013 Base64 encoded certificate (most common)"]}),"\n",(0,r.jsx)(n.li,{children:"Can include certificate chain (intermediate certificates)"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"private-key-key",children:"Private Key (.key)"}),"\n",(0,r.jsx)(n.p,{children:"The private key:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Must remain secret"}),"\n",(0,r.jsx)(n.li,{children:"Is mathematically paired with the certificate\u2019s public key"}),"\n",(0,r.jsxs)(n.li,{children:["Used to:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Decrypt session keys"}),"\n",(0,r.jsx)(n.li,{children:"Prove ownership of the certificate"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"If compromised, attackers can impersonate your website."}),"\n",(0,r.jsx)(n.h2,{id:"nginx-ssl-directives-explained",children:"NGINX SSL Directives Explained"}),"\n",(0,r.jsx)(n.h3,{id:"ssl_certificate",children:(0,r.jsx)(n.code,{children:"ssl_certificate"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"ssl_certificate /etc/nginx/ssl/example.com.crt;\n"})}),"\n",(0,r.jsx)(n.p,{children:"Specifies:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Public SSL certificate"}),"\n",(0,r.jsxs)(n.li,{children:["Often includes:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Server certificate"}),"\n",(0,r.jsx)(n.li,{children:"Intermediate certificates (certificate chain)"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Best practice:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Use full chain certificate (",(0,r.jsx)(n.code,{children:"fullchain.pem"}),")"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"ssl_certificate_key",children:(0,r.jsx)(n.code,{children:"ssl_certificate_key"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"ssl_certificate_key /etc/nginx/ssl/example.com.key;\n"})}),"\n",(0,r.jsx)(n.p,{children:"Specifies:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"The private key for the certificate"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Security:"}),"\n",(0,r.jsx)(n.p,{children:"File permissions should be restricted:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"chmod 600 example.com.key\r\nchown root:root example.com.key\n"})}),"\n",(0,r.jsx)(n.h2,{id:"basic-https-server-configuration",children:"Basic HTTPS Server Configuration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"server {\r\n    listen 443 ssl;\r\n    server_name example.com www.example.com;\r\n\r\n    ssl_certificate     /etc/nginx/ssl/example.com.crt;\r\n    ssl_certificate_key /etc/nginx/ssl/example.com.key;\r\n\r\n    root /var/www/html;\r\n    index index.html;\r\n}\n"})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Directive"}),(0,r.jsx)(n.th,{children:"Purpose"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"listen 443 ssl"})}),(0,r.jsx)(n.td,{children:"Enables HTTPS on port 443"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"server_name"})}),(0,r.jsx)(n.td,{children:"Domain name(s)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"ssl_certificate"})}),(0,r.jsx)(n.td,{children:"Public certificate"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"ssl_certificate_key"})}),(0,r.jsx)(n.td,{children:"Private key"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"using-lets-encrypt-certificates-recommended",children:"Using Let\u2019s Encrypt Certificates (Recommended)"}),"\n",(0,r.jsx)(n.p,{children:"Let\u2019s Encrypt provides free, trusted certificates."}),"\n",(0,r.jsx)(n.h3,{id:"file-paths-typically-look-like",children:"File paths typically look like:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"ssl_certificate     /etc/letsencrypt/live/example.com/fullchain.pem;\r\nssl_certificate_key /etc/letsencrypt/live/example.com/privkey.pem;\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Why ",(0,r.jsx)(n.code,{children:"fullchain.pem"}),"?"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Contains:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Server certificate"}),"\n",(0,r.jsx)(n.li,{children:"Intermediate certificates"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:"Prevents \u201cincomplete certificate chain\u201d errors"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"secure-ssltls-configuration-best-practices",children:"Secure SSL/TLS Configuration (Best Practices)"}),"\n",(0,r.jsx)(n.h3,{id:"strong-protocols-only",children:"Strong Protocols Only"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"ssl_protocols TLSv1.2 TLSv1.3;\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u274c Disable:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"SSLv3"}),"\n",(0,r.jsx)(n.li,{children:"TLSv1.0 / TLSv1.1 (deprecated)"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"secure-ciphers",children:"Secure Ciphers"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"ssl_ciphers 'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384';\r\nssl_prefer_server_ciphers on;\n"})}),"\n",(0,r.jsx)(n.h3,{id:"session-reuse-performance",children:"Session Reuse (Performance)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"ssl_session_cache shared:SSL:10m;\r\nssl_session_timeout 1d;\n"})}),"\n",(0,r.jsx)(n.h3,{id:"http-to-https-redirection",children:"HTTP to HTTPS Redirection"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"server {\r\n    listen 80;\r\n    server_name example.com www.example.com;\r\n    return 301 https://$host$request_uri;\r\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:"Forces encrypted connections"}),"\n",(0,r.jsx)(n.h2,{id:"full-secure-nginx-ssl-configuration-example",children:"Full Secure NGINX SSL Configuration Example"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'server {\r\n    listen 443 ssl http2;\r\n    server_name example.com www.example.com;\r\n\r\n    ssl_certificate     /etc/letsencrypt/live/example.com/fullchain.pem;\r\n    ssl_certificate_key /etc/letsencrypt/live/example.com/privkey.pem;\r\n\r\n    ssl_protocols TLSv1.2 TLSv1.3;\r\n    ssl_ciphers HIGH:!aNULL:!MD5;\r\n    ssl_prefer_server_ciphers on;\r\n\r\n    ssl_session_cache shared:SSL:10m;\r\n    ssl_session_timeout 1d;\r\n\r\n    add_header Strict-Transport-Security "max-age=63072000; includeSubDomains; preload" always;\r\n\r\n    root /var/www/html;\r\n    index index.html;\r\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"certificate-chain--verification-flow",children:"Certificate Chain & Verification Flow"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Browser connects to HTTPS site"}),"\n",(0,r.jsxs)(n.li,{children:["NGINX sends:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Server certificate"}),"\n",(0,r.jsx)(n.li,{children:"Intermediate certificates"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Browser:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Verifies certificate chain up to trusted CA"}),"\n",(0,r.jsx)(n.li,{children:"Negotiates session key"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:"Secure encrypted communication begins"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"common-ssltls-mistakes-in-nginx",children:"Common SSL/TLS Mistakes in NGINX"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Mistake"}),(0,r.jsx)(n.th,{children:"Impact"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Using only server cert (no chain)"}),(0,r.jsx)(n.td,{children:"Browser trust errors"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Exposed private key"}),(0,r.jsx)(n.td,{children:"Total security breach"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Old TLS versions"}),(0,r.jsx)(n.td,{children:"Vulnerable to attacks"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:["Wrong permissions on ",(0,r.jsx)(n.code,{children:".key"})]}),(0,r.jsx)(n.td,{children:"Unauthorized access"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"No HTTPS redirect"}),(0,r.jsx)(n.td,{children:"Downgrade attacks"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"how-to-test-ssl-configuration",children:"How to Test SSL Configuration"}),"\n",(0,r.jsx)(n.p,{children:"Check NGINX config"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"nginx -t\n"})}),"\n",(0,r.jsx)(n.p,{children:"Verify certificate"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"openssl x509 -in example.com.crt -text -noout\n"})}),"\n",(0,r.jsx)(n.p,{children:"Online tools"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"SSL Labs Server Test"}),"\n",(0,r.jsx)(n.li,{children:"SecurityHeaders.com"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}}}]);