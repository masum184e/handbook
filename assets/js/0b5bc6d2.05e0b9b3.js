"use strict";(globalThis.webpackChunkhandbook=globalThis.webpackChunkhandbook||[]).push([[72341],{28453(e,r,n){n.d(r,{R:()=>i,x:()=>l});var s=n(96540);const t={},d=s.createContext(t);function i(e){const r=s.useContext(d);return s.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function l(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),s.createElement(d.Provider,{value:r},e.children)}},51464(e,r,n){n.r(r),n.d(r,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>i,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"nodejs/Core Modules/Stream","title":"Stream","description":"A stream is an abstract interface in Node.js used to read or write data sequentially, piece by piece, instead of loading the entire data into memory at once.","source":"@site/docs/nodejs/5. Core Modules/5. Stream.md","sourceDirName":"nodejs/5. Core Modules","slug":"/nodejs/Core Modules/Stream","permalink":"/handbook/docs/nodejs/Core Modules/Stream","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":5,"frontMatter":{},"sidebar":"nodejsApiSidebar","previous":{"title":"Events","permalink":"/handbook/docs/nodejs/Core Modules/Events"},"next":{"title":"OS","permalink":"/handbook/docs/nodejs/Core Modules/OS"}}');var t=n(74848),d=n(28453);const i={},l=void 0,a={},c=[{value:"Stream vs Buffer (Important Concept)",id:"stream-vs-buffer-important-concept",level:2},{value:"Types of Streams in Node.js",id:"types-of-streams-in-nodejs",level:2},{value:"Readable Streams",id:"readable-streams",level:2},{value:"Writable Streams",id:"writable-streams",level:2},{value:"Piping Streams (MOST IMPORTANT FEATURE)",id:"piping-streams-most-important-feature",level:2},{value:"Backpressure (Critical Concept)",id:"backpressure-critical-concept",level:2},{value:"Duplex Streams",id:"duplex-streams",level:2},{value:"Transform Streams",id:"transform-streams",level:2},{value:"Streams with HTTP",id:"streams-with-http",level:2},{value:"Stream Modes",id:"stream-modes",level:2},{value:"Error Handling (Always Required)",id:"error-handling-always-required",level:2},{value:"Streams Internals (High Level)",id:"streams-internals-high-level",level:2},{value:"When Should You Use Streams?",id:"when-should-you-use-streams",level:2},{value:"Summary Cheat Sheet",id:"summary-cheat-sheet",level:2}];function o(e){const r={code:"code",h2:"h2",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.p,{children:"A stream is an abstract interface in Node.js used to read or write data sequentially, piece by piece, instead of loading the entire data into memory at once."}),"\n",(0,t.jsxs)(r.p,{children:["Streams are provided by the core ",(0,t.jsx)(r.code,{children:"stream"})," module, and many core APIs (HTTP, FS, Zlib) are built on top of it."]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:'const { Readable, Writable, Duplex, Transform } = require("stream");\n'})}),"\n",(0,t.jsx)(r.p,{children:"Why streams exist"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsxs)(r.li,{children:["Without streams:","\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:"Large files must be fully loaded into memory"}),"\n",(0,t.jsx)(r.li,{children:"Memory usage spikes"}),"\n",(0,t.jsx)(r.li,{children:"Performance suffers"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(r.li,{children:["With streams:","\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:"Data is processed in chunks"}),"\n",(0,t.jsx)(r.li,{children:"Low memory usage"}),"\n",(0,t.jsx)(r.li,{children:"High performance"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(r.h2,{id:"stream-vs-buffer-important-concept",children:"Stream vs Buffer (Important Concept)"}),"\n",(0,t.jsxs)(r.table,{children:[(0,t.jsx)(r.thead,{children:(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.th,{children:"Method"}),(0,t.jsx)(r.th,{children:"Purpose"})]})}),(0,t.jsxs)(r.tbody,{children:[(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"os.platform()"})}),(0,t.jsx)(r.td,{children:"OS platform"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"os.type()"})}),(0,t.jsx)(r.td,{children:"OS name"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"os.arch()"})}),(0,t.jsx)(r.td,{children:"CPU architecture"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"os.cpus()"})}),(0,t.jsx)(r.td,{children:"CPU info"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"os.totalmem()"})}),(0,t.jsx)(r.td,{children:"Total memory"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"os.freemem()"})}),(0,t.jsx)(r.td,{children:"Free memory"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"os.uptime()"})}),(0,t.jsx)(r.td,{children:"System uptime"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"os.networkInterfaces()"})}),(0,t.jsx)(r.td,{children:"Network details"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"os.homedir()"})}),(0,t.jsx)(r.td,{children:"Home directory"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"os.tmpdir()"})}),(0,t.jsx)(r.td,{children:"Temp directory"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"os.EOL"})}),(0,t.jsx)(r.td,{children:"Line ending"})]})]})]}),"\n",(0,t.jsx)(r.h2,{id:"types-of-streams-in-nodejs",children:"Types of Streams in Node.js"}),"\n",(0,t.jsx)(r.p,{children:"Node.js provides four main stream types:"}),"\n",(0,t.jsxs)(r.table,{children:[(0,t.jsx)(r.thead,{children:(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.th,{children:"Type"}),(0,t.jsx)(r.th,{children:"Description"}),(0,t.jsx)(r.th,{children:"Example"})]})}),(0,t.jsxs)(r.tbody,{children:[(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"Readable"}),(0,t.jsx)(r.td,{children:"Read data"}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"fs.createReadStream()"})})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"Writable"}),(0,t.jsx)(r.td,{children:"Write data"}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"fs.createWriteStream()"})})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"Duplex"}),(0,t.jsx)(r.td,{children:"Read & write"}),(0,t.jsx)(r.td,{children:"TCP sockets"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"Transform"}),(0,t.jsx)(r.td,{children:"Modify data"}),(0,t.jsx)(r.td,{children:"Compression, encryption"})]})]})]}),"\n",(0,t.jsx)(r.h2,{id:"readable-streams",children:"Readable Streams"}),"\n",(0,t.jsx)(r.p,{children:"Example: Reading a File Stream"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:'const fs = require("fs");\r\n\r\nconst readStream = fs.createReadStream("data.txt", {\r\n  encoding: "utf8",\r\n  highWaterMark: 16\r\n});\r\n\r\nreadStream.on("data", chunk => {\r\n  console.log("Chunk:", chunk);\r\n});\r\n\r\nreadStream.on("end", () => {\r\n  console.log("Finished reading file");\r\n});\r\n\r\nreadStream.on("error", err => {\r\n  console.error(err);\r\n});\n'})}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.code,{children:"data"})," \u2192 emitted for each chunk"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.code,{children:"highWaterMark"})," \u2192 chunk size (bytes)"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.code,{children:"end"})," \u2192 no more data"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.code,{children:"error"})," \u2192 stream error"]}),"\n"]}),"\n",(0,t.jsx)(r.h2,{id:"writable-streams",children:"Writable Streams"}),"\n",(0,t.jsx)(r.p,{children:"Example: Writing to a File Stream"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:'const fs = require("fs");\r\n\r\nconst writeStream = fs.createWriteStream("output.txt");\r\n\r\nwriteStream.write("Hello ");\r\nwriteStream.write("Node Streams!");\r\nwriteStream.end();\n'})}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.code,{children:"write()"})," sends data to stream"]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.code,{children:"end()"})," closes the stream"]}),"\n",(0,t.jsx)(r.li,{children:"Data is written gradually"}),"\n"]}),"\n",(0,t.jsx)(r.h2,{id:"piping-streams-most-important-feature",children:"Piping Streams (MOST IMPORTANT FEATURE)"}),"\n",(0,t.jsx)(r.p,{children:"Example: Copy a File Efficiently"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:'const fs = require("fs");\r\n\r\nconst readStream = fs.createReadStream("bigfile.txt");\r\nconst writeStream = fs.createWriteStream("copy.txt");\r\n\r\nreadStream.pipe(writeStream);\n'})}),"\n",(0,t.jsxs)(r.p,{children:["Why ",(0,t.jsx)(r.code,{children:"pipe()"})," matters"]}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsxs)(r.li,{children:["Automatically manages:","\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:"Backpressure"}),"\n",(0,t.jsx)(r.li,{children:"Errors"}),"\n",(0,t.jsx)(r.li,{children:"Flow control"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(r.li,{children:"Cleaner and safer"}),"\n"]}),"\n",(0,t.jsx)(r.h2,{id:"backpressure-critical-concept",children:"Backpressure (Critical Concept)"}),"\n",(0,t.jsx)(r.p,{children:"Backpressure happens when:"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:"Data is produced faster than it can be consumed"}),"\n"]}),"\n",(0,t.jsxs)(r.p,{children:["Streams handle this internally when using ",(0,t.jsx)(r.code,{children:"pipe()"}),"."]}),"\n",(0,t.jsx)(r.p,{children:"Without handling backpressure:"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:"Memory grows uncontrollably"}),"\n",(0,t.jsx)(r.li,{children:"App can crash"}),"\n"]}),"\n",(0,t.jsx)(r.h2,{id:"duplex-streams",children:"Duplex Streams"}),"\n",(0,t.jsx)(r.p,{children:"A Duplex stream can read and write."}),"\n",(0,t.jsx)(r.p,{children:"Example: TCP Socket (Conceptual)"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:'const net = require("net");\r\n\r\nconst server = net.createServer(socket => {\r\n  socket.write("Hello client");\r\n  socket.on("data", data => {\r\n    console.log("Received:", data.toString());\r\n  });\r\n});\r\n\r\nserver.listen(3000);\n'})}),"\n",(0,t.jsx)(r.h2,{id:"transform-streams",children:"Transform Streams"}),"\n",(0,t.jsx)(r.p,{children:"Transform streams modify data as it passes through."}),"\n",(0,t.jsx)(r.p,{children:"Example: Uppercase Transform"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:'const { Transform } = require("stream");\r\n\r\nconst upperCase = new Transform({\r\n  transform(chunk, encoding, callback) {\r\n    callback(null, chunk.toString().toUpperCase());\r\n  }\r\n});\r\n\r\nprocess.stdin\r\n  .pipe(upperCase)\r\n  .pipe(process.stdout);\n'})}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:"Input \u2192 transformed \u2192 output"}),"\n",(0,t.jsx)(r.li,{children:"Same stream reads and writes"}),"\n"]}),"\n",(0,t.jsx)(r.h2,{id:"streams-with-http",children:"Streams with HTTP"}),"\n",(0,t.jsx)(r.p,{children:"Example: Stream a File to Browser"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:'const fs = require("fs");\r\nconst http = require("http");\r\n\r\nhttp.createServer((req, res) => {\r\n  const stream = fs.createReadStream("video.mp4");\r\n\r\n  res.writeHead(200, { "Content-Type": "video/mp4" });\r\n  stream.pipe(res);\r\n}).listen(3000);\n'})}),"\n",(0,t.jsx)(r.p,{children:"Why this is ideal"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:"Starts sending immediately"}),"\n",(0,t.jsx)(r.li,{children:"Handles large files efficiently"}),"\n"]}),"\n",(0,t.jsx)(r.h2,{id:"stream-modes",children:"Stream Modes"}),"\n",(0,t.jsx)(r.p,{children:"Binary Mode (Default)"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:'fs.createReadStream("file.bin");\n'})}),"\n",(0,t.jsx)(r.p,{children:"Object Mode"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:'const { Readable } = require("stream");\r\n\r\nconst readable = new Readable({\r\n  objectMode: true,\r\n  read() {\r\n    this.push({ id: 1 });\r\n    this.push(null);\r\n  }\r\n});\n'})}),"\n",(0,t.jsx)(r.h2,{id:"error-handling-always-required",children:"Error Handling (Always Required)"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:'readStream.on("error", err => {\r\n  console.error("Stream error:", err);\r\n});\n'})}),"\n",(0,t.jsx)(r.p,{children:"When piping:"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:'readStream.pipe(writeStream).on("error", console.error);\n'})}),"\n",(0,t.jsx)(r.h2,{id:"streams-internals-high-level",children:"Streams Internals (High Level)"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsxs)(r.li,{children:["Streams extend ",(0,t.jsx)(r.code,{children:"EventEmitter"})]}),"\n",(0,t.jsxs)(r.li,{children:["Key events: ",(0,t.jsx)(r.code,{children:"data"}),", ",(0,t.jsx)(r.code,{children:"end"}),", ",(0,t.jsx)(r.code,{children:"error"}),", ",(0,t.jsx)(r.code,{children:"finish"})]}),"\n",(0,t.jsx)(r.li,{children:"Controlled by Node\u2019s event loop"}),"\n"]}),"\n",(0,t.jsx)(r.h2,{id:"when-should-you-use-streams",children:"When Should You Use Streams?"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsxs)(r.li,{children:["Use streams when:","\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:"Working with large files"}),"\n",(0,t.jsx)(r.li,{children:"Handling network data"}),"\n",(0,t.jsx)(r.li,{children:"Processing real-time data"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(r.li,{children:["Avoid streams when:","\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:"Data is small and simple"}),"\n",(0,t.jsx)(r.li,{children:"Logic becomes harder than necessary"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(r.h2,{id:"summary-cheat-sheet",children:"Summary Cheat Sheet"}),"\n",(0,t.jsxs)(r.table,{children:[(0,t.jsx)(r.thead,{children:(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.th,{children:"Feature"}),(0,t.jsx)(r.th,{children:"Purpose"})]})}),(0,t.jsxs)(r.tbody,{children:[(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"Streams"}),(0,t.jsx)(r.td,{children:"Chunk-based data handling"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"Readable"}),(0,t.jsx)(r.td,{children:"Consume data"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"Writable"}),(0,t.jsx)(r.td,{children:"Produce data"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"Duplex"}),(0,t.jsx)(r.td,{children:"Read & write"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"Transform"}),(0,t.jsx)(r.td,{children:"Modify data"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"pipe()"}),(0,t.jsx)(r.td,{children:"Connect streams"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:"Backpressure"}),(0,t.jsx)(r.td,{children:"Flow control"})]})]})]})]})}function h(e={}){const{wrapper:r}={...(0,d.R)(),...e.components};return r?(0,t.jsx)(r,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}}}]);