---
sidebar_position: 14
---

Prisma is database-agnostic and works as a type-safe database client, which makes it ideal for GraphQL servers.

- GraphQL handles API queries/mutations.
- Prisma handles database access with type-safe queries.
- Nexus can be used to define GraphQL schema in code, integrating seamlessly with Prisma.
- Apollo Server exposes the GraphQL API over HTTP.

```
Client → GraphQL Query → Apollo Server → Prisma Client → Database → Response
```

## Key Tools

1. Apollo Server
   - Popular GraphQL server for Node.js.
   - Handles GraphQL queries, mutations, and subscriptions.
2. Nexus
   - Code-first GraphQL schema builder for TypeScript/Node.js.
   - Automatically generates schema and types.
   - Works well with Prisma Client for resolvers.
3. Prisma Client
   - Acts as the database layer.
   - Fully type-safe and integrates with GraphQL resolvers.

## Example Workflow With GraphQL

Install Packages

```bash
npm install @prisma/client prisma apollo-server graphql nexus
```

Define GraphQL Schema Using Nexus

```ts
// schema.ts
import { objectType, queryType, mutationType, makeSchema } from "nexus";
import { join } from "path";
import { PrismaClient } from "@prisma/client";

const prisma = new PrismaClient();

// GraphQL Types
const User = objectType({
  name: "User",
  definition(t) {
    t.int("id");
    t.string("name");
    t.string("email");
    t.list.field("posts", { type: "Post" });
  },
});

const Post = objectType({
  name: "Post",
  definition(t) {
    t.int("id");
    t.string("title");
    t.string("content", { nullable: true });
    t.boolean("published");
    t.field("author", { type: "User" });
  },
});

// Queries
const Query = queryType({
  definition(t) {
    t.list.field("users", {
      type: "User",
      resolve: () => prisma.user.findMany({ include: { posts: true } }),
    });

    t.list.field("posts", {
      type: "Post",
      resolve: () => prisma.post.findMany({ include: { author: true } }),
    });
  },
});

// Mutations
const Mutation = mutationType({
  definition(t) {
    t.field("createUser", {
      type: "User",
      args: { name: "String", email: "String" },
      resolve: (_, { name, email }) =>
        prisma.user.create({ data: { name, email } }),
    });

    t.field("createPost", {
      type: "Post",
      args: { title: "String", content: "String", authorId: "Int" },
      resolve: (_, { title, content, authorId }) =>
        prisma.post.create({ data: { title, content, authorId } }),
    });
  },
});

// Make Schema
export const schema = makeSchema({
  types: [User, Post, Query, Mutation],
  outputs: {
    schema: join(process.cwd(), "schema.graphql"),
    typegen: join(process.cwd(), "nexus-typegen.ts"),
  },
});
```

Setup Apollo Server

```ts
// server.ts
import { ApolloServer } from "apollo-server";
import { schema } from "./schema";

const server = new ApolloServer({ schema });

server.listen().then(({ url }) => {
  console.log(`Server running at ${url}`);
});
```
