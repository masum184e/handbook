## Serving static files manually

Node.js has built-in modules like `http`, `fs`, and `path` that you can use to read files and send them to the browser.

```js
const http = require("http");
const fs = require("fs");
const path = require("path");

const server = http.createServer((req, res) => {
  // Default file
  let filePath = path.join(
    __dirname,
    "public",
    req.url === "/" ? "index.html" : req.url,
  );

  // Get file extension
  const ext = path.extname(filePath);

  // Set MIME types
  const contentTypeMap = {
    ".html": "text/html",
    ".css": "text/css",
    ".js": "application/javascript",
    ".png": "image/png",
    ".jpg": "image/jpeg",
    ".gif": "image/gif",
  };

  const contentType = contentTypeMap[ext] || "application/octet-stream";

  fs.readFile(filePath, (err, content) => {
    if (err) {
      if (err.code === "ENOENT") {
        // File not found
        res.writeHead(404, { "Content-Type": "text/plain" });
        res.end("404 - File Not Found");
      } else {
        // Server error
        res.writeHead(500);
        res.end("Server Error");
      }
    } else {
      // Success
      res.writeHead(200, { "Content-Type": contentType });
      res.end(content);
    }
  });
});

server.listen(3000, () => {
  console.log("Server running at http://localhost:3000");
});
```

1. Request comes in (e.g., `/style.css`)
2. We build a file path: `public/style.css`
3. We detect the file extension and set the correct Content-Type
4. We read the file using `fs.readFile`
5. We send the file contents as the response

**Downsides of manual approach**

- You must handle:
  - MIME types
  - Security (e.g., preventing access to system files)
  - Caching
  - Directory traversal attacks
- Not very scalable or maintainable

## Serving static files libraries

Most real-world apps use Express, which provides built-in middleware for static files.

```js
const express = require("express");
const path = require("path");

const app = express();

// Serve static files from "public" folder
app.use(express.static(path.join(__dirname, "public")));

app.listen(3000, () => {
  console.log("Server running at http://localhost:3000");
});
```

- Automatically maps URLs to files in the folder
- Handles MIME types
- Supports caching headers
- Prevents directory traversal attacks

**Serving static files under a specific route**

You can mount static files under a route prefix:

```js
app.use("/static", express.static(path.join(__dirname, "public")));
```

- `/static/index.html` → `public/index.html`
- `/static/style.css` → `public/style.css`
