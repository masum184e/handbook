The `http` module is a core Node.js module that allows you to:

- Create an HTTP server
- Listen for incoming requests
- Read request data (URL, method, headers, body)
- Send responses (status codes, headers, body)
- No installation required

## How HTTP works in Node (Mental Model)

Every request follows this flow:

```
Client (Browser / Postman)
        ↓
HTTP Request (method, url, headers, body)
        ↓
Node.js HTTP Server
        ↓
Your request handler (req, res)
        ↓
HTTP Response (status, headers, body)
        ↓
Client
```

Node gives you two objects for every request:

- `req` → IncomingMessage (request)
- `res` → ServerResponse (response)

## Creating a Basic HTTP Server

```
const http = require("http");

const server = http.createServer((req, res) => {
  res.end("Hello World");
});

server.listen(3000, () => {
  console.log("Server running on http://localhost:3000");
});
```

- `http.createServer()` creates a server
- Callback runs for every request
- `res.end()` sends the response and closes it
- `listen()` binds the server to a port

## Understanding the `req` (Request) Object

Common Request Properties

```
const server = http.createServer((req, res) => {
  console.log(req.method);   // GET, POST, PUT...
  console.log(req.url);      // /about?name=John
  console.log(req.headers);  // request headers

  res.end("Check console");
});
```

Example Output

```
GET
/about?name=John
{ host: 'localhost:3000', user-agent: '...' }
```

## Routing (Handling Different URLs)

Node does not provide routing out of the box — you handle it manually.

```
const http = require("http");

const server = http.createServer((req, res) => {
  if (req.url === "/" && req.method === "GET") {
    res.end("Home Page");
  } else if (req.url === "/about") {
    res.end("About Page");
  } else {
    res.statusCode = 404;
    res.end("Page Not Found");
  }
});

server.listen(3000);
```

- URL + HTTP method determine behavior
- This is what frameworks automate for you

## Setting Status Codes & Headers

- Status Code: `res.statusCode = 200;`
- Headers: `res.setHeader("Content-Type", "text/plain");`

Combined Example

```js
res.writeHead(200, {
  "Content-Type": "application/json",
});
res.end(JSON.stringify({ message: "Success" }));
```

## Sending Different Response Types

HTML Response

```js
res.writeHead(200, { "Content-Type": "text/html" });
res.end("<h1>Hello HTML</h1>");
```

JSON Response (API style)

```js
res.writeHead(200, { "Content-Type": "application/json" });
res.end(JSON.stringify({ name: "Node", type: "Runtime" }));
```

## Reading Request Body (POST Data)

Unlike Express, Node does not parse body automatically.

Example: Reading JSON body

```
const http = require("http");

const server = http.createServer((req, res) => {
  if (req.method === "POST" && req.url === "/data") {
    let body = "";

    req.on("data", chunk => {
      body += chunk;
    });

    req.on("end", () => {
      const parsed = JSON.parse(body);
      res.end(`Received: ${parsed.name}`);
    });
  }
});

server.listen(3000);
```

- Request body arrives in chunks
- `data` event → collect chunks
- `end` event → full body received

## Query Parameters

```
const url = require("url");

const server = http.createServer((req, res) => {
  const parsedUrl = url.parse(req.url, true);

  console.log(parsedUrl.query);
  res.end("Check console");
});
```

For `/search?term=node&page=1`:

```
{ term: 'node', page: '1' }
```

## Serving Static Files (Basic Example)

```
const fs = require("fs");
const path = require("path");
const http = require("http");

const server = http.createServer((req, res) => {
  const filePath = path.join(__dirname, "public", req.url);

  fs.readFile(filePath, (err, data) => {
    if (err) {
      res.statusCode = 404;
      res.end("File not found");
      return;
    }
    res.end(data);
  });
});

server.listen(3000);
```

This is educational only (security issues exist).

## Sending HTTP Requests Using `http` Module

The `http` module is built into Node.js and used for low-level HTTP communication.
### HTTP GET Request
```js
const http = require("http");

http.get("http://jsonplaceholder.typicode.com/posts/1", (res) => {
  let data = "";

  // Collect data chunks
  res.on("data", chunk => {
    data += chunk;
  });

  // When response ends
  res.on("end", () => {
    const parsedData = JSON.parse(data);
    console.log(parsedData);
  });

}).on("error", (err) => {
  console.error("Error:", err.message);
});

req.write(postData);
req.end();
```
- `http.get()` sends a GET request
- Data arrives in chunks
- Chunks are combined into a string
- `JSON.parse()` converts JSON → JS object
- Manual error handling is required

### HTTP POST Request
```js
const http = require("http");

const postData = JSON.stringify({
  name: "John",
  age: 25
});

const options = {
  hostname: "jsonplaceholder.typicode.com",
  path: "/posts",
  method: "POST",
  headers: {
    "Content-Type": "application/json",
    "Content-Length": Buffer.byteLength(postData)
  }
};

const req = http.request(options, (res) => {
  let data = "";

  res.on("data", chunk => {
    data += chunk;
  });

  res.on("end", () => {
    console.log(JSON.parse(data));
  });
});

req.on("error", (err) => {
  console.error(err.message);
});

// Send data
req.write(postData);
req.end();
```
- `http.request()` allows custom methods
- Data is sent using `req.write()`
- `Content-Length` is required
- Response must be collected manually

## Sending HTTPS Requests Using `https` Module

Used when the API uses HTTPS (secure).
```js
const https = require("https");

https.get("https://jsonplaceholder.typicode.com/users/1", (res) => {
  let data = "";

  res.on("data", chunk => {
    data += chunk;
  });

  res.on("end", () => {
    console.log(JSON.parse(data));
  });

}).on("error", (err) => {
  console.error(err.message);
});
```

### Difference Between `http` and `https`
| Feature    | http | https   |
| ---------- | ---- | ------- |
| Security   | ❌ No | ✅ Yes   |
| Encryption | None | SSL/TLS |
| Port       | 80   | 443     |

## Comparing `http`, `https`, and `axios`

| Feature        | http/https | Axios     |
| -------------- | ---------- | --------- |
| Built-in       | Yes      |  No      |
| Code Length    | Long       | Short     |
| JSON Parsing   | Manual     | Automatic |
| Promises       |  No       |  Yes     |
| Error Handling | Manual     | Built-in  |
| Production Use | Rare       | Common    |


## Streams with HTTP (Performance)

```
const fs = require("fs");
const http = require("http");

http.createServer((req, res) => {
  const stream = fs.createReadStream("bigfile.txt");
  stream.pipe(res);
}).listen(3000);
```

Why this matters

- No buffering entire file
- Faster and memory efficient

## Error Handling

```
const server = http.createServer((req, res) => {
  try {
    res.end("Safe response");
  } catch (err) {
    res.statusCode = 500;
    res.end("Server Error");
  }
});
```

## Why Frameworks Exist (Express, Fastify)

The raw `http` module:

- No routing system
- No body parsing
- No middleware
- Manual error handling

Frameworks wrap `http` and provide:

- Routing
- Middleware
- JSON parsing
- Better DX

But learning `http` helps you:

- Understand performance
- Debug server issues
- Write lightweight services

## Summary Cheat Sheet

| Concept               | Description                |
| --------------------- | -------------------------- |
| `http.createServer()` | Create server              |
| `req`                 | Incoming request           |
| `res`                 | Outgoing response          |
| `req.method`          | HTTP method                |
| `req.url`             | Requested path             |
| `res.end()`           | Send response              |
| `res.writeHead()`     | Status + headers           |
| Streams               | High-performance responses |
