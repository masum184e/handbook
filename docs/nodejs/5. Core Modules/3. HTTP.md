The `http` module is a core Node.js module that allows you to:

- Create an HTTP server
- Listen for incoming requests
- Read request data (URL, method, headers, body)
- Send responses (status codes, headers, body)
- No installation required

## How HTTP works in Node (Mental Model)

Every request follows this flow:

```
Client (Browser / Postman)
        ↓
HTTP Request (method, url, headers, body)
        ↓
Node.js HTTP Server
        ↓
Your request handler (req, res)
        ↓
HTTP Response (status, headers, body)
        ↓
Client
```

Node gives you two objects for every request:

- `req` → IncomingMessage (request)
- `res` → ServerResponse (response)

## Creating a Basic HTTP Server

```
const http = require("http");

const server = http.createServer((req, res) => {
  res.end("Hello World");
});

server.listen(3000, () => {
  console.log("Server running on http://localhost:3000");
});
```

- `http.createServer()` creates a server
- Callback runs for every request
- `res.end()` sends the response and closes it
- `listen()` binds the server to a port

## Understanding the `req` (Request) Object

Common Request Properties

```
const server = http.createServer((req, res) => {
  console.log(req.method);   // GET, POST, PUT...
  console.log(req.url);      // /about?name=John
  console.log(req.headers);  // request headers

  res.end("Check console");
});
```

Example Output

```
GET
/about?name=John
{ host: 'localhost:3000', user-agent: '...' }
```

## Routing (Handling Different URLs)

Node does not provide routing out of the box — you handle it manually.

```
const http = require("http");

const server = http.createServer((req, res) => {
  if (req.url === "/" && req.method === "GET") {
    res.end("Home Page");
  } else if (req.url === "/about") {
    res.end("About Page");
  } else {
    res.statusCode = 404;
    res.end("Page Not Found");
  }
});

server.listen(3000);
```

- URL + HTTP method determine behavior
- This is what frameworks automate for you

## Setting Status Codes & Headers

- Status Code: `res.statusCode = 200;`
- Headers: `res.setHeader("Content-Type", "text/plain");`

Combined Example

```js
res.writeHead(200, {
  "Content-Type": "application/json",
});
res.end(JSON.stringify({ message: "Success" }));
```

## Sending Different Response Types

HTML Response

```js
res.writeHead(200, { "Content-Type": "text/html" });
res.end("<h1>Hello HTML</h1>");
```

JSON Response (API style)

```js
res.writeHead(200, { "Content-Type": "application/json" });
res.end(JSON.stringify({ name: "Node", type: "Runtime" }));
```

## Reading Request Body (POST Data)

Unlike Express, Node does not parse body automatically.

Example: Reading JSON body

```
const http = require("http");

const server = http.createServer((req, res) => {
  if (req.method === "POST" && req.url === "/data") {
    let body = "";

    req.on("data", chunk => {
      body += chunk;
    });

    req.on("end", () => {
      const parsed = JSON.parse(body);
      res.end(`Received: ${parsed.name}`);
    });
  }
});

server.listen(3000);
```

- Request body arrives in chunks
- `data` event → collect chunks
- `end` event → full body received

## Query Parameters

```
const url = require("url");

const server = http.createServer((req, res) => {
  const parsedUrl = url.parse(req.url, true);

  console.log(parsedUrl.query);
  res.end("Check console");
});
```

For `/search?term=node&page=1`:

```
{ term: 'node', page: '1' }
```

## Serving Static Files (Basic Example)

```
const fs = require("fs");
const path = require("path");
const http = require("http");

const server = http.createServer((req, res) => {
  const filePath = path.join(__dirname, "public", req.url);

  fs.readFile(filePath, (err, data) => {
    if (err) {
      res.statusCode = 404;
      res.end("File not found");
      return;
    }
    res.end(data);
  });
});

server.listen(3000);
```

This is educational only (security issues exist).

## Streams with HTTP (Performance)

```
const fs = require("fs");
const http = require("http");

http.createServer((req, res) => {
  const stream = fs.createReadStream("bigfile.txt");
  stream.pipe(res);
}).listen(3000);
```

Why this matters

- No buffering entire file
- Faster and memory efficient

## Error Handling

```
const server = http.createServer((req, res) => {
  try {
    res.end("Safe response");
  } catch (err) {
    res.statusCode = 500;
    res.end("Server Error");
  }
});
```

## Why Frameworks Exist (Express, Fastify)

The raw `http` module:

- No routing system
- No body parsing
- No middleware
- Manual error handling

Frameworks wrap `http` and provide:

- Routing
- Middleware
- JSON parsing
- Better DX

But learning `http` helps you:

- Understand performance
- Debug server issues
- Write lightweight services

## Summary Cheat Sheet

| Concept               | Description                |
| --------------------- | -------------------------- |
| `http.createServer()` | Create server              |
| `req`                 | Incoming request           |
| `res`                 | Outgoing response          |
| `req.method`          | HTTP method                |
| `req.url`             | Requested path             |
| `res.end()`           | Send response              |
| `res.writeHead()`     | Status + headers           |
| Streams               | High-performance responses |
