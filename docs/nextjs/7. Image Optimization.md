---
title: Image Optimization
sidebar_position: 8
---

Optimized images reduce page load time, improving user experience and SEO.

## <code>&lt;Image&gt;</code> Component

The Next.js <code>&lt;Image&gt;</code> component provides automatic optimizations:

- Lazy loading (except for priority images)
- Responsive resizing based on device viewport
- Automatic WebP/AVIF conversion (when supported by the browser)
- Prevents layout shift by requiring `width` & `height` or `fill`
- CDN caching (if deployed on Vercel, images are globally cached)

```tsx
<Image
  src="/example.jpg"
  alt="Example Image"
  width={500}
  height={300}
  quality={80} // default is 75
  priority // preloads the image
/>
```

Instead of setting a fixed width and height, use `layout="responsive"` to make the image adjust dynamically.

```tsx
<Image
  src="/my-image.jpg"
  alt="Responsive Image"
  layout="responsive"
  width={16} // Aspect ratio
  height={9} // Aspect ratio
/>
```

### Responsive Images

Instead of fixed dimensions, use `fill` with a parent container for responsive layouts:

```tsx
<div className="relative w-full h-64">
  <Image
    src="/my-image.jpg"
    alt="Responsive Image"
    fill
    sizes="(max-width: 768px) 100vw, 50vw" // helps with responsive optimization
    priority
  />
</div>
```

- `fill` makes the image automatically scale within the container.
- `sizes` ensures the browser only downloads the necessary image size.
- No layout shift, since the container controls dimensions

### Serve Next-Gen Formats

WebP and AVIF formats reduce file size while maintaining quality.
Next.js automatically detects browser support and serves optimized formats without extra configuration.

```tsx
<Image
  src="/example.jpg"
  alt="Optimized Image"
  width={500}
  height={300}
  quality={80}
  formats={["image/webp", "image/avif"]} // Converts to WebP/AVIF
/>
```

- Smaller file sizes compared to PNG/JPG
- Better performance with no extra setup needed

### Blur Placeholder for Lazy-Loaded Images

Next.js supports showing a low-resolution blurred version before the full image loads, improving perceived performance.

```tsx
<Image
  src="/example.jpg"
  alt="Blurred Image"
  width={500}
  height={300}
  placeholder="blur"
  blurDataURL="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQ..."
/>
```

- Enhances user experience for slow connections
- Useful for large or hero images

## How Lazy Loading Works

Lazy Loading means images below the viewport are not loaded until scrolled into view, reducing initial page load time.

- By default, Next.js <code>&lt;Image&gt;</code> uses `loading="lazy"` for any image that is not in the initial viewport.
- That means images below the fold will load only when needed, saving bandwidth.
- You can override this behavior with `priority={true}` (for critical images like logos or hero banners).

## Configuring External Image

By default, Next.js <code>&lt;Image&gt;</code> only optimizes images stored locally in your project (`/public`).
If you want to use images hosted on external domains (e.g., a CDN, CMS, or API like Unsplash, Cloudinary, Strapi, Sanity), you must explicitly allow those domains in your Next.js config.

This is required because:

- It prevents abuse (e.g., optimizing someone else’s images without permission).
- Ensures Next.js knows which domains are trusted for optimization.

### Configuring External Image Domains

You configure allowed domains in `next.config.js` under the `images.domains` property.

```ts
// next.config.js
module.exports = {
  images: {
    domains: ["images.unsplash.com", "res.cloudinary.com"],
  },
};
```

- `images.unsplash.com` → lets you use Unsplash images.
- `res.cloudinary.com` → allows Cloudinary-hosted images.

**Explaination**

1. The src points to external URLs.
2. Next.js will:
   - Fetch and cache the image on first request.
   - Optimize and serve it in modern formats (WebP/AVIF).
   - Generate responsive sizes automatically.
3. Because we added domains in `next.config.js`, Next.js trusts these sources.

### Advance Configuration

If your images come from multiple subdomains or APIs, you can use `remotePatterns` (more flexible than `domains`).

```ts
// next.config.js
module.exports = {
  images: {
    remotePatterns: [
      {
        protocol: "https",
        hostname: "example.com",
        port: "",
        pathname: "/images/**",
      },
      {
        protocol: "https",
        hostname: "cdn.myapp.com",
        pathname: "/assets/**",
      },
    ],
  },
};
```

**Why This Matters**

Without this config, you’ll see an error like:

```bash
Invalid src prop (https://...) on `next/image`, hostname not configured under images in your `next.config.js`
```

Configuring domains makes your app secure, optimized, and production-ready.
